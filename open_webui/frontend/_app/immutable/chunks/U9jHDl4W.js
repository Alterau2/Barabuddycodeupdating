var ir=Object.defineProperty;var or=(n,e,t)=>e in n?ir(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var pt=(n,e,t)=>or(n,typeof e!="symbol"?e+"":e,t);import{s as Be,e as I,k as j,c as M,a as k,d as m,o as z,f as h,i as V,g as p,n as ye,t as W,b as F,G as Ue,C as it,u as ce,h as K,Q as Fe,I as Ye,j as Ee,p as Je,M as gt,q as vt,z as je,B as Ze,r as ar,v as fr,w as ur,x as cr,l as de,E as Ie,F as Me,T as Rt,D as Ve,N as dr,an as hr,y as Pt,P as Bt,Z as mr,_ as gr}from"./BDiUIGvQ.js";import{S as Pe,i as Le,b as x,d as ee,m as te,t as v,a as D,e as le,f as Qe,g as se,c as ne,j as St}from"./CMw2dQw9.js";import{e as De,u as Jt,o as In,d as _r}from"./DgmbscGK.js";import{m as jt,e as ul,l as Mn,b as kt,k as pr,G as br,H as vr,c as En,T as cl,u as zt,o as Gt,g as Lt,W as kr,d as dl,B as hl,D as wr}from"./D6hsgQqw.js";import{t as Ae}from"./CCWCPRcv.js";import{f as yr,u as Ir,i as Mr}from"./BcNJj6Cd.js";import{b as Ft,w as Er,m as Nn,x as Nr,i as bt,u as At,l as Dn,v as ml}from"./DsSGLAjb.js";import{d as ot}from"./I1CDPYOB.js";import"./BFK-koEx.js";import{u as gl,c as Dr}from"./CsWWUxzw.js";import{c as Vr}from"./E-tZBc58.js";import{s as Cr}from"./29zuvHGz.js";import{i as Tr,E as Br}from"./Sx2gqJdm.js";import{P as Vn,N as Kt}from"./DXPFz0DG.js";import{I as Cn}from"./AvuVJ0at.js";import{T as Se}from"./DZF3XBRY.js";import{T as Sr}from"./WZYssSh6.js";import{C as Tn}from"./BZH8uq8K.js";import{C as Bn}from"./Cv_KpQSI.js";import{M as Or}from"./BfvhWxBg.js";import{aF as Sn,aU as Rr,aK as It,aV as Pr,aW as Lr}from"./Cdo8sKnZ.js";import{S as Ar}from"./BcuA_kYM.js";import{C as On}from"./DEwz7ZDa.js";import{I as Hr}from"./D5u-7KnL.js";import{M as Rn}from"./D_9XPT0a.js";import{S as Zt}from"./B8jKL4d6.js";import{B as Qt}from"./D27omodB.js";import{C as jr}from"./DI-gbz9w.js";import{X as zr}from"./DMy3xy05.js";import{E as Ur}from"./ChutD0tV.js";import"./CF4_YkFU.js";import{m as Ht}from"./5uy4Zm2q.js";import{c as _l}from"./CXEjQgem.js";import{F as Pn}from"./c1gcVwlW.js";import{L as qr}from"./B2Ko6bA5.js";import{f as Ot}from"./ZLcEirMF.js";import{F as Wr}from"./CU2r43ac.js";function Fr(n){return new Worker(""+new URL("../workers/kokoro.worker-Cev3ZHQt.js",import.meta.url).href,{type:"module",name:n==null?void 0:n.name})}class Jr{constructor(e="fp32"){pt(this,"worker",null);pt(this,"initialized",!1);pt(this,"dtype");pt(this,"requestQueue",[]);pt(this,"processing",!1);this.dtype=e}async init(){if(this.worker){console.warn("KokoroWorker is already initialized.");return}return this.worker=new Fr,this.worker.onmessage=e=>{const{status:t,error:l,audioUrl:s}=e.data;if(t==="init:complete")this.initialized=!0;else if(t==="init:error")console.error(l),this.initialized=!1;else if(t==="generate:complete"){const r=this.requestQueue.shift();r&&(r.resolve(s),this.processNextRequest())}else if(t==="generate:error"){const r=this.requestQueue.shift();r&&(r.reject(new Error(l)),this.processNextRequest())}},new Promise((e,t)=>{this.worker.postMessage({type:"init",payload:{dtype:this.dtype}});const l=s=>{s.data.status==="init:complete"?(this.worker.removeEventListener("message",l),this.initialized=!0,e()):s.data.status==="init:error"&&(this.worker.removeEventListener("message",l),t(new Error(s.data.error)))};this.worker.addEventListener("message",l)})}async generate({text:e,voice:t}){if(!this.initialized||!this.worker)throw new Error("KokoroTTS Worker is not initialized yet.");return new Promise((l,s)=>{this.requestQueue.push({text:e,voice:t,resolve:l,reject:s}),this.processing||this.processNextRequest()})}processNextRequest(){if(this.requestQueue.length===0){this.processing=!1;return}this.processing=!0;const{text:e,voice:t}=this.requestQueue[0];this.worker.postMessage({type:"generate",payload:{text:e,voice:t}})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.initialized=!1,this.requestQueue=[],this.processing=!1)}}function Gr(n){let e,t,l,s,r,i,a,o,f,u,c,g,d,_,y,w,E,C,R,P,O,b,N,B,S,T;return{c(){e=I("div"),t=I("div"),l=I("div"),s=I("div"),i=j(),a=I("div"),o=I("div"),u=j(),c=I("div"),d=j(),_=I("div"),y=I("div"),E=j(),C=I("div"),P=j(),O=I("div"),N=j(),B=I("div"),this.h()},l(L){e=M(L,"DIV",{class:!0});var H=k(e);t=M(H,"DIV",{class:!0});var Y=k(t);l=M(Y,"DIV",{class:!0});var oe=k(l);s=M(oe,"DIV",{class:!0}),k(s).forEach(m),i=z(oe),a=M(oe,"DIV",{class:!0});var ie=k(a);o=M(ie,"DIV",{class:!0}),k(o).forEach(m),u=z(ie),c=M(ie,"DIV",{class:!0}),k(c).forEach(m),ie.forEach(m),d=z(oe),_=M(oe,"DIV",{class:!0});var re=k(_);y=M(re,"DIV",{class:!0}),k(y).forEach(m),E=z(re),C=M(re,"DIV",{class:!0}),k(C).forEach(m),P=z(re),O=M(re,"DIV",{class:!0}),k(O).forEach(m),re.forEach(m),N=z(oe),B=M(oe,"DIV",{class:!0}),k(B).forEach(m),oe.forEach(m),Y.forEach(m),H.forEach(m),this.h()},h(){h(s,"class",r=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14"),h(o,"class",f=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),h(c,"class",g=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),h(a,"class","grid grid-cols-3 gap-4"),h(y,"class",w=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),h(C,"class",R=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),h(O,"class",b=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4"),h(_,"class","grid grid-cols-4 gap-4"),h(B,"class",S=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm"),h(l,"class",T=(n[0]==="md"?"space-y-2":"space-y-1.5")+" w-full"),h(t,"class","animate-pulse flex w-full"),h(e,"class","w-full mt-2 mb-2")},m(L,H){V(L,e,H),p(e,t),p(t,l),p(l,s),p(l,i),p(l,a),p(a,o),p(a,u),p(a,c),p(l,d),p(l,_),p(_,y),p(_,E),p(_,C),p(_,P),p(_,O),p(l,N),p(l,B)},p(L,[H]){H&1&&r!==(r=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14")&&h(s,"class",r),H&1&&f!==(f=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&h(o,"class",f),H&1&&g!==(g=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&h(c,"class",g),H&1&&w!==(w=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&h(y,"class",w),H&1&&R!==(R=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&h(C,"class",R),H&1&&b!==(b=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4")&&h(O,"class",b),H&1&&S!==(S=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm")&&h(B,"class",S),H&1&&T!==(T=(L[0]==="md"?"space-y-2":"space-y-1.5")+" w-full")&&h(l,"class",T)},i:ye,o:ye,d(L){L&&m(e)}}}function Kr(n,e,t){let{size:l="md"}=e;return n.$$set=s=>{"size"in s&&t(0,l=s.size)},[l]}class Yt extends Pe{constructor(e){super(),Le(this,e,Kr,Gr,Be,{size:0})}}function pl(n,e,t){const l=n.slice();return l[23]=e[t],l}function bl(n,e,t){const l=n.slice();return l[26]=e[t],l}function vl(n){var s;let e,t=n[8].t('This response was generated by "{{model}}"',{model:n[7]?((s=n[7])==null?void 0:s.name)??n[7].id:n[1].selectedModelId})+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(r){e=M(r,"DIV",{class:!0});var i=k(e);l=F(i,t),i.forEach(m),this.h()},h(){h(e,"class","text-xs font-medium pt-1.5 -mb-0.5")},m(r,i){V(r,e,i),p(e,l)},p(r,i){var a;i&386&&t!==(t=r[8].t('This response was generated by "{{model}}"',{model:r[7]?((a=r[7])==null?void 0:a.name)??r[7].id:r[1].selectedModelId})+"")&&K(l,t)},d(r){r&&m(e)}}}function kl(n){let e,t=n[26]+"",l,s,r,i,a,o;function f(){return n[12](n[26])}return{c(){e=I("button"),l=W(t),s=j(),this.h()},l(u){e=M(u,"BUTTON",{class:!0});var c=k(e);l=F(c,t),s=z(c),c.forEach(m),this.h()},h(){var u,c;h(e,"class",r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900"),e.disabled=i=((c=(u=n[1])==null?void 0:u.annotation)==null?void 0:c.rating)===-1?n[26]>5:n[26]<6},m(u,c){V(u,e,c),p(e,l),p(e,s),a||(o=ce(e,"click",f),a=!0)},p(u,c){var g,d;n=u,c&64&&r!==(r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900")&&h(e,"class",r),c&2&&i!==(i=((d=(g=n[1])==null?void 0:g.annotation)==null?void 0:d.rating)===-1?n[26]>5:n[26]<6)&&(e.disabled=i)},d(u){u&&m(e),a=!1,o()}}}function wl(n){let e,t=n[8].t("Why?")+"",l,s,r,i=De(n[3]),a=[];for(let o=0;o<i.length;o+=1)a[o]=yl(pl(n,i,o));return{c(){e=I("div"),l=W(t),s=j(),r=I("div");for(let o=0;o<a.length;o+=1)a[o].c();this.h()},l(o){e=M(o,"DIV",{class:!0});var f=k(e);l=F(f,t),f.forEach(m),s=z(o),r=M(o,"DIV",{class:!0});var u=k(r);for(let c=0;c<a.length;c+=1)a[c].l(u);u.forEach(m),this.h()},h(){h(e,"class","text-sm mt-1.5 font-medium"),h(r,"class","flex flex-wrap gap-1.5 text-sm mt-1.5")},m(o,f){V(o,e,f),p(e,l),V(o,s,f),V(o,r,f);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(r,null)},p(o,f){if(f&256&&t!==(t=o[8].t("Why?")+"")&&K(l,t),f&280){i=De(o[3]);let u;for(u=0;u<i.length;u+=1){const c=pl(o,i,u);a[u]?a[u].p(c,f):(a[u]=yl(c),a[u].c(),a[u].m(r,null))}for(;u<a.length;u+=1)a[u].d(1);a.length=i.length}},d(o){o&&(m(e),m(s),m(r)),Fe(a,o)}}}function Zr(n){let e=n[23]+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&8&&e!==(e=l[23]+"")&&K(t,e)},d(l){l&&m(t)}}}function Qr(n){let e=n[8].t("Other")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Other")+"")&&K(t,e)},d(l){l&&m(t)}}}function Yr(n){let e=n[8].t("Being lazy")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Being lazy")+"")&&K(t,e)},d(l){l&&m(t)}}}function Xr(n){let e=n[8].t("Refused when it shouldn't have")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Refused when it shouldn't have")+"")&&K(t,e)},d(l){l&&m(t)}}}function $r(n){let e=n[8].t("Didn't fully follow instructions")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Didn't fully follow instructions")+"")&&K(t,e)},d(l){l&&m(t)}}}function xr(n){let e=n[8].t("Not factually correct")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not factually correct")+"")&&K(t,e)},d(l){l&&m(t)}}}function ei(n){let e=n[8].t("Not helpful")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not helpful")+"")&&K(t,e)},d(l){l&&m(t)}}}function ti(n){let e=n[8].t("Too verbose")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Too verbose")+"")&&K(t,e)},d(l){l&&m(t)}}}function li(n){let e=n[8].t("Don't like the style")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Don't like the style")+"")&&K(t,e)},d(l){l&&m(t)}}}function si(n){let e=n[8].t("Thorough explanation")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Thorough explanation")+"")&&K(t,e)},d(l){l&&m(t)}}}function ni(n){let e=n[8].t("Attention to detail")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Attention to detail")+"")&&K(t,e)},d(l){l&&m(t)}}}function ri(n){let e=n[8].t("Positive attitude")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Positive attitude")+"")&&K(t,e)},d(l){l&&m(t)}}}function ii(n){let e=n[8].t("Showcased creativity")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Showcased creativity")+"")&&K(t,e)},d(l){l&&m(t)}}}function oi(n){let e=n[8].t("Followed instructions perfectly")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Followed instructions perfectly")+"")&&K(t,e)},d(l){l&&m(t)}}}function ai(n){let e=n[8].t("Accurate information")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Accurate information")+"")&&K(t,e)},d(l){l&&m(t)}}}function yl(n){let e,t,l,s,r;function i(u,c){return u[23]==="accurate_information"?ai:u[23]==="followed_instructions_perfectly"?oi:u[23]==="showcased_creativity"?ii:u[23]==="positive_attitude"?ri:u[23]==="attention_to_detail"?ni:u[23]==="thorough_explanation"?si:u[23]==="dont_like_the_style"?li:u[23]==="too_verbose"?ti:u[23]==="not_helpful"?ei:u[23]==="not_factually_correct"?xr:u[23]==="didnt_fully_follow_instructions"?$r:u[23]==="refused_when_it_shouldnt_have"?Xr:u[23]==="being_lazy"?Yr:u[23]==="other"?Qr:Zr}let a=i(n),o=a(n);function f(){return n[13](n[23])}return{c(){e=I("button"),o.c(),t=j(),this.h()},l(u){e=M(u,"BUTTON",{class:!0});var c=k(e);o.l(c),t=z(c),c.forEach(m),this.h()},h(){h(e,"class",l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")},m(u,c){V(u,e,c),o.m(e,null),p(e,t),s||(r=ce(e,"click",f),s=!0)},p(u,c){n=u,a===(a=i(n))&&o?o.p(n,c):(o.d(1),o=a(n),o&&(o.c(),o.m(e,t))),c&24&&l!==(l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")&&h(e,"class",l)},d(u){u&&m(e),o.d(),s=!1,r()}}}function fi(n){var $;let e,t,l,s,r=n[8].t("How would you rate this response?")+"",i,a,o,f='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path></svg>',u,c,g,d,_,y,w,E,C=n[8].t("Awful")+"",R,P,O,b,N=n[8].t("Amazing")+"",B,S,T,L,H,Y,oe,ie,re,ue,me,ke,q,Z=n[8].t("Save")+"",ge,pe,_e,J,he,ae=(($=n[1])==null?void 0:$.arena)&&vl(n),be=De(Array.from({length:10}).map(Il)),A=[];for(let Q=0;Q<be.length;Q+=1)A[Q]=kl(bl(n,be,Q));let G=n[3].length>0&&wl(n);return me=new Sr({props:{tags:n[2]}}),me.$on("delete",n[15]),me.$on("add",n[16]),{c(){ae&&ae.c(),e=j(),t=I("div"),l=I("div"),s=I("div"),i=W(r),a=j(),o=I("button"),o.innerHTML=f,u=j(),c=I("div"),g=I("div"),d=I("div");for(let Q=0;Q<A.length;Q+=1)A[Q].c();_=j(),y=I("div"),w=I("div"),E=W("1 - "),R=W(C),P=j(),O=I("div"),b=W("10 - "),B=W(N),S=j(),T=I("div"),G&&G.c(),L=j(),H=I("div"),Y=I("textarea"),ie=j(),re=I("div"),ue=I("div"),x(me.$$.fragment),ke=j(),q=I("button"),ge=W(Z),this.h()},l(Q){ae&&ae.l(Q),e=z(Q),t=M(Q,"DIV",{class:!0,id:!0});var fe=k(t);l=M(fe,"DIV",{class:!0});var ve=k(l);s=M(ve,"DIV",{class:!0});var Ce=k(s);i=F(Ce,r),Ce.forEach(m),a=z(ve),o=M(ve,"BUTTON",{"data-svelte-h":!0}),Ue(o)!=="svelte-1ew22ui"&&(o.innerHTML=f),ve.forEach(m),u=z(fe),c=M(fe,"DIV",{class:!0});var X=k(c);g=M(X,"DIV",{class:!0});var Re=k(g);d=M(Re,"DIV",{class:!0});var He=k(d);for(let nt=0;nt<A.length;nt+=1)A[nt].l(He);He.forEach(m),_=z(Re),y=M(Re,"DIV",{class:!0});var ze=k(y);w=M(ze,"DIV",{});var We=k(w);E=F(We,"1 - "),R=F(We,C),We.forEach(m),P=z(ze),O=M(ze,"DIV",{});var Xe=k(O);b=F(Xe,"10 - "),B=F(Xe,N),Xe.forEach(m),ze.forEach(m),Re.forEach(m),X.forEach(m),S=z(fe),T=M(fe,"DIV",{});var st=k(T);G&&G.l(st),st.forEach(m),L=z(fe),H=M(fe,"DIV",{class:!0});var at=k(H);Y=M(at,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),k(Y).forEach(m),at.forEach(m),ie=z(fe),re=M(fe,"DIV",{class:!0});var lt=k(re);ue=M(lt,"DIV",{class:!0});var ft=k(ue);ee(me.$$.fragment,ft),ft.forEach(m),ke=z(lt),q=M(lt,"BUTTON",{class:!0});var ut=k(q);ge=F(ut,Z),ut.forEach(m),lt.forEach(m),fe.forEach(m),this.h()},h(){h(s,"class","text-sm font-medium"),h(l,"class","flex justify-between items-center"),h(d,"class","mt-1.5 w-fit flex gap-1 pb-5"),h(y,"class","absolute bottom-0 left-0 right-0 flex justify-between text-xs"),h(g,"class","relative w-fit"),h(c,"class","w-full flex justify-center"),h(Y,"class","w-full text-sm px-1 py-2 bg-transparent outline-hidden resize-none rounded-xl"),h(Y,"placeholder",oe=n[8].t("Feel free to add specific details")),h(Y,"rows","3"),h(H,"class","mt-2"),h(ue,"class","flex items-end group"),h(q,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),h(re,"class","mt-2 gap-1.5 flex justify-between"),h(t,"class","my-2.5 rounded-xl px-4 py-3 border border-gray-100 dark:border-gray-850"),h(t,"id",pe="message-feedback-"+n[1].id)},m(Q,fe){ae&&ae.m(Q,fe),V(Q,e,fe),V(Q,t,fe),p(t,l),p(l,s),p(s,i),p(l,a),p(l,o),p(t,u),p(t,c),p(c,g),p(g,d);for(let ve=0;ve<A.length;ve+=1)A[ve]&&A[ve].m(d,null);p(g,_),p(g,y),p(y,w),p(w,E),p(w,R),p(y,P),p(y,O),p(O,b),p(O,B),p(t,S),p(t,T),G&&G.m(T,null),p(t,L),p(t,H),p(H,Y),it(Y,n[5]),p(t,ie),p(t,re),p(re,ue),te(me,ue,null),p(re,ke),p(re,q),p(q,ge),_e=!0,J||(he=[ce(o,"click",n[11]),ce(Y,"input",n[14]),ce(q,"click",n[17])],J=!0)},p(Q,[fe]){var Ce;if((Ce=Q[1])!=null&&Ce.arena?ae?ae.p(Q,fe):(ae=vl(Q),ae.c(),ae.m(e.parentNode,e)):ae&&(ae.d(1),ae=null),(!_e||fe&256)&&r!==(r=Q[8].t("How would you rate this response?")+"")&&K(i,r),fe&66){be=De(Array.from({length:10}).map(Il));let X;for(X=0;X<be.length;X+=1){const Re=bl(Q,be,X);A[X]?A[X].p(Re,fe):(A[X]=kl(Re),A[X].c(),A[X].m(d,null))}for(;X<A.length;X+=1)A[X].d(1);A.length=be.length}(!_e||fe&256)&&C!==(C=Q[8].t("Awful")+"")&&K(R,C),(!_e||fe&256)&&N!==(N=Q[8].t("Amazing")+"")&&K(B,N),Q[3].length>0?G?G.p(Q,fe):(G=wl(Q),G.c(),G.m(T,null)):G&&(G.d(1),G=null),(!_e||fe&256&&oe!==(oe=Q[8].t("Feel free to add specific details")))&&h(Y,"placeholder",oe),fe&32&&it(Y,Q[5]);const ve={};fe&4&&(ve.tags=Q[2]),me.$set(ve),(!_e||fe&256)&&Z!==(Z=Q[8].t("Save")+"")&&K(ge,Z),(!_e||fe&2&&pe!==(pe="message-feedback-"+Q[1].id))&&h(t,"id",pe)},i(Q){_e||(v(me.$$.fragment,Q),_e=!0)},o(Q){D(me.$$.fragment,Q),_e=!1},d(Q){Q&&(m(e),m(t)),ae&&ae.d(Q),Fe(A,Q),G&&G.d(),le(me),J=!1,Ye(he)}}}const Il=(n,e)=>e+1;function ui(n,e,t){let l,s;Ee(n,jt,T=>t(18,s=T));const r=Je("i18n");Ee(n,r,T=>t(8,l=T));const i=gt();let{message:a}=e,{show:o=!1}=e,f=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],u=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],c=[],g=[],d=null,_="",y=null,w=null;const E=()=>{var T,L,H,Y,oe;d||t(4,d=((T=a==null?void 0:a.annotation)==null?void 0:T.reason)??""),_||t(5,_=((L=a==null?void 0:a.annotation)==null?void 0:L.comment)??""),t(2,c=(((H=a==null?void 0:a.annotation)==null?void 0:H.tags)??[]).map(ie=>({name:ie}))),y||t(6,y=((oe=(Y=a==null?void 0:a.annotation)==null?void 0:Y.details)==null?void 0:oe.rating)??null)};vt(()=>{a!=null&&a.arena&&(t(7,w=s.find(T=>T.id===a.selectedModelId)),Ae.success(l.t('This response was generated by "{{model}}"',{model:w?(w==null?void 0:w.name)??w.id:a.selectedModelId})))});const C=()=>{console.log("saveHandler"),i("save",{reason:d,comment:_,tags:c.map(T=>T.name),details:{rating:y}}),Ae.success(l.t("Thanks for your feedback!")),t(0,o=!1)},R=()=>{t(0,o=!1)},P=T=>{t(6,y=T)},O=T=>{t(4,d=T)};function b(){_=this.value,t(5,_)}const N=T=>{t(2,c=c.filter(L=>L.name.replaceAll(" ","_").toLowerCase()!==T.detail.replaceAll(" ","_").toLowerCase()))},B=T=>{t(2,c=[...c,{name:T.detail}])},S=()=>{C()};return n.$$set=T=>{"message"in T&&t(1,a=T.message),"show"in T&&t(0,o=T.show)},n.$$.update=()=>{var T,L;n.$$.dirty&2&&(((T=a==null?void 0:a.annotation)==null?void 0:T.rating)===1?t(3,g=f):((L=a==null?void 0:a.annotation)==null?void 0:L.rating)===-1&&t(3,g=u)),n.$$.dirty&2&&a&&E()},[o,a,c,g,d,_,y,w,l,r,C,R,P,O,b,N,B,S]}class ci extends Pe{constructor(e){super(),Le(this,e,ui,fi,Be,{message:1,show:0})}}function Ml(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function di(n){let e,t;return e=new Tn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function hi(n){let e,t;return e=new Bn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function mi(n){let e,t,l,s,r;const i=n[2].default,a=ar(i,n,n[4],null),o=[hi,di],f=[];function u(c,g){return c[1]?0:1}return l=u(n),s=f[l]=o[l](n),{c(){e=I("div"),a&&a.c(),t=j(),s.c(),this.h()},l(c){e=M(c,"DIV",{class:!0});var g=k(e);a&&a.l(g),t=z(g),s.l(g),g.forEach(m),this.h()},h(){h(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition")},m(c,g){V(c,e,g),a&&a.m(e,null),p(e,t),f[l].m(e,null),r=!0},p(c,g){a&&a.p&&(!r||g&16)&&fr(a,i,c,c[4],r?cr(i,c[4],g,null):ur(c[4]),null);let d=l;l=u(c),l!==d&&(se(),D(f[d],1,1,()=>{f[d]=null}),ne(),s=f[l],s||(s=f[l]=o[l](c),s.c()),v(s,1),s.m(e,null))},i(c){r||(v(a,c),v(s),r=!0)},o(c){D(a,c),D(s),r=!1},d(c){c&&m(e),a&&a.d(c),f[l].d()}}}function El(n){let e,t,l,s,r,i=n[0].query+"",a,o,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',c,g;return l=new Or({}),{c(){e=I("a"),t=I("div"),x(l.$$.fragment),s=j(),r=I("div"),a=W(i),o=j(),f=I("div"),f.innerHTML=u,this.h()},l(d){e=M(d,"A",{href:!0,target:!0,class:!0});var _=k(e);t=M(_,"DIV",{class:!0});var y=k(t);ee(l.$$.fragment,y),s=z(y),r=M(y,"DIV",{class:!0});var w=k(r);a=F(w,i),w.forEach(m),y.forEach(m),o=z(_),f=M(_,"DIV",{class:!0,"data-svelte-h":!0}),Ue(f)!=="svelte-14xjows"&&(f.innerHTML=u),_.forEach(m),this.h()},h(){h(r,"class","line-clamp-1"),h(t,"class","flex gap-2 items-center"),h(f,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),h(e,"href",c="https://www.google.com/search?q="+n[0].query),h(e,"target","_blank"),h(e,"class","flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline")},m(d,_){V(d,e,_),p(e,t),te(l,t,null),p(t,s),p(t,r),p(r,a),p(e,o),p(e,f),g=!0},p(d,_){(!g||_&1)&&i!==(i=d[0].query+"")&&K(a,i),(!g||_&1&&c!==(c="https://www.google.com/search?q="+d[0].query))&&h(e,"href",c)},i(d){g||(v(l.$$.fragment,d),g=!0)},o(d){D(l.$$.fragment,d),g=!1},d(d){d&&m(e),le(l)}}}function Nl(n){let e,t,l=n[5]+"",s,r,i,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',o,f,u;return{c(){e=I("a"),t=I("div"),s=W(l),r=j(),i=I("div"),i.innerHTML=a,o=j(),this.h()},l(c){e=M(c,"A",{href:!0,target:!0,class:!0});var g=k(e);t=M(g,"DIV",{class:!0});var d=k(t);s=F(d,l),d.forEach(m),r=z(g),i=M(g,"DIV",{class:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-14xjows"&&(i.innerHTML=a),o=z(g),g.forEach(m),this.h()},h(){h(t,"class","line-clamp-1"),h(i,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),h(e,"href",f=n[5]),h(e,"target","_blank"),h(e,"class",u="flex w-full items-center p-3 px-4 "+(n[7]===n[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")},m(c,g){V(c,e,g),p(e,t),p(t,s),p(e,r),p(e,i),p(e,o)},p(c,g){g&1&&l!==(l=c[5]+"")&&K(s,l),g&1&&f!==(f=c[5])&&h(e,"href",f),g&1&&u!==(u="flex w-full items-center p-3 px-4 "+(c[7]===c[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")&&h(e,"class",u)},d(c){c&&m(e)}}}function gi(n){var a;let e,t,l,s=((a=n[0])==null?void 0:a.query)&&El(n),r=De(n[0].urls),i=[];for(let o=0;o<r.length;o+=1)i[o]=Nl(Ml(n,r,o));return{c(){e=I("div"),s&&s.c(),t=j();for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=M(o,"DIV",{class:!0,slot:!0});var f=k(e);s&&s.l(f),t=z(f);for(let u=0;u<i.length;u+=1)i[u].l(f);f.forEach(m),this.h()},h(){h(e,"class","text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5"),h(e,"slot","content")},m(o,f){V(o,e,f),s&&s.m(e,null),p(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);l=!0},p(o,f){var u;if((u=o[0])!=null&&u.query?s?(s.p(o,f),f&1&&v(s,1)):(s=El(o),s.c(),v(s,1),s.m(e,t)):s&&(se(),D(s,1,1,()=>{s=null}),ne()),f&1){r=De(o[0].urls);let c;for(c=0;c<r.length;c+=1){const g=Ml(o,r,c);i[c]?i[c].p(g,f):(i[c]=Nl(g),i[c].c(),i[c].m(e,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=r.length}},i(o){l||(v(s),l=!0)},o(o){D(s),l=!1},d(o){o&&m(e),s&&s.d(),Fe(i,o)}}}function _i(n){let e,t,l;function s(i){n[3](i)}let r={className:"w-full space-y-1",$$slots:{content:[gi],default:[mi]},$$scope:{ctx:n}};return n[1]!==void 0&&(r.open=n[1]),e=new Sn({props:r}),je.push(()=>Qe(e,"open",s)),{c(){x(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,a){te(e,i,a),l=!0},p(i,[a]){const o={};a&19&&(o.$$scope={dirty:a,ctx:i}),!t&&a&2&&(t=!0,o.open=i[1],Ze(()=>t=!1)),e.$set(o)},i(i){l||(v(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){le(e,i)}}}function pi(n,e,t){let{$$slots:l={},$$scope:s}=e,{status:r={urls:[],query:""}}=e,i=!1;function a(o){i=o,t(1,i)}return n.$$set=o=>{"status"in o&&t(0,r=o.status),"$$scope"in o&&t(4,s=o.$$scope)},[r,i,l,a,s]}class bi extends Pe{constructor(e){super(),Le(this,e,pi,_i,Be,{status:0})}}function vi(n){let e,t,l,s,r,i=(typeof n[0]=="string"?n[0]:JSON.stringify(n[0]))+"",a,o;return l=new Hr({props:{className:"size-5 text-red-700 dark:text-red-400"}}),{c(){e=I("div"),t=I("div"),x(l.$$.fragment),s=j(),r=I("div"),a=W(i),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=k(e);t=M(u,"DIV",{class:!0});var c=k(t);ee(l.$$.fragment,c),c.forEach(m),s=z(u),r=M(u,"DIV",{class:!0});var g=k(r);a=F(g,i),g.forEach(m),u.forEach(m),this.h()},h(){h(t,"class","self-start mt-0.5"),h(r,"class","self-center text-sm"),h(e,"class","flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg")},m(f,u){V(f,e,u),p(e,t),te(l,t,null),p(e,s),p(e,r),p(r,a),o=!0},p(f,[u]){(!o||u&1)&&i!==(i=(typeof f[0]=="string"?f[0]:JSON.stringify(f[0]))+"")&&K(a,i)},i(f){o||(v(l.$$.fragment,f),o=!0)},o(f){D(l.$$.fragment,f),o=!1},d(f){f&&m(e),le(l)}}}function ki(n,e,t){let{content:l=""}=e;return n.$$set=s=>{"content"in s&&t(0,l=s.content)},[l]}let wi=class extends Pe{constructor(e){super(),Le(this,e,ki,vi,Be,{content:0})}};function Dl(n,e,t){const l=n.slice();return l[10]=e[t],l[12]=t,l}function yi(n){const e=n.slice(),t=Ri(e[10].distance);return e[13]=t,e}function Ii(n){let e,t=n[4].t("No source available")+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);l=F(r,t),r.forEach(m),this.h()},h(){h(e,"class","text-sm dark:text-gray-400")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No source available")+"")&&K(l,t)},i:ye,o:ye,d(s){s&&m(e)}}}function Mi(n){let e,t,l,s;e=new Se({props:{className:"w-fit",content:n[4].t("Open file"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Ei]},$$scope:{ctx:n}}});let r=n[2]&&Cl(n);return{c(){x(e.$$.fragment),t=j(),r&&r.c(),l=de()},l(i){ee(e.$$.fragment,i),t=z(i),r&&r.l(i),l=de()},m(i,a){te(e,i,a),V(i,t,a),r&&r.m(i,a),V(i,l,a),s=!0},p(i,a){const o={};a&16&&(o.content=i[4].t("Open file")),a&16408&&(o.$$scope={dirty:a,ctx:i}),e.$set(o),i[2]?r?(r.p(i,a),a&4&&v(r,1)):(r=Cl(i),r.c(),v(r,1),r.m(l.parentNode,l)):r&&(se(),D(r,1,1,()=>{r=null}),ne())},i(i){s||(v(e.$$.fragment,i),v(r),s=!0)},o(i){D(e.$$.fragment,i),D(r),s=!1},d(i){i&&(m(t),m(l)),le(e,i),r&&r.d(i)}}}function Vl(n){let e,t,l=n[4].t("page")+"",s,r,i=n[10].metadata.page+1+"",a,o;return{c(){e=I("span"),t=W("("),s=W(l),r=j(),a=W(i),o=W(")"),this.h()},l(f){e=M(f,"SPAN",{class:!0});var u=k(e);t=F(u,"("),s=F(u,l),r=z(u),a=F(u,i),o=F(u,")"),u.forEach(m),this.h()},h(){h(e,"class","text-xs text-gray-500 dark:text-gray-400")},m(f,u){V(f,e,u),p(e,t),p(e,s),p(e,r),p(e,a),p(e,o)},p(f,u){u&16&&l!==(l=f[4].t("page")+"")&&K(s,l),u&8&&i!==(i=f[10].metadata.page+1+"")&&K(a,i)},d(f){f&&m(e)}}}function Ei(n){var o,f,u,c;let e,t,l=n[6](((f=(o=n[10])==null?void 0:o.metadata)==null?void 0:f.name)??n[10].source.name)+"",s,r,i,a=((c=(u=n[10])==null?void 0:u.metadata)==null?void 0:c.page)&&Vl(n);return{c(){e=I("div"),t=I("a"),s=W(l),i=j(),a&&a.c(),this.h()},l(g){e=M(g,"DIV",{class:!0});var d=k(e);t=M(d,"A",{class:!0,href:!0,target:!0});var _=k(t);s=F(_,l),_.forEach(m),i=z(d),a&&a.l(d),d.forEach(m),this.h()},h(){var g,d,_,y,w,E,C,R;h(t,"class","hover:text-gray-500 dark:hover:text-gray-100 underline grow"),h(t,"href",r=(d=(g=n[10])==null?void 0:g.metadata)!=null&&d.file_id?`${ul}/files/${(y=(_=n[10])==null?void 0:_.metadata)==null?void 0:y.file_id}/content${((E=(w=n[10])==null?void 0:w.metadata)==null?void 0:E.page)!==void 0?`#page=${n[10].metadata.page+1}`:""}`:(R=(C=n[10].source)==null?void 0:C.url)!=null&&R.includes("http")?n[10].source.url:"#"),h(t,"target","_blank"),h(e,"class","text-sm dark:text-gray-400 flex items-center gap-2 w-fit")},m(g,d){V(g,e,d),p(e,t),p(t,s),p(e,i),a&&a.m(e,null)},p(g,d){var _,y,w,E,C,R,P,O,b,N,B,S;d&8&&l!==(l=g[6](((y=(_=g[10])==null?void 0:_.metadata)==null?void 0:y.name)??g[10].source.name)+"")&&K(s,l),d&8&&r!==(r=(E=(w=g[10])==null?void 0:w.metadata)!=null&&E.file_id?`${ul}/files/${(R=(C=g[10])==null?void 0:C.metadata)==null?void 0:R.file_id}/content${((O=(P=g[10])==null?void 0:P.metadata)==null?void 0:O.page)!==void 0?`#page=${g[10].metadata.page+1}`:""}`:(N=(b=g[10].source)==null?void 0:b.url)!=null&&N.includes("http")?g[10].source.url:"#")&&h(t,"href",r),(S=(B=g[10])==null?void 0:B.metadata)!=null&&S.page?a?a.p(g,d):(a=Vl(g),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},d(g){g&&m(e),a&&a.d()}}}function Cl(n){let e,t=n[4].t("Relevance")+"",l,s,r,i,a,o;const f=[Di,Ni],u=[];function c(g,d){return g[10].distance!==void 0?0:1}return r=c(n),i=u[r]=f[r](n),{c(){e=I("div"),l=W(t),s=j(),i.c(),a=de(),this.h()},l(g){e=M(g,"DIV",{class:!0});var d=k(e);l=F(d,t),d.forEach(m),s=z(g),i.l(g),a=de(),this.h()},h(){h(e,"class","text-sm font-medium dark:text-gray-300 mt-2")},m(g,d){V(g,e,d),p(e,l),V(g,s,d),u[r].m(g,d),V(g,a,d),o=!0},p(g,d){(!o||d&16)&&t!==(t=g[4].t("Relevance")+"")&&K(l,t);let _=r;r=c(g),r===_?u[r].p(g,d):(se(),D(u[_],1,1,()=>{u[_]=null}),ne(),i=u[r],i?i.p(g,d):(i=u[r]=f[r](g),i.c()),v(i,1),i.m(a.parentNode,a))},i(g){o||(v(i),o=!0)},o(g){D(i),o=!1},d(g){g&&(m(e),m(s),m(a)),u[r].d(g)}}}function Ni(n){let e,t=n[4].t("No distance available")+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);l=F(r,t),r.forEach(m),this.h()},h(){h(e,"class","text-sm dark:text-gray-400")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No distance available")+"")&&K(l,t)},i:ye,o:ye,d(s){s&&m(e)}}}function Di(n){let e,t;return e=new Se({props:{className:"w-fit",content:n[4].t("Semantic distance to query"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Ci]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s&16&&(r.content=l[4].t("Semantic distance to query")),s&16394&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Vi(n){var i;let e,t,l=(((i=n[10])==null?void 0:i.distance)??0).toFixed(4)+"",s,r;return{c(){e=I("span"),t=W("("),s=W(l),r=W(")"),this.h()},l(a){e=M(a,"SPAN",{class:!0});var o=k(e);t=F(o,"("),s=F(o,l),r=F(o,")"),o.forEach(m),this.h()},h(){h(e,"class","text-gray-500 dark:text-gray-500")},m(a,o){V(a,e,o),p(e,t),p(e,s),p(e,r)},p(a,o){var f;o&8&&l!==(l=(((f=a[10])==null?void 0:f.distance)??0).toFixed(4)+"")&&K(s,l)},d(a){a&&m(e)}}}function Tl(n){var r;let e,t,l=typeof n[13]=="number"&&Bl(n),s=typeof((r=n[10])==null?void 0:r.distance)=="number"&&Sl(n);return{c(){l&&l.c(),e=j(),s&&s.c(),t=de()},l(i){l&&l.l(i),e=z(i),s&&s.l(i),t=de()},m(i,a){l&&l.m(i,a),V(i,e,a),s&&s.m(i,a),V(i,t,a)},p(i,a){var o;typeof i[13]=="number"?l?l.p(i,a):(l=Bl(i),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),typeof((o=i[10])==null?void 0:o.distance)=="number"?s?s.p(i,a):(s=Sl(i),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},d(i){i&&(m(e),m(t)),l&&l.d(i),s&&s.d(i)}}}function Bl(n){let e,t=n[13].toFixed(2)+"",l,s,r;return{c(){e=I("span"),l=W(t),s=W("%"),this.h()},l(i){e=M(i,"SPAN",{class:!0});var a=k(e);l=F(a,t),s=F(a,"%"),a.forEach(m),this.h()},h(){h(e,"class",r=`px-1 rounded-sm font-medium ${Pl(n[13])}`)},m(i,a){V(i,e,a),p(e,l),p(e,s)},p(i,a){a&8&&t!==(t=i[13].toFixed(2)+"")&&K(l,t),a&8&&r!==(r=`px-1 rounded-sm font-medium ${Pl(i[13])}`)&&h(e,"class",r)},d(i){i&&m(e)}}}function Sl(n){var i;let e,t,l=(((i=n[10])==null?void 0:i.distance)??0).toFixed(4)+"",s,r;return{c(){e=I("span"),t=W("("),s=W(l),r=W(")"),this.h()},l(a){e=M(a,"SPAN",{class:!0});var o=k(e);t=F(o,"("),s=F(o,l),r=F(o,")"),o.forEach(m),this.h()},h(){h(e,"class","text-gray-500 dark:text-gray-500")},m(a,o){V(a,e,o),p(e,t),p(e,s),p(e,r)},p(a,o){var f;o&8&&l!==(l=(((f=a[10])==null?void 0:f.distance)??0).toFixed(4)+"")&&K(s,l)},d(a){a&&m(e)}}}function Ci(n){let e;function t(i,a){var o;if(i[1])return Tl;if(typeof((o=i[10])==null?void 0:o.distance)=="number")return Vi}function l(i,a){return a===Tl?yi(i):i}let s=t(n),r=s&&s(l(n,s));return{c(){e=I("div"),r&&r.c(),this.h()},l(i){e=M(i,"DIV",{class:!0});var a=k(e);r&&r.l(a),a.forEach(m),this.h()},h(){h(e,"class","text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit")},m(i,a){V(i,e,a),r&&r.m(e,null)},p(i,a){s===(s=t(i))&&r?r.p(l(i,s),a):(r&&r.d(1),r=s&&s(l(i,s)),r&&(r.c(),r.m(e,null)))},d(i){i&&m(e),r&&r.d()}}}function Ti(n){let e,t,l=n[10].document+"",s,r;return{c(){e=I("pre"),t=W("                "),s=W(l),r=W(`
              `),this.h()},l(i){e=M(i,"PRE",{class:!0});var a=k(e);t=F(a,"                "),s=F(a,l),r=F(a,`
              `),a.forEach(m),this.h()},h(){h(e,"class","text-sm dark:text-gray-400 whitespace-pre-line")},m(i,a){V(i,e,a),p(e,t),p(e,s),p(e,r)},p(i,a){a&8&&l!==(l=i[10].document+"")&&K(s,l)},d(i){i&&m(e)}}}function Bi(n){let e,t,l;return{c(){e=I("iframe"),this.h()},l(s){e=M(s,"IFRAME",{class:!0,sandbox:!0,srcdoc:!0,title:!0}),k(e).forEach(m),this.h()},h(){h(e,"class","w-full border-0 h-auto rounded-none"),h(e,"sandbox","allow-scripts allow-forms allow-same-origin"),h(e,"srcdoc",t=n[10].document),h(e,"title",l=n[4].t("Content"))},m(s,r){V(s,e,r)},p(s,r){r&8&&t!==(t=s[10].document)&&h(e,"srcdoc",t),r&16&&l!==(l=s[4].t("Content"))&&h(e,"title",l)},d(s){s&&m(e)}}}function Ol(n){let e;return{c(){e=I("hr"),this.h()},l(t){e=M(t,"HR",{class:!0}),this.h()},h(){h(e,"class","border-gray-100 dark:border-gray-850 my-3")},m(t,l){V(t,e,l)},d(t){t&&m(e)}}}function Rl(n){let e,t,l=n[4].t("Source")+"",s,r,i,a,o,f,u,c=n[4].t("Content")+"",g,d,_,y,w;const E=[Mi,Ii],C=[];function R(B,S){var T;return(T=B[10].source)!=null&&T.name?0:1}i=R(n),a=C[i]=E[i](n);function P(B,S){var T;return(T=B[10].metadata)!=null&&T.html?Bi:Ti}let O=P(n),b=O(n),N=n[12]!==n[3].length-1&&Ol();return{c(){e=I("div"),t=I("div"),s=W(l),r=j(),a.c(),o=j(),f=I("div"),u=I("div"),g=W(c),d=j(),b.c(),_=j(),N&&N.c(),y=de(),this.h()},l(B){e=M(B,"DIV",{class:!0});var S=k(e);t=M(S,"DIV",{class:!0});var T=k(t);s=F(T,l),T.forEach(m),r=z(S),a.l(S),S.forEach(m),o=z(B),f=M(B,"DIV",{class:!0});var L=k(f);u=M(L,"DIV",{class:!0});var H=k(u);g=F(H,c),H.forEach(m),d=z(L),b.l(L),L.forEach(m),_=z(B),N&&N.l(B),y=de(),this.h()},h(){h(t,"class","text-sm font-medium dark:text-gray-300"),h(e,"class","flex flex-col w-full"),h(u,"class","text-sm font-medium dark:text-gray-300 mt-2"),h(f,"class","flex flex-col w-full")},m(B,S){V(B,e,S),p(e,t),p(t,s),p(e,r),C[i].m(e,null),V(B,o,S),V(B,f,S),p(f,u),p(u,g),p(f,d),b.m(f,null),V(B,_,S),N&&N.m(B,S),V(B,y,S),w=!0},p(B,S){(!w||S&16)&&l!==(l=B[4].t("Source")+"")&&K(s,l);let T=i;i=R(B),i===T?C[i].p(B,S):(se(),D(C[T],1,1,()=>{C[T]=null}),ne(),a=C[i],a?a.p(B,S):(a=C[i]=E[i](B),a.c()),v(a,1),a.m(e,null)),(!w||S&16)&&c!==(c=B[4].t("Content")+"")&&K(g,c),O===(O=P(B))&&b?b.p(B,S):(b.d(1),b=O(B),b&&(b.c(),b.m(f,null))),B[12]!==B[3].length-1?N||(N=Ol(),N.c(),N.m(y.parentNode,y)):N&&(N.d(1),N=null)},i(B){w||(v(a),w=!0)},o(B){D(a),w=!1},d(B){B&&(m(e),m(o),m(f),m(_),m(y)),C[i].d(),b.d(),N&&N.d(B)}}}function Si(n){let e,t,l,s=n[4].t("Citation")+"",r,i,a,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',f,u,c,g,d,_,y=De(n[3]),w=[];for(let C=0;C<y.length;C+=1)w[C]=Rl(Dl(n,y,C));const E=C=>D(w[C],1,1,()=>{w[C]=null});return{c(){e=I("div"),t=I("div"),l=I("div"),r=W(s),i=j(),a=I("button"),a.innerHTML=o,f=j(),u=I("div"),c=I("div");for(let C=0;C<w.length;C+=1)w[C].c();this.h()},l(C){e=M(C,"DIV",{});var R=k(e);t=M(R,"DIV",{class:!0});var P=k(t);l=M(P,"DIV",{class:!0});var O=k(l);r=F(O,s),O.forEach(m),i=z(P),a=M(P,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(a)!=="svelte-745w2y"&&(a.innerHTML=o),P.forEach(m),f=z(R),u=M(R,"DIV",{class:!0});var b=k(u);c=M(b,"DIV",{class:!0});var N=k(c);for(let B=0;B<w.length;B+=1)w[B].l(N);N.forEach(m),b.forEach(m),R.forEach(m),this.h()},h(){h(l,"class","text-lg font-medium self-center capitalize"),h(a,"class","self-center"),h(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),h(c,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),h(u,"class","flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4")},m(C,R){V(C,e,R),p(e,t),p(t,l),p(l,r),p(t,i),p(t,a),p(e,f),p(e,u),p(u,c);for(let P=0;P<w.length;P+=1)w[P]&&w[P].m(c,null);g=!0,d||(_=ce(a,"click",n[8]),d=!0)},p(C,R){if((!g||R&16)&&s!==(s=C[4].t("Citation")+"")&&K(r,s),R&94){y=De(C[3]);let P;for(P=0;P<y.length;P+=1){const O=Dl(C,y,P);w[P]?(w[P].p(O,R),v(w[P],1)):(w[P]=Rl(O),w[P].c(),v(w[P],1),w[P].m(c,null))}for(se(),P=y.length;P<w.length;P+=1)E(P);ne()}},i(C){if(!g){for(let R=0;R<y.length;R+=1)v(w[R]);g=!0}},o(C){w=w.filter(Boolean);for(let R=0;R<w.length;R+=1)D(w[R]);g=!1},d(C){C&&m(e),Fe(w,C),d=!1,_()}}}function Oi(n){let e,t,l;function s(i){n[9](i)}let r={size:"lg",$$slots:{default:[Si]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new Rn({props:r}),je.push(()=>Qe(e,"show",s)),{c(){x(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,a){te(e,i,a),l=!0},p(i,[a]){const o={};a&16415&&(o.$$scope={dirty:a,ctx:i}),!t&&a&1&&(t=!0,o.show=i[0],Ze(()=>t=!1)),e.$set(o)},i(i){l||(v(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){le(e,i)}}}function Ri(n){return typeof n!="number"?null:n<0?0:n>1?100:Math.round(n*1e4)/100}function Pl(n){return n>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":n>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":n>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}function Pi(n,e,t){let l;const s=Je("i18n");Ee(n,s,d=>t(4,l=d));let{show:r=!1}=e,{citation:i}=e,{showPercentage:a=!1}=e,{showRelevance:o=!0}=e,f=[];const u=d=>{try{return decodeURIComponent(d)}catch{return d}},c=()=>{t(0,r=!1)};function g(d){r=d,t(0,r)}return n.$$set=d=>{"show"in d&&t(0,r=d.show),"citation"in d&&t(7,i=d.citation),"showPercentage"in d&&t(1,a=d.showPercentage),"showRelevance"in d&&t(2,o=d.showRelevance)},n.$$.update=()=>{var d;n.$$.dirty&136&&i&&(t(3,f=(d=i.document)==null?void 0:d.map((_,y)=>{var w,E;return{source:i.source,document:_,metadata:(w=i.metadata)==null?void 0:w[y],distance:(E=i.distances)==null?void 0:E[y]}})),f.every(_=>_.distance!==void 0)&&t(3,f=f.sort((_,y)=>(y.distance??1/0)-(_.distance??1/0))))},[r,a,o,f,l,s,u,i,c,g]}class Li extends Pe{constructor(e){super(),Le(this,e,Pi,Oi,Be,{show:0,citation:7,showPercentage:1,showRelevance:2})}}function Ll(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Al(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Hl(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function jl(n){let e,t,l,s;const r=[Hi,Ai],i=[];function a(o,f){return o[1].length<=3?0:1}return t=a(n),l=i[t]=r[t](n),{c(){e=I("div"),l.c(),this.h()},l(o){e=M(o,"DIV",{class:!0});var f=k(e);l.l(f),f.forEach(m),this.h()},h(){h(e,"class","py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap")},m(o,f){V(o,e,f),i[t].m(e,null),s=!0},p(o,f){let u=t;t=a(o),t===u?i[t].p(o,f):(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),l=i[t],l?l.p(o,f):(l=i[t]=r[t](o),l.c()),v(l,1),l.m(e,null))},i(o){s||(v(l),s=!0)},o(o){D(l),s=!1},d(o){o&&m(e),i[t].d()}}}function Ai(n){let e,t,l;function s(i){n[18](i)}let r={id:`collapsible-${n[0]}`,className:"w-full max-w-full ",buttonClassName:"w-fit max-w-full",$$slots:{content:[qi],default:[Ui]},$$scope:{ctx:n}};return n[6]!==void 0&&(r.open=n[6]),e=new Sn({props:r}),je.push(()=>Qe(e,"open",s)),{c(){x(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,a){te(e,i,a),l=!0},p(i,a){const o={};a&1&&(o.id=`collapsible-${i[0]}`),a&16777459&&(o.$$scope={dirty:a,ctx:i}),!t&&a&64&&(t=!0,o.open=i[6],Ze(()=>t=!1)),e.$set(o)},i(i){l||(v(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){le(e,i)}}}function Hi(n){let e,t=De(n[1]),l=[];for(let s=0;s<t.length;s+=1)l[s]=Jl(Hl(n,t,s));return{c(){e=I("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);for(let i=0;i<l.length;i+=1)l[i].l(r);r.forEach(m),this.h()},h(){h(e,"class","flex text-xs font-medium flex-wrap")},m(s,r){V(s,e,r);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(s,r){if(r&563){t=De(s[1]);let i;for(i=0;i<t.length;i+=1){const a=Hl(s,t,i);l[i]?l[i].p(a,r):(l[i]=Jl(a),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},i:ye,o:ye,d(s){s&&m(e),Fe(l,s)}}}function zl(n){let e,t=n[21]+1+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);l=F(r,t),r.forEach(m),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),p(e,l)},d(s){s&&m(e)}}}function Ul(n){let e,t=n[1].every(n[13]),l,s,r=n[9](n[19].source.name)+"",i,a,o,f,u=t&&zl(n);function c(){return n[17](n[19])}return{c(){e=I("button"),u&&u.c(),l=j(),s=I("div"),i=W(r),a=j(),this.h()},l(g){e=M(g,"BUTTON",{class:!0});var d=k(e);u&&u.l(d),l=z(d),s=M(d,"DIV",{class:!0});var _=k(s);i=F(_,r),_.forEach(m),a=z(d),d.forEach(m),this.h()},h(){h(s,"class","flex-1 mx-1 truncate"),h(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(g,d){V(g,e,d),u&&u.m(e,null),p(e,l),p(e,s),p(s,i),p(e,a),o||(f=[ce(e,"click",c),ce(e,"pointerup",Gi)],o=!0)},p(g,d){n=g,d&2&&(t=n[1].every(n[13])),t?u||(u=zl(n),u.c(),u.m(e,l)):u&&(u.d(1),u=null),d&2&&r!==(r=n[9](n[19].source.name)+"")&&K(i,r)},d(g){g&&m(e),u&&u.d(),o=!1,Ye(f)}}}function ji(n){let e,t;return e=new Tn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function zi(n){let e,t;return e=new Bn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Ui(n){let e,t,l,s=n[7].t("References from")+"",r,i,a,o,f,u,c,g=n[7].t("and")+"",d,_,y=n[1].length-2+"",w,E,C,R=n[7].t("more")+"",P,O,b,N,B,S,T=De(n[1].slice(0,2)),L=[];for(let ie=0;ie<T.length;ie+=1)L[ie]=Ul(Ll(n,T,ie));const H=[zi,ji],Y=[];function oe(ie,re){return ie[6]?0:1}return N=oe(n),B=Y[N]=H[N](n),{c(){e=I("div"),t=I("div"),l=I("span"),r=W(s),i=j(),a=I("div"),o=I("div");for(let ie=0;ie<L.length;ie+=1)L[ie].c();f=j(),u=I("div"),c=I("span"),d=W(g),_=j(),w=W(y),E=j(),C=I("span"),P=W(R),O=j(),b=I("div"),B.c(),this.h()},l(ie){e=M(ie,"DIV",{class:!0});var re=k(e);t=M(re,"DIV",{class:!0});var ue=k(t);l=M(ue,"SPAN",{class:!0});var me=k(l);r=F(me,s),me.forEach(m),i=z(ue),a=M(ue,"DIV",{class:!0});var ke=k(a);o=M(ke,"DIV",{class:!0});var q=k(o);for(let J=0;J<L.length;J+=1)L[J].l(q);q.forEach(m),ke.forEach(m),f=z(ue),u=M(ue,"DIV",{class:!0});var Z=k(u);c=M(Z,"SPAN",{class:!0});var ge=k(c);d=F(ge,g),ge.forEach(m),_=z(Z),w=F(Z,y),E=z(Z),C=M(Z,"SPAN",{});var pe=k(C);P=F(pe,R),pe.forEach(m),Z.forEach(m),ue.forEach(m),O=z(re),b=M(re,"DIV",{class:!0});var _e=k(b);B.l(_e),_e.forEach(m),re.forEach(m),this.h()},h(){h(l,"class","whitespace-nowrap hidden sm:inline shrink-0"),h(o,"class","flex text-xs font-medium items-center"),h(a,"class","flex items-center overflow-auto scrollbar-none w-full max-w-full flex-1"),h(c,"class","hidden sm:inline"),h(u,"class","flex items-center gap-1 whitespace-nowrap shrink-0"),h(t,"class","flex-1 flex items-center gap-1 overflow-auto scrollbar-none w-full max-w-full"),h(b,"class","shrink-0"),h(e,"class","flex w-full overflow-auto items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer")},m(ie,re){V(ie,e,re),p(e,t),p(t,l),p(l,r),p(t,i),p(t,a),p(a,o);for(let ue=0;ue<L.length;ue+=1)L[ue]&&L[ue].m(o,null);p(t,f),p(t,u),p(u,c),p(c,d),p(u,_),p(u,w),p(u,E),p(u,C),p(C,P),p(e,O),p(e,b),Y[N].m(b,null),S=!0},p(ie,re){if((!S||re&128)&&s!==(s=ie[7].t("References from")+"")&&K(r,s),re&562){T=De(ie[1].slice(0,2));let me;for(me=0;me<T.length;me+=1){const ke=Ll(ie,T,me);L[me]?L[me].p(ke,re):(L[me]=Ul(ke),L[me].c(),L[me].m(o,null))}for(;me<L.length;me+=1)L[me].d(1);L.length=T.length}(!S||re&128)&&g!==(g=ie[7].t("and")+"")&&K(d,g),(!S||re&2)&&y!==(y=ie[1].length-2+"")&&K(w,y),(!S||re&128)&&R!==(R=ie[7].t("more")+"")&&K(P,R);let ue=N;N=oe(ie),N!==ue&&(se(),D(Y[ue],1,1,()=>{Y[ue]=null}),ne(),B=Y[N],B||(B=Y[N]=H[N](ie),B.c()),v(B,1),B.m(b,null))},i(ie){S||(v(B),S=!0)},o(ie){D(B),S=!1},d(ie){ie&&m(e),Fe(L,ie),Y[N].d()}}}function ql(n){let e,t=n[21]+1+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);l=F(r,t),r.forEach(m),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),p(e,l)},d(s){s&&m(e)}}}function Wl(n){let e,t=n[1].every(n[12]),l,s,r=n[9](n[19].source.name)+"",i,a,o,f,u,c=t&&ql(n);function g(){return n[16](n[19])}return{c(){e=I("button"),c&&c.c(),l=j(),s=I("div"),i=W(r),a=j(),this.h()},l(d){e=M(d,"BUTTON",{id:!0,class:!0});var _=k(e);c&&c.l(_),l=z(_),s=M(_,"DIV",{class:!0});var y=k(s);i=F(y,r),y.forEach(m),a=z(_),_.forEach(m),this.h()},h(){h(s,"class","flex-1 mx-1 truncate"),h(e,"id",o=`source-${n[0]}-${n[21]+1}`),h(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(d,_){V(d,e,_),c&&c.m(e,null),p(e,l),p(e,s),p(s,i),p(e,a),f||(u=ce(e,"click",g),f=!0)},p(d,_){n=d,_&2&&(t=n[1].every(n[12])),t?c||(c=ql(n),c.c(),c.m(e,l)):c&&(c.d(1),c=null),_&2&&r!==(r=n[9](n[19].source.name)+"")&&K(i,r),_&1&&o!==(o=`source-${n[0]}-${n[21]+1}`)&&h(e,"id",o)},d(d){d&&m(e),c&&c.d(),f=!1,u()}}}function qi(n){let e,t,l=De(n[1]),s=[];for(let r=0;r<l.length;r+=1)s[r]=Wl(Al(n,l,r));return{c(){e=I("div"),t=I("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=M(r,"DIV",{slot:!0});var i=k(e);t=M(i,"DIV",{class:!0});var a=k(t);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(m),i.forEach(m),this.h()},h(){h(t,"class","flex text-xs font-medium flex-wrap"),h(e,"slot","content")},m(r,i){V(r,e,i),p(e,t);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(t,null)},p(r,i){if(i&563){l=De(r[1]);let a;for(a=0;a<l.length;a+=1){const o=Al(r,l,a);s[a]?s[a].p(o,i):(s[a]=Wl(o),s[a].c(),s[a].m(t,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=l.length}},d(r){r&&m(e),Fe(s,r)}}}function Fl(n){let e,t=n[21]+1+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);l=F(r,t),r.forEach(m),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),p(e,l)},d(s){s&&m(e)}}}function Jl(n){let e,t=n[1].every(n[11]),l,s,r=n[9](n[19].source.name)+"",i,a,o,f,u,c=t&&Fl(n);function g(){return n[15](n[19])}return{c(){e=I("button"),c&&c.c(),l=j(),s=I("div"),i=W(r),a=j(),this.h()},l(d){e=M(d,"BUTTON",{id:!0,class:!0});var _=k(e);c&&c.l(_),l=z(_),s=M(_,"DIV",{class:!0});var y=k(s);i=F(y,r),y.forEach(m),a=z(_),_.forEach(m),this.h()},h(){h(s,"class","flex-1 mx-1 truncate text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition"),h(e,"id",o=`source-${n[0]}-${n[21]+1}`),h(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96")},m(d,_){V(d,e,_),c&&c.m(e,null),p(e,l),p(e,s),p(s,i),p(e,a),f||(u=ce(e,"click",g),f=!0)},p(d,_){n=d,_&2&&(t=n[1].every(n[11])),t?c||(c=Fl(n),c.c(),c.m(e,l)):c&&(c.d(1),c=null),_&2&&r!==(r=n[9](n[19].source.name)+"")&&K(i,r),_&1&&o!==(o=`source-${n[0]}-${n[21]+1}`)&&h(e,"id",o)},d(d){d&&m(e),c&&c.d(),f=!1,u()}}}function Wi(n){let e,t,l,s,r;function i(f){n[14](f)}let a={citation:n[5],showPercentage:n[2],showRelevance:n[3]};n[4]!==void 0&&(a.show=n[4]),e=new Li({props:a}),je.push(()=>Qe(e,"show",i));let o=n[1].length>0&&jl(n);return{c(){x(e.$$.fragment),l=j(),o&&o.c(),s=de()},l(f){ee(e.$$.fragment,f),l=z(f),o&&o.l(f),s=de()},m(f,u){te(e,f,u),V(f,l,u),o&&o.m(f,u),V(f,s,u),r=!0},p(f,[u]){const c={};u&32&&(c.citation=f[5]),u&4&&(c.showPercentage=f[2]),u&8&&(c.showRelevance=f[3]),!t&&u&16&&(t=!0,c.show=f[4],Ze(()=>t=!1)),e.$set(c),f[1].length>0?o?(o.p(f,u),u&2&&v(o,1)):(o=jl(f),o.c(),v(o,1),o.m(s.parentNode,s)):o&&(se(),D(o,1,1,()=>{o=null}),ne())},i(f){r||(v(e.$$.fragment,f),v(o),r=!0)},o(f){D(e.$$.fragment,f),D(o),r=!1},d(f){f&&(m(l),m(s)),le(e,f),o&&o.d(f)}}}function Fi(n){const e=n.flatMap(s=>s.distances??[]),t=e.filter(s=>s!==void 0&&s>=-1&&s<=1).length,l=e.filter(s=>s!==void 0&&(s<-1||s>1)).length;return!(e.length===0||t===e.length-1&&l===1||l===e.length-1&&t===1)}function Ji(n){return n.flatMap(t=>t.distances??[]).every(t=>t!==void 0&&t>=-1&&t<=1)}const Gi=n=>{n.stopPropagation()};function Ki(n,e,t){let l;const s=Je("i18n");Ee(n,s,b=>t(7,l=b));let{id:r=""}=e,{sources:i=[]}=e,a=[],o=!1,f=!0,u=!1,c=null,g=!1;const d=b=>{try{return decodeURIComponent(b)}catch{return b}},_=b=>b.distances!==void 0,y=b=>b.distances!==void 0,w=b=>b.distances!==void 0;function E(b){u=b,t(4,u)}const C=b=>{t(4,u=!0),t(5,c=b)},R=b=>{t(4,u=!0),t(5,c=b)},P=b=>{t(4,u=!0),t(5,c=b)};function O(b){g=b,t(6,g)}return n.$$set=b=>{"id"in b&&t(0,r=b.id),"sources"in b&&t(10,i=b.sources)},n.$$.update=()=>{n.$$.dirty&1026&&(console.log("sources",i),t(1,a=i.reduce((b,N)=>(Object.keys(N).length===0||N.document.forEach((B,S)=>{var ie,re,ue;const T=(ie=N.metadata)==null?void 0:ie[S],L=(re=N.distances)==null?void 0:re[S],H=(T==null?void 0:T.source)??((ue=N==null?void 0:N.source)==null?void 0:ue.id)??"N/A";let Y=N==null?void 0:N.source;T!=null&&T.name&&(Y={...Y,name:T.name}),(H.startsWith("http://")||H.startsWith("https://"))&&(Y={...Y,name:H,url:H});const oe=b.find(me=>me.id===H);oe?(oe.document.push(B),oe.metadata.push(T),L!==void 0&&oe.distances.push(L)):b.push({id:H,source:Y,document:[B],metadata:T?[T]:[],distances:L!==void 0?[L]:void 0})}),b),[])),console.log("citations",a),t(3,f=Fi(a)),t(2,o=Ji(a)))},[r,a,o,f,u,c,g,l,s,d,i,_,y,w,E,C,R,P,O]}class Zi extends Pe{constructor(e){super(),Le(this,e,Ki,Wi,Be,{id:0,sources:10})}}function Gl(n,e,t){const l=n.slice();return l[6]=e[t],l}function Kl(n){let e,t,l,s;const r=[Xi,Yi,Qi],i=[];function a(o,f){var u,c;return(u=o[1].result)!=null&&u.error?0:(c=o[1].result)!=null&&c.output?1:2}return t=a(n),l=i[t]=r[t](n),{c(){e=I("div"),l.c()},l(o){e=M(o,"DIV",{});var f=k(e);l.l(f),f.forEach(m)},m(o,f){V(o,e,f),i[t].m(e,null),s=!0},p(o,f){let u=t;t=a(o),t!==u&&(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),l=i[t],l||(l=i[t]=r[t](o),l.c()),v(l,1),l.m(e,null))},i(o){s||(v(l),s=!0)},o(o){D(l),s=!1},d(o){o&&m(e),i[t].d()}}}function Qi(n){let e,t;return e=new Qt({props:{type:"warning",content:"incomplete"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Yi(n){let e,t;return e=new Qt({props:{type:"success",content:"success"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Xi(n){let e,t;return e=new Qt({props:{type:"error",content:"error"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Zl(n){let e,t,l;return t=new Zt({props:{className:"size-4"}}),{c(){e=I("div"),x(t.$$.fragment)},l(s){e=M(s,"DIV",{});var r=k(e);ee(t.$$.fragment,r),r.forEach(m)},m(s,r){V(s,e,r),te(t,e,null),l=!0},i(s){l||(v(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),le(t)}}}function $i(n){let e=n[2].t("Code execution")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&4&&e!==(e=l[2].t("Code execution")+"")&&K(t,e)},d(l){l&&m(t)}}}function xi(n){var i;let e=n[2].t("Code execution")+"",t,l,s=((i=n[1])==null?void 0:i.name)+"",r;return{c(){t=W(e),l=W(": "),r=W(s)},l(a){t=F(a,e),l=F(a,": "),r=F(a,s)},m(a,o){V(a,t,o),V(a,l,o),V(a,r,o)},p(a,o){var f;o&4&&e!==(e=a[2].t("Code execution")+"")&&K(t,e),o&2&&s!==(s=((f=a[1])==null?void 0:f.name)+"")&&K(r,s)},d(a){a&&(m(t),m(l),m(r))}}}function Ql(n){var r,i,a,o;let e,t,l=((i=(r=n[1])==null?void 0:r.result)==null?void 0:i.error)&&Yl(n),s=((o=(a=n[1])==null?void 0:a.result)==null?void 0:o.output)&&Xl(n);return{c(){e=I("div"),l&&l.c(),t=j(),s&&s.c(),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=k(e);l&&l.l(u),t=z(u),s&&s.l(u),u.forEach(m),this.h()},h(){h(e,"class","dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3")},m(f,u){V(f,e,u),l&&l.m(e,null),p(e,t),s&&s.m(e,null)},p(f,u){var c,g,d,_;(g=(c=f[1])==null?void 0:c.result)!=null&&g.error?l?l.p(f,u):(l=Yl(f),l.c(),l.m(e,t)):l&&(l.d(1),l=null),(_=(d=f[1])==null?void 0:d.result)!=null&&_.output?s?s.p(f,u):(s=Xl(f),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(f){f&&m(e),l&&l.d(),s&&s.d()}}}function Yl(n){var f,u;let e,t,l=n[2].t("ERROR")+"",s,r,i,a=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.error)+"",o;return{c(){e=I("div"),t=I("div"),s=W(l),r=j(),i=I("div"),o=W(a),this.h()},l(c){e=M(c,"DIV",{});var g=k(e);t=M(g,"DIV",{class:!0});var d=k(t);s=F(d,l),d.forEach(m),r=z(g),i=M(g,"DIV",{class:!0});var _=k(i);o=F(_,a),_.forEach(m),g.forEach(m),this.h()},h(){h(t,"class","text-gray-500 text-xs mb-1"),h(i,"class","text-sm")},m(c,g){V(c,e,g),p(e,t),p(t,s),p(e,r),p(e,i),p(i,o)},p(c,g){var d,_;g&4&&l!==(l=c[2].t("ERROR")+"")&&K(s,l),g&2&&a!==(a=((_=(d=c[1])==null?void 0:d.result)==null?void 0:_.error)+"")&&K(o,a)},d(c){c&&m(e)}}}function Xl(n){var f,u;let e,t,l=n[2].t("OUTPUT")+"",s,r,i,a=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.output)+"",o;return{c(){e=I("div"),t=I("div"),s=W(l),r=j(),i=I("div"),o=W(a),this.h()},l(c){e=M(c,"DIV",{});var g=k(e);t=M(g,"DIV",{class:!0});var d=k(t);s=F(d,l),d.forEach(m),r=z(g),i=M(g,"DIV",{class:!0});var _=k(i);o=F(_,a),_.forEach(m),g.forEach(m),this.h()},h(){h(t,"class","text-gray-500 text-xs mb-1"),h(i,"class","text-sm")},m(c,g){V(c,e,g),p(e,t),p(t,s),p(e,r),p(e,i),p(i,o)},p(c,g){var d,_;g&4&&l!==(l=c[2].t("OUTPUT")+"")&&K(s,l),g&2&&a!==(a=((_=(d=c[1])==null?void 0:d.result)==null?void 0:_.output)+"")&&K(o,a)},d(c){c&&m(e)}}}function $l(n){var c,g;let e,t,l,s,r=n[2].t("Files")+"",i,a,o,f=De((g=(c=n[1])==null?void 0:c.result)==null?void 0:g.files),u=[];for(let d=0;d<f.length;d+=1)u[d]=xl(Gl(n,f,d));return{c(){e=I("div"),t=I("hr"),l=j(),s=I("div"),i=W(r),a=j(),o=I("ul");for(let d=0;d<u.length;d+=1)u[d].c();this.h()},l(d){e=M(d,"DIV",{class:!0});var _=k(e);t=M(_,"HR",{class:!0}),l=z(_),s=M(_,"DIV",{class:!0});var y=k(s);i=F(y,r),y.forEach(m),a=z(_),o=M(_,"UL",{class:!0});var w=k(o);for(let E=0;E<u.length;E+=1)u[E].l(w);w.forEach(m),_.forEach(m),this.h()},h(){h(t,"class","border-gray-100 dark:border-gray-850 my-2"),h(s,"class","text-sm font-medium dark:text-gray-300"),h(o,"class","mt-1 list-disc pl-4 text-xs"),h(e,"class","flex flex-col w-full")},m(d,_){V(d,e,_),p(e,t),p(e,l),p(e,s),p(s,i),p(e,a),p(e,o);for(let y=0;y<u.length;y+=1)u[y]&&u[y].m(o,null)},p(d,_){var y,w;if(_&4&&r!==(r=d[2].t("Files")+"")&&K(i,r),_&2){f=De((w=(y=d[1])==null?void 0:y.result)==null?void 0:w.files);let E;for(E=0;E<f.length;E+=1){const C=Gl(d,f,E);u[E]?u[E].p(C,_):(u[E]=xl(C),u[E].c(),u[E].m(o,null))}for(;E<u.length;E+=1)u[E].d(1);u.length=f.length}},d(d){d&&m(e),Fe(u,d)}}}function xl(n){let e,t,l=n[6].name+"",s,r,i;return{c(){e=I("li"),t=I("a"),s=W(l),i=j(),this.h()},l(a){e=M(a,"LI",{});var o=k(e);t=M(o,"A",{href:!0,target:!0});var f=k(t);s=F(f,l),f.forEach(m),i=z(o),o.forEach(m),this.h()},h(){h(t,"href",r=n[6].url),h(t,"target","_blank")},m(a,o){V(a,e,o),p(e,t),p(t,s),p(e,i)},p(a,o){o&2&&l!==(l=a[6].name+"")&&K(s,l),o&2&&r!==(r=a[6].url)&&h(t,"href",r)},d(a){a&&m(e)}}}function eo(n){var H,Y,oe,ie,re,ue,me,ke,q,Z,ge,pe,_e,J,he,ae,be,A,G;let e,t,l,s,r,i,a,o,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',c,g,d,_,y,w,E,C,R,P,O=((H=n[1])==null?void 0:H.result)&&Kl(n),b=!((Y=n[1])!=null&&Y.result)&&Zl();function N($,Q){var fe;return(fe=$[1])!=null&&fe.name?xi:$i}let B=N(n),S=B(n);y=new Rr({props:{id:"code-exec-"+((oe=n[1])==null?void 0:oe.id)+"-code",lang:((ie=n[1])==null?void 0:ie.language)??"",code:((re=n[1])==null?void 0:re.code)??"",className:"",editorClassName:(ue=n[1])!=null&&ue.result&&((ke=(me=n[1])==null?void 0:me.result)!=null&&ke.error||(Z=(q=n[1])==null?void 0:q.result)!=null&&Z.output)?"rounded-b-none":"",stickyButtonsClassName:"top-0",run:!1}});let T=((ge=n[1])==null?void 0:ge.result)&&(((_e=(pe=n[1])==null?void 0:pe.result)==null?void 0:_e.error)||((he=(J=n[1])==null?void 0:J.result)==null?void 0:he.output))&&Ql(n),L=((be=(ae=n[1])==null?void 0:ae.result)==null?void 0:be.files)&&((G=(A=n[1])==null?void 0:A.result)==null?void 0:G.files.length)>0&&$l(n);return{c(){e=I("div"),t=I("div"),l=I("div"),O&&O.c(),s=j(),r=I("div"),b&&b.c(),i=j(),a=I("div"),S.c(),o=j(),f=I("button"),f.innerHTML=u,c=j(),g=I("div"),d=I("div"),_=I("div"),x(y.$$.fragment),w=j(),T&&T.c(),E=j(),L&&L.c(),this.h()},l($){e=M($,"DIV",{});var Q=k(e);t=M(Q,"DIV",{class:!0});var fe=k(t);l=M(fe,"DIV",{class:!0});var ve=k(l);O&&O.l(ve),s=z(ve),r=M(ve,"DIV",{class:!0});var Ce=k(r);b&&b.l(Ce),i=z(Ce),a=M(Ce,"DIV",{});var X=k(a);S.l(X),X.forEach(m),Ce.forEach(m),ve.forEach(m),o=z(fe),f=M(fe,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(f)!=="svelte-vnrwun"&&(f.innerHTML=u),fe.forEach(m),c=z(Q),g=M(Q,"DIV",{class:!0});var Re=k(g);d=M(Re,"DIV",{class:!0});var He=k(d);_=M(He,"DIV",{class:!0});var ze=k(_);ee(y.$$.fragment,ze),ze.forEach(m),w=z(He),T&&T.l(He),E=z(He),L&&L.l(He),He.forEach(m),Re.forEach(m),Q.forEach(m),this.h()},h(){h(r,"class","flex gap-2 items-center"),h(l,"class","text-lg font-medium self-center flex flex-col gap-0.5 capitalize"),h(f,"class","self-center"),h(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),h(_,"class","flex flex-col w-full"),h(d,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),h(g,"class","flex flex-col md:flex-row w-full px-4 pb-5")},m($,Q){V($,e,Q),p(e,t),p(t,l),O&&O.m(l,null),p(l,s),p(l,r),b&&b.m(r,null),p(r,i),p(r,a),S.m(a,null),p(t,o),p(t,f),p(e,c),p(e,g),p(g,d),p(d,_),te(y,_,null),p(d,w),T&&T.m(d,null),p(d,E),L&&L.m(d,null),C=!0,R||(P=ce(f,"click",n[4]),R=!0)},p($,Q){var ve,Ce,X,Re,He,ze,We,Xe,st,at,lt,ft,ut,nt,Mt,Et,Nt,Dt,Vt;(ve=$[1])!=null&&ve.result?O?(O.p($,Q),Q&2&&v(O,1)):(O=Kl($),O.c(),v(O,1),O.m(l,s)):O&&(se(),D(O,1,1,()=>{O=null}),ne()),(Ce=$[1])!=null&&Ce.result?b&&(se(),D(b,1,1,()=>{b=null}),ne()):b?Q&2&&v(b,1):(b=Zl(),b.c(),v(b,1),b.m(r,i)),B===(B=N($))&&S?S.p($,Q):(S.d(1),S=B($),S&&(S.c(),S.m(a,null)));const fe={};Q&2&&(fe.id="code-exec-"+((X=$[1])==null?void 0:X.id)+"-code"),Q&2&&(fe.lang=((Re=$[1])==null?void 0:Re.language)??""),Q&2&&(fe.code=((He=$[1])==null?void 0:He.code)??""),Q&2&&(fe.editorClassName=(ze=$[1])!=null&&ze.result&&((Xe=(We=$[1])==null?void 0:We.result)!=null&&Xe.error||(at=(st=$[1])==null?void 0:st.result)!=null&&at.output)?"rounded-b-none":""),y.$set(fe),(lt=$[1])!=null&&lt.result&&((ut=(ft=$[1])==null?void 0:ft.result)!=null&&ut.error||(Mt=(nt=$[1])==null?void 0:nt.result)!=null&&Mt.output)?T?T.p($,Q):(T=Ql($),T.c(),T.m(d,E)):T&&(T.d(1),T=null),(Nt=(Et=$[1])==null?void 0:Et.result)!=null&&Nt.files&&((Vt=(Dt=$[1])==null?void 0:Dt.result)==null?void 0:Vt.files.length)>0?L?L.p($,Q):(L=$l($),L.c(),L.m(d,null)):L&&(L.d(1),L=null)},i($){C||(v(O),v(b),v(y.$$.fragment,$),C=!0)},o($){D(O),D(b),D(y.$$.fragment,$),C=!1},d($){$&&m(e),O&&O.d(),b&&b.d(),S.d(),le(y),T&&T.d(),L&&L.d(),R=!1,P()}}}function to(n){let e,t,l;function s(i){n[5](i)}let r={size:"lg",$$slots:{default:[eo]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new Rn({props:r}),je.push(()=>Qe(e,"show",s)),{c(){x(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,a){te(e,i,a),l=!0},p(i,[a]){const o={};a&519&&(o.$$scope={dirty:a,ctx:i}),!t&&a&1&&(t=!0,o.show=i[0],Ze(()=>t=!1)),e.$set(o)},i(i){l||(v(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){le(e,i)}}}function lo(n,e,t){let l;const s=Je("i18n");Ee(n,s,f=>t(2,l=f));let{show:r=!1}=e,{codeExecution:i=null}=e;const a=()=>{t(0,r=!1),t(1,i=null)};function o(f){r=f,t(0,r)}return n.$$set=f=>{"show"in f&&t(0,r=f.show),"codeExecution"in f&&t(1,i=f.codeExecution)},[r,i,l,s,a,o]}class so extends Pe{constructor(e){super(),Le(this,e,lo,to,Be,{show:0,codeExecution:1})}}function es(n,e,t){const l=n.slice();return l[6]=e[t],l}function ts(n){let e,t=[],l=new Map,s,r=De(n[0]);const i=a=>a[6].id;for(let a=0;a<r.length;a+=1){let o=es(n,r,a),f=i(o);l.set(f,t[a]=ls(f,o))}return{c(){e=I("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=M(a,"DIV",{class:!0});var o=k(e);for(let f=0;f<t.length;f+=1)t[f].l(o);o.forEach(m),this.h()},h(){h(e,"class","mt-1 mb-2 w-full flex gap-1 items-center flex-wrap")},m(a,o){V(a,e,o);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);s=!0},p(a,o){o&7&&(r=De(a[0]),se(),t=Jt(t,o,i,1,a,r,l,e,In,ls,null,es),ne())},i(a){if(!s){for(let o=0;o<r.length;o+=1)v(t[o]);s=!0}},o(a){for(let o=0;o<t.length;o+=1)D(t[o]);s=!1},d(a){a&&m(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function no(n){let e,t;return e=new Zt({props:{className:"size-4"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p:ye,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ro(n){let e,t,l,s;const r=[ao,oo,io],i=[];function a(o,f){var u,c;return(u=o[6].result)!=null&&u.error?0:(c=o[6].result)!=null&&c.output?1:2}return e=a(n),t=i[e]=r[e](n),{c(){t.c(),l=de()},l(o){t.l(o),l=de()},m(o,f){i[e].m(o,f),V(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e!==u&&(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t||(t=i[e]=r[e](o),t.c()),v(t,1),t.m(l.parentNode,l))},i(o){s||(v(t),s=!0)},o(o){D(t),s=!1},d(o){o&&m(l),i[e].d(o)}}}function io(n){let e,t;return e=new Ur({}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function oo(n){let e,t;return e=new jr({props:{strokeWidth:"3",className:"size-3"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ao(n){let e,t;return e=new zr({}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ls(n,e){let t,l,s,r,i,a,o,f=e[6].name+"",u,c,g,d,_,y;const w=[ro,no],E=[];function C(P,O){var b;return(b=P[6])!=null&&b.result?0:1}r=C(e),i=E[r]=w[r](e);function R(){return e[4](e[6])}return{key:n,first:null,c(){t=I("div"),l=I("button"),s=I("div"),i.c(),a=j(),o=I("div"),u=W(f),g=j(),this.h()},l(P){t=M(P,"DIV",{class:!0});var O=k(t);l=M(O,"BUTTON",{class:!0});var b=k(l);s=M(b,"DIV",{class:!0});var N=k(s);i.l(N),N.forEach(m),a=z(b),o=M(b,"DIV",{class:!0});var B=k(o);u=F(B,f),B.forEach(m),b.forEach(m),g=z(O),O.forEach(m),this.h()},h(){var P;h(s,"class","bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center"),h(o,"class",c="flex-1 mx-2 line-clamp-1 code-execution-name "+((P=e[6])!=null&&P.result?"":"pulse")+" svelte-1gvtig2"),h(l,"class","flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96"),h(t,"class","flex gap-1 text-xs font-semibold"),this.first=t},m(P,O){V(P,t,O),p(t,l),p(l,s),E[r].m(s,null),p(l,a),p(l,o),p(o,u),p(t,g),d=!0,_||(y=ce(l,"click",R),_=!0)},p(P,O){var N;e=P;let b=r;r=C(e),r===b?E[r].p(e,O):(se(),D(E[b],1,1,()=>{E[b]=null}),ne(),i=E[r],i?i.p(e,O):(i=E[r]=w[r](e),i.c()),v(i,1),i.m(s,null)),(!d||O&1)&&f!==(f=e[6].name+"")&&K(u,f),(!d||O&1&&c!==(c="flex-1 mx-2 line-clamp-1 code-execution-name "+((N=e[6])!=null&&N.result?"":"pulse")+" svelte-1gvtig2"))&&h(o,"class",c)},i(P){d||(v(i),d=!0)},o(P){D(i),d=!1},d(P){P&&m(t),E[r].d(),_=!1,y()}}}function fo(n){let e,t,l,s,r;function i(f){n[3](f)}let a={codeExecution:n[1]};n[2]!==void 0&&(a.show=n[2]),e=new so({props:a}),je.push(()=>Qe(e,"show",i));let o=n[0].length>0&&ts(n);return{c(){x(e.$$.fragment),l=j(),o&&o.c(),s=de()},l(f){ee(e.$$.fragment,f),l=z(f),o&&o.l(f),s=de()},m(f,u){te(e,f,u),V(f,l,u),o&&o.m(f,u),V(f,s,u),r=!0},p(f,[u]){const c={};u&2&&(c.codeExecution=f[1]),!t&&u&4&&(t=!0,c.show=f[2],Ze(()=>t=!1)),e.$set(c),f[0].length>0?o?(o.p(f,u),u&1&&v(o,1)):(o=ts(f),o.c(),v(o,1),o.m(s.parentNode,s)):o&&(se(),D(o,1,1,()=>{o=null}),ne())},i(f){r||(v(e.$$.fragment,f),v(o),r=!0)},o(f){D(e.$$.fragment,f),D(o),r=!1},d(f){f&&(m(l),m(s)),le(e,f),o&&o.d(f)}}}function uo(n,e,t){let{codeExecutions:l=[]}=e,s=null,r=!1;const i=()=>{s&&t(1,s=l.find(f=>f.id===s.id))};function a(f){r=f,t(2,r)}const o=f=>{t(1,s=f),t(2,r=!0)};return n.$$set=f=>{"codeExecutions"in f&&t(0,l=f.codeExecutions)},n.$$.update=()=>{n.$$.dirty&1&&l&&i()},[l,s,r,a,o]}class co extends Pe{constructor(e){super(),Le(this,e,uo,fo,Be,{codeExecutions:0})}}function ho(n){let e,t;return{c(){e=Ie("svg"),t=Ie("path"),this.h()},l(l){e=Me(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=Me(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",n[1]),h(e,"stroke","currentColor"),h(e,"class",n[0])},m(l,s){V(l,e,s),p(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ye,o:ye,d(l){l&&m(e)}}}function mo(n,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class go extends Pe{constructor(e){super(),Le(this,e,mo,ho,Be,{className:0,strokeWidth:1})}}function _o(n){let e,t,l,s,r,i,a,o,f,u,c,g;s=new It({props:{id:`${n[0]}-float-prompt`,content:n[4]}});const d=[vo,bo],_=[];function y(E,C){return C&32&&(o=null),o==null&&(o=E[5].trim()===""),o?0:1}f=y(n,-1),u=_[f]=d[f](n);let w=n[6]&&ss(n);return{c(){e=I("div"),t=I("div"),l=I("div"),x(s.$$.fragment),r=j(),i=I("div"),a=I("div"),u.c(),c=j(),w&&w.c(),this.h()},l(E){e=M(E,"DIV",{class:!0});var C=k(e);t=M(C,"DIV",{class:!0});var R=k(t);l=M(R,"DIV",{class:!0});var P=k(l);ee(s.$$.fragment,P),P.forEach(m),R.forEach(m),r=z(C),i=M(C,"DIV",{class:!0});var O=k(i);a=M(O,"DIV",{class:!0,id:!0});var b=k(a);u.l(b),c=z(b),w&&w.l(b),b.forEach(m),O.forEach(m),C.forEach(m),this.h()},h(){h(l,"class","font-medium"),h(t,"class","bg-gray-50/50 dark:bg-gray-800 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),h(a,"class","max-h-80 overflow-y-auto w-full markdown-prose-xs"),h(a,"id","response-container"),h(i,"class","bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),h(e,"class","bg-white dark:bg-gray-850 dark:text-gray-100 rounded-xl shadow-xl w-80 max-w-full")},m(E,C){V(E,e,C),p(e,t),p(t,l),te(s,l,null),p(e,r),p(e,i),p(i,a),_[f].m(a,null),p(a,c),w&&w.m(a,null),g=!0},p(E,C){const R={};C&1&&(R.id=`${E[0]}-float-prompt`),C&16&&(R.content=E[4]),s.$set(R);let P=f;f=y(E,C),f===P?_[f].p(E,C):(se(),D(_[P],1,1,()=>{_[P]=null}),ne(),u=_[f],u?u.p(E,C):(u=_[f]=d[f](E),u.c()),v(u,1),u.m(a,c)),E[6]?w?w.p(E,C):(w=ss(E),w.c(),w.m(a,null)):w&&(w.d(1),w=null)},i(E){g||(v(s.$$.fragment,E),v(u),g=!0)},o(E){D(s.$$.fragment,E),D(u),g=!1},d(E){E&&m(e),le(s),_[f].d(),w&&w.d()}}}function po(n){let e,t,l,s;const r=[wo,ko],i=[];function a(o,f){return o[1]?1:0}return e=a(n),t=i[e]=r[e](n),{c(){t.c(),l=de()},l(o){t.l(o),l=de()},m(o,f){i[e].m(o,f),V(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e===u?i[e].p(o,f):(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t?t.p(o,f):(t=i[e]=r[e](o),t.c()),v(t,1),t.m(l.parentNode,l))},i(o){s||(v(t),s=!0)},o(o){D(t),s=!1},d(o){o&&m(l),i[e].d(o)}}}function bo(n){let e,t;return e=new It({props:{id:`${n[0]}-float-response`,content:n[5]}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s&1&&(r.id=`${l[0]}-float-response`),s&32&&(r.content=l[5]),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function vo(n){let e,t;return e=new Yt({props:{size:"sm"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p:ye,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ss(n){let e,t,l=n[7].t("Add")+"",s,r,i;return{c(){e=I("div"),t=I("button"),s=W(l),this.h()},l(a){e=M(a,"DIV",{class:!0});var o=k(e);t=M(o,"BUTTON",{class:!0});var f=k(t);s=F(f,l),f.forEach(m),o.forEach(m),this.h()},h(){h(t,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),h(e,"class","flex justify-end pt-3 text-sm font-medium")},m(a,o){V(a,e,o),p(e,t),p(t,s),r||(i=ce(t,"click",n[11]),r=!0)},p(a,o){o&128&&l!==(l=a[7].t("Add")+"")&&K(s,l)},d(a){a&&m(e),r=!1,i()}}}function ko(n){let e,t,l,s,r,i,a,o,f,u,c;return{c(){e=I("div"),t=I("input"),s=j(),r=I("div"),i=I("button"),a=Ie("svg"),o=Ie("path"),this.h()},l(g){e=M(g,"DIV",{class:!0});var d=k(e);t=M(d,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),s=z(d),r=M(d,"DIV",{class:!0});var _=k(r);i=M(_,"BUTTON",{class:!0});var y=k(i);a=Me(y,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var w=k(a);o=Me(w,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(o).forEach(m),w.forEach(m),y.forEach(m),_.forEach(m),d.forEach(m),this.h()},h(){h(t,"type","text"),h(t,"id","floating-message-input"),h(t,"class","ml-5 bg-transparent outline-hidden w-full flex-1 text-sm"),h(t,"placeholder",l=n[7].t("Ask a question")),h(o,"fill-rule","evenodd"),h(o,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),h(o,"clip-rule","evenodd"),h(a,"xmlns","http://www.w3.org/2000/svg"),h(a,"viewBox","0 0 16 16"),h(a,"fill","currentColor"),h(a,"class","size-4"),h(i,"class",f=(n[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),h(r,"class","ml-1 mr-2"),h(e,"class","py-1 flex dark:text-gray-100 bg-gray-50 dark:bg-gray-800 border border-gray-100 dark:border-gray-850 w-72 rounded-full shadow-xl")},m(g,d){V(g,e,d),p(e,t),it(t,n[3]),p(e,s),p(e,r),p(r,i),p(i,a),p(a,o),u||(c=[ce(t,"input",n[18]),ce(t,"keydown",n[19]),ce(i,"click",n[20])],u=!0)},p(g,d){d&128&&l!==(l=g[7].t("Ask a question"))&&h(t,"placeholder",l),d&8&&t.value!==g[3]&&it(t,g[3]),d&8&&f!==(f=(g[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&h(i,"class",f)},i:ye,o:ye,d(g){g&&m(e),u=!1,Ye(c)}}}function wo(n){let e,t,l,s,r,i=n[7].t("Ask")+"",a,o,f,u,c,g,d=n[7].t("Explain")+"",_,y,w,E;return l=new go({props:{className:"size-3 shrink-0"}}),u=new Pr({props:{className:"size-3 shrink-0"}}),{c(){e=I("div"),t=I("button"),x(l.$$.fragment),s=j(),r=I("div"),a=W(i),o=j(),f=I("button"),x(u.$$.fragment),c=j(),g=I("div"),_=W(d),this.h()},l(C){e=M(C,"DIV",{class:!0});var R=k(e);t=M(R,"BUTTON",{class:!0});var P=k(t);ee(l.$$.fragment,P),s=z(P),r=M(P,"DIV",{class:!0});var O=k(r);a=F(O,i),O.forEach(m),P.forEach(m),o=z(R),f=M(R,"BUTTON",{class:!0});var b=k(f);ee(u.$$.fragment,b),c=z(b),g=M(b,"DIV",{class:!0});var N=k(g);_=F(N,d),N.forEach(m),b.forEach(m),R.forEach(m),this.h()},h(){h(r,"class","shrink-0"),h(t,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),h(g,"class","shrink-0"),h(f,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),h(e,"class","flex flex-row gap-0.5 shrink-0 p-1 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-lg shadow-xl")},m(C,R){V(C,e,R),p(e,t),te(l,t,null),p(t,s),p(t,r),p(r,a),p(e,o),p(e,f),te(u,f,null),p(f,c),p(f,g),p(g,_),y=!0,w||(E=[ce(t,"click",n[16]),ce(f,"click",n[17])],w=!0)},p(C,R){(!y||R&128)&&i!==(i=C[7].t("Ask")+"")&&K(a,i),(!y||R&128)&&d!==(d=C[7].t("Explain")+"")&&K(_,d)},i(C){y||(v(l.$$.fragment,C),v(u.$$.fragment,C),y=!0)},o(C){D(l.$$.fragment,C),D(u.$$.fragment,C),y=!1},d(C){C&&m(e),le(l),le(u),w=!1,Ye(E)}}}function yo(n){let e,t,l,s,r;const i=[po,_o],a=[];function o(f,u){return f[5]===null?0:1}return t=o(n),l=a[t]=i[t](n),{c(){e=I("div"),l.c(),this.h()},l(f){e=M(f,"DIV",{id:!0,class:!0,style:!0});var u=k(e);l.l(u),u.forEach(m),this.h()},h(){h(e,"id",s=`floating-buttons-${n[0]}`),h(e,"class","absolute rounded-lg mt-1 text-xs z-9999"),Rt(e,"display","none")},m(f,u){V(f,e,u),a[t].m(e,null),r=!0},p(f,[u]){let c=t;t=o(f),t===c?a[t].p(f,u):(se(),D(a[c],1,1,()=>{a[c]=null}),ne(),l=a[t],l?l.p(f,u):(l=a[t]=i[t](f),l.c()),v(l,1),l.m(e,null)),(!r||u&1&&s!==(s=`floating-buttons-${f[0]}`))&&h(e,"id",s)},i(f){r||(v(l),r=!0)},o(f){D(l),r=!1},d(f){f&&m(e),a[t].d()}}}function Io(n,e,t){let l;const s=Je("i18n");Ee(n,s,S=>t(7,l=S));let{id:r=""}=e,{model:i=null}=e,{messages:a=[]}=e,{onAdd:o=()=>{}}=e,f=!1,u="",c="",g="",d=null,_=!1;const y=async()=>{const S=document.getElementById("response-container");S.scrollHeight-S.clientHeight<=S.scrollTop+50&&(S.scrollTop=S.scrollHeight)},w=async()=>{if(!i){Ae.error("Model not selected");return}t(4,g=`${c}
\`\`\`
${u}
\`\`\``),t(3,c=""),t(5,d="");const[S,T]=await _l(localStorage.token,{model:i,messages:[...a,{role:"user",content:g}].map(L=>({role:L.role,content:L.content})),stream:!0});if(S&&S.ok){const L=S.body.getReader(),H=new TextDecoder;await(async()=>{var oe,ie;for(;;){const{done:re,value:ue}=await L.read();if(re)break;const ke=H.decode(ue,{stream:!0}).split(`
`).filter(q=>q.trim()!=="");for(const q of ke)if(q.startsWith("data: "))if(q.startsWith("data: [DONE]")){t(6,_=!0),await Ve(),y();continue}else try{const Z=JSON.parse(q.slice(6));Z.choices&&((ie=(oe=Z.choices[0])==null?void 0:oe.delta)!=null&&ie.content)&&(t(5,d+=Z.choices[0].delta.content),y())}catch(Z){console.error(Z)}}})()}else Ae.error("An error occurred while fetching the explanation")},E=async()=>{if(!i){Ae.error("Model not selected");return}const S=l.t("Explain this section to me in more detail");t(4,g=`${S}

\`\`\`
${u}
\`\`\``),t(5,d="");const[T,L]=await _l(localStorage.token,{model:i,messages:[...a,{role:"user",content:g}].map(H=>({role:H.role,content:H.content})),stream:!0});if(T&&T.ok){const H=T.body.getReader(),Y=new TextDecoder;await(async()=>{var ie,re;for(;;){const{done:ue,value:me}=await H.read();if(ue)break;const q=Y.decode(me,{stream:!0}).split(`
`).filter(Z=>Z.trim()!=="");for(const Z of q)if(Z.startsWith("data: "))if(Z.startsWith("data: [DONE]")){t(6,_=!0),await Ve(),y();continue}else try{const ge=JSON.parse(Z.slice(6));ge.choices&&((re=(ie=ge.choices[0])==null?void 0:ie.delta)!=null&&re.content)&&(t(5,d+=ge.choices[0].delta.content),y())}catch(ge){console.error(ge)}}})()}else Ae.error("An error occurred while fetching the explanation")},C=async()=>{o({modelId:i,parentId:r,messages:[{role:"user",content:g},{role:"assistant",content:d}]})},R=()=>{t(5,d=null),t(6,_=!1),t(1,f=!1),t(3,c="")},P=async()=>{t(2,u=window.getSelection().toString()),t(1,f=!0),await Ve(),setTimeout(()=>{const S=document.getElementById("floating-message-input");S&&S.focus()},0)},O=()=>{t(2,u=window.getSelection().toString()),E()};function b(){c=this.value,t(3,c)}const N=S=>{S.key==="Enter"&&w()},B=()=>{w()};return n.$$set=S=>{"id"in S&&t(0,r=S.id),"model"in S&&t(12,i=S.model),"messages"in S&&t(13,a=S.messages),"onAdd"in S&&t(14,o=S.onAdd)},[r,f,u,c,g,d,_,l,s,w,E,C,i,a,o,R,P,O,b,N,B]}class Mo extends Pe{constructor(e){super(),Le(this,e,Io,yo,Be,{id:0,model:12,messages:13,onAdd:14,closeHandler:15})}get closeHandler(){return this.$$.ctx[15]}}function ns(n){var s;let e,t,l={id:n[0],model:(s=n[3])==null?void 0:s.id,messages:Ft(n[2],n[0]),onAdd:n[21]};return e=new Mo({props:l}),n[22](e),{c(){x(e.$$.fragment)},l(r){ee(e.$$.fragment,r)},m(r,i){te(e,r,i),t=!0},p(r,i){var o;const a={};i&1&&(a.id=r[0]),i&8&&(a.model=(o=r[3])==null?void 0:o.id),i&5&&(a.messages=Ft(r[2],r[0])),i&512&&(a.onAdd=r[21]),e.$set(a)},i(r){t||(v(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){n[22](null),le(e,r)}}}function Eo(n){let e,t,l,s,r;t=new It({props:{id:n[0],content:n[1],model:n[3],save:n[5],sourceIds:(n[4]??[]).reduce(n[17],[]),onSourceClick:n[7],onTaskClick:n[8],onUpdate:n[18],onCode:n[19]}});let i=n[6]&&n[3]&&ns(n);return{c(){e=I("div"),x(t.$$.fragment),l=j(),i&&i.c(),s=de()},l(a){e=M(a,"DIV",{});var o=k(e);ee(t.$$.fragment,o),o.forEach(m),l=z(a),i&&i.l(a),s=de()},m(a,o){V(a,e,o),te(t,e,null),n[20](e),V(a,l,o),i&&i.m(a,o),V(a,s,o),r=!0},p(a,[o]){const f={};o&1&&(f.id=a[0]),o&2&&(f.content=a[1]),o&8&&(f.model=a[3]),o&32&&(f.save=a[5]),o&24&&(f.sourceIds=(a[4]??[]).reduce(a[17],[])),o&128&&(f.onSourceClick=a[7]),o&256&&(f.onTaskClick=a[8]),o&28672&&(f.onCode=a[19]),t.$set(f),a[6]&&a[3]?i?(i.p(a,o),o&72&&v(i,1)):(i=ns(a),i.c(),v(i,1),i.m(s.parentNode,s)):i&&(se(),D(i,1,1,()=>{i=null}),ne())},i(a){r||(v(t.$$.fragment,a),v(i),r=!0)},o(a){D(t.$$.fragment,a),D(i),r=!1},d(a){a&&(m(e),m(l),m(s)),le(t),n[20](null),i&&i.d(a)}}}function No(n,e,t){let l,s,r;Ee(n,Mn,H=>t(12,l=H)),Ee(n,kt,H=>t(13,s=H)),Ee(n,pr,H=>t(14,r=H)),Je("i18n");const i=gt();let{id:a}=e,{content:o}=e,{history:f}=e,{model:u=null}=e,{sources:c=null}=e,{save:g=!1}=e,{floatingButtons:d=!0}=e,{onSourceClick:_=()=>{}}=e,{onTaskClick:y=()=>{}}=e,{onAddMessages:w=()=>{}}=e,E,C;const R=H=>{const Y=document.getElementById(`floating-buttons-${a}`);if(!(E!=null&&E.contains(H.target))&&!(Y!=null&&Y.contains(H.target))){P();return}setTimeout(async()=>{if(await Ve(),!(E!=null&&E.contains(H.target)))return;let oe=window.getSelection();if(oe.toString().trim().length>0){const re=oe.getRangeAt(0).getBoundingClientRect(),ue=E.getBoundingClientRect(),me=re.bottom-ue.top,ke=re.left-ue.left;if(Y){Y.style.display="block";const q=ue.width-ke;let Z=l?window.innerWidth/2:window.innerWidth/3;if(q<Z){const ge=ue.right-re.right;Y.style.right=`${ge}px`,Y.style.left="auto"}else Y.style.left=`${ke}px`,Y.style.right="auto";Y.style.top=`${me+5}px`}}else P()},0)},P=()=>{const H=document.getElementById(`floating-buttons-${a}`);H&&(H.style.display="none"),C&&typeof(C==null?void 0:C.closeHandler)=="function"&&(C==null||C.closeHandler())},O=H=>{H.key==="Escape"&&P()};vt(()=>{d&&(E==null||E.addEventListener("mouseup",R),document.addEventListener("mouseup",R),document.addEventListener("keydown",O))}),dr(()=>{d&&(E==null||E.removeEventListener("mouseup",R),document.removeEventListener("mouseup",R),document.removeEventListener("keydown",O))});const b=(H,Y)=>{let oe=[];return Y.document.forEach((ie,re)=>{var ke,q,Z,ge,pe;if(((Z=(q=(ke=u==null?void 0:u.info)==null?void 0:ke.meta)==null?void 0:q.capabilities)==null?void 0:Z.citations)==!1)return oe.push("N/A"),oe;const ue=(ge=Y.metadata)==null?void 0:ge[re],me=(ue==null?void 0:ue.source)??"N/A";return ue!=null&&ue.name?(oe.push(ue.name),oe):(me.startsWith("http://")||me.startsWith("https://")?oe.push(me):oe.push(((pe=Y==null?void 0:Y.source)==null?void 0:pe.name)??me),oe)}),H=[...H,...oe],H.filter((ie,re)=>H.indexOf(ie)===re)},N=H=>{i("update",H)},B=H=>{const{lang:Y,code:oe}=H;((s==null?void 0:s.detectArtifacts)??!0)&&(["html","svg"].includes(Y)||Y==="xml"&&oe.includes("svg"))&&!l&&r&&(br.set(!0),vr.set(!0))};function S(H){je[H?"unshift":"push"](()=>{E=H,t(10,E)})}const T=({modelId:H,parentId:Y,messages:oe})=>{console.log(H,Y,oe),w({modelId:H,parentId:Y,messages:oe}),P()};function L(H){je[H?"unshift":"push"](()=>{C=H,t(11,C)})}return n.$$set=H=>{"id"in H&&t(0,a=H.id),"content"in H&&t(1,o=H.content),"history"in H&&t(2,f=H.history),"model"in H&&t(3,u=H.model),"sources"in H&&t(4,c=H.sources),"save"in H&&t(5,g=H.save),"floatingButtons"in H&&t(6,d=H.floatingButtons),"onSourceClick"in H&&t(7,_=H.onSourceClick),"onTaskClick"in H&&t(8,y=H.onTaskClick),"onAddMessages"in H&&t(9,w=H.onAddMessages)},[a,o,f,u,c,g,d,_,y,w,E,C,l,s,r,i,P,b,N,B,S,T,L]}class Do extends Pe{constructor(e){super(),Le(this,e,No,Eo,Be,{id:0,content:1,history:2,model:3,sources:4,save:5,floatingButtons:6,onSourceClick:7,onTaskClick:8,onAddMessages:9})}}function rs(n,e,t){const l=n.slice();return l[89]=e[t],l}function is(n,e,t){const l=n.slice();return l[92]=e[t],l}function Ut(n){var l,s,r;const e=n.slice(),t=(((l=e[13])==null?void 0:l.statusHistory)??[...(s=e[13])!=null&&s.status?[(r=e[13])==null?void 0:r.status]:[]]).at(-1);return e[95]=t,e}function Vo(n){var s;let e,t=(((s=n[17])==null?void 0:s.name)??n[13].model)+"",l;return{c(){e=I("span"),l=W(t),this.h()},l(r){e=M(r,"SPAN",{class:!0});var i=k(e);l=F(i,t),i.forEach(m),this.h()},h(){h(e,"class","line-clamp-1 text-black dark:text-white")},m(r,i){V(r,e,i),p(e,l)},p(r,i){var a;i[0]&139264&&t!==(t=(((a=r[17])==null?void 0:a.name)??r[13].model)+"")&&K(l,t)},d(r){r&&m(e)}}}function os(n){let e,t,l;return t=new Se({props:{content:ot(n[13].timestamp*1e3).format("LLLL"),$$slots:{default:[Co]},$$scope:{ctx:n}}}),{c(){e=I("div"),x(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);ee(t.$$.fragment,r),r.forEach(m),this.h()},h(){h(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){V(s,e,r),te(t,e,null),l=!0},p(s,r){const i={};r[0]&8192&&(i.content=ot(s[13].timestamp*1e3).format("LLLL")),r[0]&8192|r[3]&8&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(v(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),le(t)}}}function Co(n){let e,t=At(n[13].timestamp*1e3)+"",l;return{c(){e=I("span"),l=W(t),this.h()},l(s){e=M(s,"SPAN",{class:!0});var r=k(e);l=F(r,t),r.forEach(m),this.h()},h(){h(e,"class","line-clamp-1")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r[0]&8192&&t!==(t=At(s[13].timestamp*1e3)+"")&&K(l,t)},d(s){s&&m(e)}}}function To(n){var i;let e,t,l,s;e=new Se({props:{content:((i=n[17])==null?void 0:i.name)??n[13].model,placement:"top-start",$$slots:{default:[Vo]},$$scope:{ctx:n}}});let r=n[13].timestamp&&os(n);return{c(){x(e.$$.fragment),t=j(),r&&r.c(),l=de()},l(a){ee(e.$$.fragment,a),t=z(a),r&&r.l(a),l=de()},m(a,o){te(e,a,o),V(a,t,o),r&&r.m(a,o),V(a,l,o),s=!0},p(a,o){var u;const f={};o[0]&139264&&(f.content=((u=a[17])==null?void 0:u.name)??a[13].model),o[0]&139264|o[3]&8&&(f.$$scope={dirty:o,ctx:a}),e.$set(f),a[13].timestamp?r?(r.p(a,o),o[0]&8192&&v(r,1)):(r=os(a),r.c(),v(r,1),r.m(l.parentNode,l)):r&&(se(),D(r,1,1,()=>{r=null}),ne())},i(a){s||(v(e.$$.fragment,a),v(r),s=!0)},o(a){D(e.$$.fragment,a),D(r),s=!1},d(a){a&&(m(t),m(l)),le(e,a),r&&r.d(a)}}}function as(n){var s;let e,t,l=!((s=n[95])!=null&&s.hidden)&&fs(n);return{c(){l&&l.c(),e=de()},l(r){l&&l.l(r),e=de()},m(r,i){l&&l.m(r,i),V(r,e,i),t=!0},p(r,i){var a;(a=r[95])!=null&&a.hidden?l&&(se(),D(l,1,1,()=>{l=null}),ne()):l?(l.p(r,i),i[0]&8192&&v(l,1)):(l=fs(r),l.c(),v(l,1),l.m(e.parentNode,e))},i(r){t||(v(l),t=!0)},o(r){D(l),t=!1},d(r){r&&m(e),l&&l.d(r)}}}function fs(n){let e,t,l,s;const r=[Oo,So,Bo],i=[];function a(o,f){var u,c,g;return((u=o[95])==null?void 0:u.action)==="web_search"&&((c=o[95])!=null&&c.urls)?0:((g=o[95])==null?void 0:g.action)==="knowledge_search"?1:2}return t=a(n),l=i[t]=r[t](n),{c(){e=I("div"),l.c(),this.h()},l(o){e=M(o,"DIV",{class:!0});var f=k(e);l.l(f),f.forEach(m),this.h()},h(){h(e,"class","status-description flex items-center gap-2 py-0.5")},m(o,f){V(o,e,f),i[t].m(e,null),s=!0},p(o,f){let u=t;t=a(o),t===u?i[t].p(o,f):(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),l=i[t],l?l.p(o,f):(l=i[t]=r[t](o),l.c()),v(l,1),l.m(e,null))},i(o){s||(v(l),s=!0)},o(o){D(l),s=!1},d(o){o&&m(e),i[t].d()}}}function Bo(n){let e,t,l,s;function r(o,f){var u,c,g,d;return f[0]&8192&&(l=null),l==null&&(l=!!((u=o[95])!=null&&u.description.includes("{{searchQuery}}"))),l?Ho:((c=o[95])==null?void 0:c.description)==="No search query generated"?Ao:((g=o[95])==null?void 0:g.description)==="Generating search query"?Lo:((d=o[95])==null?void 0:d.description)==="Searching the web"?Po:Ro}let i=r(n,[-1,-1,-1,-1]),a=i(n);return{c(){e=I("div"),t=I("div"),a.c(),this.h()},l(o){e=M(o,"DIV",{class:!0});var f=k(e);t=M(f,"DIV",{class:!0});var u=k(t);a.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var o;h(t,"class",s=(((o=n[95])==null?void 0:o.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(o,f){V(o,e,f),p(e,t),a.m(t,null)},p(o,f){var u;i===(i=r(o,f))&&a?a.p(o,f):(a.d(1),a=i(o),a&&(a.c(),a.m(t,null))),f[0]&8192&&s!==(s=(((u=o[95])==null?void 0:u.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&h(t,"class",s)},i:ye,o:ye,d(o){o&&m(e),a.d()}}}function So(n){let e,t,l=n[28].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:n[95].query})+"",s,r;return{c(){e=I("div"),t=I("div"),s=W(l),this.h()},l(i){e=M(i,"DIV",{class:!0});var a=k(e);t=M(a,"DIV",{class:!0});var o=k(t);s=F(o,l),o.forEach(m),a.forEach(m),this.h()},h(){var i;h(t,"class",r=(((i=n[95])==null?void 0:i.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(i,a){V(i,e,a),p(e,t),p(t,s)},p(i,a){var o;a[0]&268443648&&l!==(l=i[28].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:i[95].query})+"")&&K(s,l),a[0]&8192&&r!==(r=(((o=i[95])==null?void 0:o.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&h(t,"class",r)},i:ye,o:ye,d(i){i&&m(e)}}}function Oo(n){let e,t;return e=new bi({props:{status:n[95],$$slots:{default:[Wo]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.status=l[95]),s[0]&268443648|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Ro(n){var l;let e=((l=n[95])==null?void 0:l.description)+"",t;return{c(){t=W(e)},l(s){t=F(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r[0]&8192&&e!==(e=((i=s[95])==null?void 0:i.description)+"")&&K(t,e)},d(s){s&&m(t)}}}function Po(n){let e=n[28].t("Searching the web...")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("Searching the web...")+"")&&K(t,e)},d(l){l&&m(t)}}}function Lo(n){let e=n[28].t("Generating search query")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("Generating search query")+"")&&K(t,e)},d(l){l&&m(t)}}}function Ao(n){let e=n[28].t("No search query generated")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("No search query generated")+"")&&K(t,e)},d(l){l&&m(t)}}}function Ho(n){var l,s;let e=n[28].t((l=n[95])==null?void 0:l.description,{searchQuery:(s=n[95])==null?void 0:s.query})+"",t;return{c(){t=W(e)},l(r){t=F(r,e)},m(r,i){V(r,t,i)},p(r,i){var a,o;i[0]&268443648&&e!==(e=r[28].t((a=r[95])==null?void 0:a.description,{searchQuery:(o=r[95])==null?void 0:o.query})+"")&&K(t,e)},d(r){r&&m(t)}}}function jo(n){var l;let e=((l=n[95])==null?void 0:l.description)+"",t;return{c(){t=W(e)},l(s){t=F(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r[0]&8192&&e!==(e=((i=s[95])==null?void 0:i.description)+"")&&K(t,e)},d(s){s&&m(t)}}}function zo(n){let e=n[28].t("Generating search query")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("Generating search query")+"")&&K(t,e)},d(l){l&&m(t)}}}function Uo(n){let e=n[28].t("No search query generated")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("No search query generated")+"")&&K(t,e)},d(l){l&&m(t)}}}function qo(n){var l,s;let e=n[28].t((l=n[95])==null?void 0:l.description,{count:(s=n[95])==null?void 0:s.urls.length})+"",t;return{c(){t=W(e)},l(r){t=F(r,e)},m(r,i){V(r,t,i)},p(r,i){var a,o;i[0]&268443648&&e!==(e=r[28].t((a=r[95])==null?void 0:a.description,{count:(o=r[95])==null?void 0:o.urls.length})+"")&&K(t,e)},d(r){r&&m(t)}}}function Wo(n){let e,t,l,s;function r(o,f){var u,c,g;return f[0]&8192&&(l=null),l==null&&(l=!!((u=o[95])!=null&&u.description.includes("{{count}}"))),l?qo:((c=o[95])==null?void 0:c.description)==="No search query generated"?Uo:((g=o[95])==null?void 0:g.description)==="Generating search query"?zo:jo}let i=r(n,[-1,-1,-1,-1]),a=i(n);return{c(){e=I("div"),t=I("div"),a.c(),this.h()},l(o){e=M(o,"DIV",{class:!0});var f=k(e);t=M(f,"DIV",{class:!0});var u=k(t);a.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var o;h(t,"class",s=(((o=n[95])==null?void 0:o.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(o,f){V(o,e,f),p(e,t),a.m(t,null)},p(o,f){var u;i===(i=r(o,f))&&a?a.p(o,f):(a.d(1),a=i(o),a&&(a.c(),a.m(t,null))),f[0]&8192&&s!==(s=(((u=o[95])==null?void 0:u.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap")&&h(t,"class",s)},d(o){o&&m(e),a.d()}}}function us(n){let e,t,l=De(n[13].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=cs(is(n,l,i));const r=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=I("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=M(i,"DIV",{class:!0});var a=k(e);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(m),this.h()},h(){h(e,"class","my-1 w-full flex overflow-x-auto gap-2 flex-wrap")},m(i,a){V(i,e,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);t=!0},p(i,a){if(a[0]&8192){l=De(i[13].files);let o;for(o=0;o<l.length;o+=1){const f=is(i,l,o);s[o]?(s[o].p(f,a),v(s[o],1)):(s[o]=cs(f),s[o].c(),v(s[o],1),s[o].m(e,null))}for(se(),o=l.length;o<s.length;o+=1)r(o);ne()}},i(i){if(!t){for(let a=0;a<l.length;a+=1)v(s[a]);t=!0}},o(i){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);t=!1},d(i){i&&m(e),Fe(s,i)}}}function Fo(n){var l;let e,t;return e=new Pn({props:{item:n[92],url:n[92].url,name:n[92].name,type:n[92].type,size:(l=n[92])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){x(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,r){te(e,s,r),t=!0},p(s,r){var a;const i={};r[0]&8192&&(i.item=s[92]),r[0]&8192&&(i.url=s[92].url),r[0]&8192&&(i.name=s[92].name),r[0]&8192&&(i.type=s[92].type),r[0]&8192&&(i.size=(a=s[92])==null?void 0:a.size),e.$set(i)},i(s){t||(v(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function Jo(n){let e,t;return e=new Cn({props:{src:n[92].url,alt:n[13].content}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.src=l[92].url),s[0]&8192&&(r.alt=l[13].content),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function cs(n){let e,t,l,s,r;const i=[Jo,Fo],a=[];function o(f,u){return f[92].type==="image"?0:1}return t=o(n),l=a[t]=i[t](n),{c(){e=I("div"),l.c(),s=j()},l(f){e=M(f,"DIV",{});var u=k(e);l.l(u),s=z(u),u.forEach(m)},m(f,u){V(f,e,u),a[t].m(e,null),p(e,s),r=!0},p(f,u){let c=t;t=o(f),t===c?a[t].p(f,u):(se(),D(a[c],1,1,()=>{a[c]=null}),ne(),l=a[t],l?l.p(f,u):(l=a[t]=i[t](f),l.c()),v(l,1),l.m(e,s))},i(f){r||(v(l),r=!0)},o(f){D(l),r=!1},d(f){f&&m(e),a[t].d()}}}function Go(n){var _,y,w,E,C,R,P;let e,t,l,s,r,i,a;const o=[Qo,Zo],f=[];function u(O,b){var N,B,S;return O[13].content===""&&!O[13].error&&(((N=O[13])==null?void 0:N.statusHistory)??[...(B=O[13])!=null&&B.status?[(S=O[13])==null?void 0:S.status]:[]]).length===0?0:O[13].content&&O[13].error!==!0?1:-1}~(t=u(n))&&(l=f[t]=o[t](n));let c=((_=n[13])==null?void 0:_.error)&&ds(n),g=(((y=n[13])==null?void 0:y.sources)||((w=n[13])==null?void 0:w.citations))&&(((P=(R=(C=(E=n[17])==null?void 0:E.info)==null?void 0:C.meta)==null?void 0:R.capabilities)==null?void 0:P.citations)??!0)&&hs(n),d=n[13].code_executions&&ms(n);return{c(){e=I("div"),l&&l.c(),s=j(),c&&c.c(),r=j(),g&&g.c(),i=j(),d&&d.c(),this.h()},l(O){e=M(O,"DIV",{class:!0,id:!0});var b=k(e);l&&l.l(b),s=z(b),c&&c.l(b),r=z(b),g&&g.l(b),i=z(b),d&&d.l(b),b.forEach(m),this.h()},h(){h(e,"class","w-full flex flex-col relative"),h(e,"id","response-content-container")},m(O,b){V(O,e,b),~t&&f[t].m(e,null),p(e,s),c&&c.m(e,null),p(e,r),g&&g.m(e,null),p(e,i),d&&d.m(e,null),a=!0},p(O,b){var B,S,T,L,H,Y,oe;let N=t;t=u(O),t===N?~t&&f[t].p(O,b):(l&&(se(),D(f[N],1,1,()=>{f[N]=null}),ne()),~t?(l=f[t],l?l.p(O,b):(l=f[t]=o[t](O),l.c()),v(l,1),l.m(e,s)):l=null),(B=O[13])!=null&&B.error?c?(c.p(O,b),b[0]&8192&&v(c,1)):(c=ds(O),c.c(),v(c,1),c.m(e,r)):c&&(se(),D(c,1,1,()=>{c=null}),ne()),((S=O[13])!=null&&S.sources||(T=O[13])!=null&&T.citations)&&(((oe=(Y=(H=(L=O[17])==null?void 0:L.info)==null?void 0:H.meta)==null?void 0:Y.capabilities)==null?void 0:oe.citations)??!0)?g?(g.p(O,b),b[0]&139264&&v(g,1)):(g=hs(O),g.c(),v(g,1),g.m(e,i)):g&&(se(),D(g,1,1,()=>{g=null}),ne()),O[13].code_executions?d?(d.p(O,b),b[0]&8192&&v(d,1)):(d=ms(O),d.c(),v(d,1),d.m(e,null)):d&&(se(),D(d,1,1,()=>{d=null}),ne())},i(O){a||(v(l),v(c),v(g),v(d),a=!0)},o(O){D(l),D(c),D(g),D(d),a=!1},d(O){O&&m(e),~t&&f[t].d(),c&&c.d(),g&&g.d(),d&&d.d()}}}function Ko(n){let e,t,l,s,r,i,a,o=n[28].t("Save As Copy")+"",f,u,c,g,d=n[28].t("Cancel")+"",_,y,w,E=n[28].t("Save")+"",C,R,P;return{c(){e=I("div"),t=I("textarea"),s=j(),r=I("div"),i=I("div"),a=I("button"),f=W(o),u=j(),c=I("div"),g=I("button"),_=W(d),y=j(),w=I("button"),C=W(E),this.h()},l(O){e=M(O,"DIV",{class:!0});var b=k(e);t=M(b,"TEXTAREA",{id:!0,class:!0}),k(t).forEach(m),s=z(b),r=M(b,"DIV",{class:!0});var N=k(r);i=M(N,"DIV",{});var B=k(i);a=M(B,"BUTTON",{id:!0,class:!0});var S=k(a);f=F(S,o),S.forEach(m),B.forEach(m),u=z(N),c=M(N,"DIV",{class:!0});var T=k(c);g=M(T,"BUTTON",{id:!0,class:!0});var L=k(g);_=F(L,d),L.forEach(m),y=z(T),w=M(T,"BUTTON",{id:!0,class:!0});var H=k(w);C=F(H,E),H.forEach(m),T.forEach(m),N.forEach(m),b.forEach(m),this.h()},h(){h(t,"id",l="message-edit-"+n[13].id),h(t,"class","bg-transparent outline-hidden w-full resize-none"),h(a,"id","save-new-message-button"),h(a,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),h(g,"id","close-edit-message-button"),h(g,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),h(w,"id","confirm-edit-message-button"),h(w,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),h(c,"class","flex space-x-1.5"),h(r,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),h(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2")},m(O,b){V(O,e,b),p(e,t),n[51](t),it(t,n[18]),p(e,s),p(e,r),p(r,i),p(i,a),p(a,f),p(r,u),p(r,c),p(c,g),p(g,_),p(c,y),p(c,w),p(w,C),R||(P=[ce(t,"input",n[52]),ce(t,"input",pa),ce(t,"keydown",n[53]),ce(a,"click",n[54]),ce(g,"click",n[55]),ce(w,"click",n[56])],R=!0)},p(O,b){b[0]&8192&&l!==(l="message-edit-"+O[13].id)&&h(t,"id",l),b[0]&262144&&it(t,O[18]),b[0]&268435456&&o!==(o=O[28].t("Save As Copy")+"")&&K(f,o),b[0]&268435456&&d!==(d=O[28].t("Cancel")+"")&&K(_,d),b[0]&268435456&&E!==(E=O[28].t("Save")+"")&&K(C,E)},i:ye,o:ye,d(O){O&&m(e),n[51](null),R=!1,Ye(P)}}}function Zo(n){var l;let e,t;return e=new Do({props:{id:n[13].id,history:n[0],content:n[13].content,sources:n[13].sources,floatingButtons:((l=n[13])==null?void 0:l.done)&&!n[12],save:!n[12],model:n[17],onTaskClick:n[57],onSourceClick:n[58],onAddMessages:n[59]}}),e.$on("update",n[60]),e.$on("select",n[61]),{c(){x(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,r){te(e,s,r),t=!0},p(s,r){var a;const i={};r[0]&8192&&(i.id=s[13].id),r[0]&1&&(i.history=s[0]),r[0]&8192&&(i.content=s[13].content),r[0]&8192&&(i.sources=s[13].sources),r[0]&12288&&(i.floatingButtons=((a=s[13])==null?void 0:a.done)&&!s[12]),r[0]&4096&&(i.save=!s[12]),r[0]&131072&&(i.model=s[17]),r[0]&8192&&(i.onSourceClick=s[58]),r[0]&1024&&(i.onAddMessages=s[59]),e.$set(i)},i(s){t||(v(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function Qo(n){let e,t;return e=new Yt({}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p:ye,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ds(n){var l,s;let e,t;return e=new wi({props:{content:((s=(l=n[13])==null?void 0:l.error)==null?void 0:s.content)??n[13].content}}),{c(){x(e.$$.fragment)},l(r){ee(e.$$.fragment,r)},m(r,i){te(e,r,i),t=!0},p(r,i){var o,f;const a={};i[0]&8192&&(a.content=((f=(o=r[13])==null?void 0:o.error)==null?void 0:f.content)??r[13].content),e.$set(a)},i(r){t||(v(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){le(e,r)}}}function hs(n){var l,s,r;let e,t;return e=new Zi({props:{id:(l=n[13])==null?void 0:l.id,sources:((s=n[13])==null?void 0:s.sources)??((r=n[13])==null?void 0:r.citations)}}),{c(){x(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,a){te(e,i,a),t=!0},p(i,a){var f,u,c;const o={};a[0]&8192&&(o.id=(f=i[13])==null?void 0:f.id),a[0]&8192&&(o.sources=((u=i[13])==null?void 0:u.sources)??((c=i[13])==null?void 0:c.citations)),e.$set(o)},i(i){t||(v(e.$$.fragment,i),t=!0)},o(i){D(e.$$.fragment,i),t=!1},d(i){le(e,i)}}}function ms(n){let e,t;return e=new co({props:{codeExecutions:n[13].code_executions}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.codeExecutions=l[13].code_executions),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function gs(n){let e,t,l,s,r=(n[13].done||n[1].length>1)&&_s(n),i=n[13].done&&n[24]&&Ts(n);return{c(){e=I("div"),r&&r.c(),t=j(),i&&i.c(),l=de(),this.h()},l(a){e=M(a,"DIV",{class:!0});var o=k(e);r&&r.l(o),o.forEach(m),t=z(a),i&&i.l(a),l=de(),this.h()},h(){h(e,"class","flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-1u5gq5j")},m(a,o){V(a,e,o),r&&r.m(e,null),n[78](e),V(a,t,o),i&&i.m(a,o),V(a,l,o),s=!0},p(a,o){a[13].done||a[1].length>1?r?(r.p(a,o),o[0]&8194&&v(r,1)):(r=_s(a),r.c(),v(r,1),r.m(e,null)):r&&(se(),D(r,1,1,()=>{r=null}),ne()),a[13].done&&a[24]?i?(i.p(a,o),o[0]&16785408&&v(i,1)):(i=Ts(a),i.c(),v(i,1),i.m(l.parentNode,l)):i&&(se(),D(i,1,1,()=>{i=null}),ne())},i(a){s||(v(r),v(i),s=!0)},o(a){D(r),D(i),s=!1},d(a){a&&(m(e),m(t),m(l)),r&&r.d(),n[78](null),i&&i.d(a)}}}function _s(n){let e,t,l,s=n[1].length>1&&ps(n),r=n[13].done&&bs(n);return{c(){s&&s.c(),e=j(),r&&r.c(),t=de()},l(i){s&&s.l(i),e=z(i),r&&r.l(i),t=de()},m(i,a){s&&s.m(i,a),V(i,e,a),r&&r.m(i,a),V(i,t,a),l=!0},p(i,a){i[1].length>1?s?s.p(i,a):(s=ps(i),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),i[13].done?r?(r.p(i,a),a[0]&8192&&v(r,1)):(r=bs(i),r.c(),v(r,1),r.m(t.parentNode,t)):r&&(se(),D(r,1,1,()=>{r=null}),ne())},i(i){l||(v(r),l=!0)},o(i){D(r),l=!1},d(i){i&&(m(e),m(t)),s&&s.d(i),r&&r.d(i)}}}function ps(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,a='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',o,f;function u(d,_){return d[20]?Xo:Yo}let c=u(n),g=c(n);return{c(){e=I("div"),t=I("button"),t.innerHTML=l,s=j(),g.c(),r=j(),i=I("button"),i.innerHTML=a,this.h()},l(d){e=M(d,"DIV",{class:!0,dir:!0});var _=k(e);t=M(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(t)!=="svelte-1e0chv1"&&(t.innerHTML=l),s=z(_),g.l(_),r=z(_),i=M(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-107ksnk"&&(i.innerHTML=a),_.forEach(m),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center min-w-fit"),h(e,"dir","ltr")},m(d,_){V(d,e,_),p(e,t),p(e,s),g.m(e,null),p(e,r),p(e,i),o||(f=[ce(t,"click",n[62]),ce(i,"click",n[66])],o=!0)},p(d,_){c===(c=u(d))&&g?g.p(d,_):(g.d(1),g=c(d),g&&(g.c(),g.m(e,r)))},d(d){d&&m(e),g.d(),o=!1,Ye(f)}}}function Yo(n){let e,t=n[1].indexOf(n[13].id)+1+"",l,s,r=n[1].length+"",i,a,o;return{c(){e=I("div"),l=W(t),s=W("/"),i=W(r),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=k(e);l=F(u,t),s=F(u,"/"),i=F(u,r),u.forEach(m),this.h()},h(){h(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){V(f,e,u),p(e,l),p(e,s),p(e,i),a||(o=ce(e,"dblclick",n[65]),a=!0)},p(f,u){u[0]&8194&&t!==(t=f[1].indexOf(f[13].id)+1+"")&&K(l,t),u[0]&2&&r!==(r=f[1].length+"")&&K(i,r)},d(f){f&&m(e),a=!1,o()}}}function Xo(n){let e,t,l,s,r,i,a=n[1].length+"",o,f,u;return{c(){e=I("div"),t=I("input"),i=W("/"),o=W(a),this.h()},l(c){e=M(c,"DIV",{class:!0});var g=k(e);t=M(g,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=F(g,"/"),o=F(g,a),g.forEach(m),this.h()},h(){h(t,"id",l="message-index-input-"+n[13].id),h(t,"type","number"),t.value=s=n[1].indexOf(n[13].id)+1,h(t,"min","1"),h(t,"max",r=n[1].length),h(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),h(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,g){V(c,e,g),p(e,t),p(e,i),p(e,o),f||(u=[ce(t,"focus",ba),ce(t,"blur",n[63]),ce(t,"keydown",n[64])],f=!0)},p(c,g){g[0]&8192&&l!==(l="message-index-input-"+c[13].id)&&h(t,"id",l),g[0]&8194&&s!==(s=c[1].indexOf(c[13].id)+1)&&t.value!==s&&(t.value=s),g[0]&2&&r!==(r=c[1].length)&&h(t,"max",r),g[0]&2&&a!==(a=c[1].length+"")&&K(o,a)},d(c){c&&m(e),f=!1,Ye(u)}}}function bs(n){var _,y,w,E,C,R,P,O,b;let e,t,l,s,r,i,a,o,f=!n[12]&&vs(n);t=new Se({props:{content:n[28].t("Copy"),placement:"bottom",$$slots:{default:[xo]},$$scope:{ctx:n}}});let u=(((_=n[29])==null?void 0:_.role)==="admin"||(((E=(w=(y=n[29])==null?void 0:y.permissions)==null?void 0:w.chat)==null?void 0:E.tts)??!0))&&ws(n),c=((C=n[27])==null?void 0:C.features.enable_image_generation)&&(((R=n[29])==null?void 0:R.role)==="admin"||((b=(O=(P=n[29])==null?void 0:P.permissions)==null?void 0:O.features)==null?void 0:b.image_generation))&&!n[12]&&ys(n),g=n[13].usage&&Is(n),d=!n[12]&&Ms(n);return{c(){f&&f.c(),e=j(),x(t.$$.fragment),l=j(),u&&u.c(),s=j(),c&&c.c(),r=j(),g&&g.c(),i=j(),d&&d.c(),a=de()},l(N){f&&f.l(N),e=z(N),ee(t.$$.fragment,N),l=z(N),u&&u.l(N),s=z(N),c&&c.l(N),r=z(N),g&&g.l(N),i=z(N),d&&d.l(N),a=de()},m(N,B){f&&f.m(N,B),V(N,e,B),te(t,N,B),V(N,l,B),u&&u.m(N,B),V(N,s,B),c&&c.m(N,B),V(N,r,B),g&&g.m(N,B),V(N,i,B),d&&d.m(N,B),V(N,a,B),o=!0},p(N,B){var T,L,H,Y,oe,ie,re,ue,me;N[12]?f&&(se(),D(f,1,1,()=>{f=null}),ne()):f?(f.p(N,B),B[0]&4096&&v(f,1)):(f=vs(N),f.c(),v(f,1),f.m(e.parentNode,e));const S={};B[0]&268435456&&(S.content=N[28].t("Copy")),B[0]&10240|B[3]&8&&(S.$$scope={dirty:B,ctx:N}),t.$set(S),((T=N[29])==null?void 0:T.role)==="admin"||(((Y=(H=(L=N[29])==null?void 0:L.permissions)==null?void 0:H.chat)==null?void 0:Y.tts)??!0)?u?(u.p(N,B),B[0]&536870912&&v(u,1)):(u=ws(N),u.c(),v(u,1),u.m(s.parentNode,s)):u&&(se(),D(u,1,1,()=>{u=null}),ne()),(oe=N[27])!=null&&oe.features.enable_image_generation&&(((ie=N[29])==null?void 0:ie.role)==="admin"||(me=(ue=(re=N[29])==null?void 0:re.permissions)==null?void 0:ue.features)!=null&&me.image_generation)&&!N[12]?c?(c.p(N,B),B[0]&671092736&&v(c,1)):(c=ys(N),c.c(),v(c,1),c.m(r.parentNode,r)):c&&(se(),D(c,1,1,()=>{c=null}),ne()),N[13].usage?g?(g.p(N,B),B[0]&8192&&v(g,1)):(g=Is(N),g.c(),v(g,1),g.m(i.parentNode,i)):g&&(se(),D(g,1,1,()=>{g=null}),ne()),N[12]?d&&(se(),D(d,1,1,()=>{d=null}),ne()):d?(d.p(N,B),B[0]&4096&&v(d,1)):(d=Ms(N),d.c(),v(d,1),d.m(a.parentNode,a))},i(N){o||(v(f),v(t.$$.fragment,N),v(u),v(c),v(g),v(d),o=!0)},o(N){D(f),D(t.$$.fragment,N),D(u),D(c),D(g),D(d),o=!1},d(N){N&&(m(e),m(l),m(s),m(r),m(i),m(a)),f&&f.d(N),le(t,N),u&&u.d(N),c&&c.d(N),g&&g.d(N),d&&d.d(N)}}}function vs(n){var s,r,i,a;let e,t,l=(((s=n[29])==null?void 0:s.role)==="user"?((a=(i=(r=n[29])==null?void 0:r.permissions)==null?void 0:i.chat)==null?void 0:a.edit)??!0:!0)&&ks(n);return{c(){l&&l.c(),e=de()},l(o){l&&l.l(o),e=de()},m(o,f){l&&l.m(o,f),V(o,e,f),t=!0},p(o,f){var u,c,g,d;((u=o[29])==null?void 0:u.role)!=="user"||(((d=(g=(c=o[29])==null?void 0:c.permissions)==null?void 0:g.chat)==null?void 0:d.edit)??!0)?l?(l.p(o,f),f[0]&536870912&&v(l,1)):(l=ks(o),l.c(),v(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),ne())},i(o){t||(v(l),t=!0)},o(o){D(l),t=!1},d(o){o&&m(e),l&&l.d(o)}}}function ks(n){let e,t;return e=new Se({props:{content:n[28].t("Edit"),placement:"bottom",$$slots:{default:[$o]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Edit")),s[0]&2048|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function $o(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=Ie("svg"),l=Ie("path"),this.h()},l(a){e=M(a,"BUTTON",{class:!0});var o=k(e);t=Me(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=Me(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(a,o){V(a,e,o),p(e,t),p(t,l),r||(i=ce(e,"click",n[67]),r=!0)},p(a,o){o[0]&2048&&s!==(s=(a[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",s)},d(a){a&&m(e),r=!1,i()}}}function xo(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=Ie("svg"),l=Ie("path"),this.h()},l(a){e=M(a,"BUTTON",{class:!0});var o=k(e);t=Me(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=Me(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")},m(a,o){V(a,e,o),p(e,t),p(t,l),r||(i=ce(e,"click",n[68]),r=!0)},p(a,o){o[0]&2048&&s!==(s=(a[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")&&h(e,"class",s)},d(a){a&&m(e),r=!1,i()}}}function ws(n){let e,t;return e=new Se({props:{content:n[28].t("Read Aloud"),placement:"bottom",$$slots:{default:[sa]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Read Aloud")),s[0]&6301696|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ea(n){let e,t;return{c(){e=Ie("svg"),t=Ie("path"),this.h()},l(l){e=Me(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=Me(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){V(l,e,s),p(e,t)},d(l){l&&m(e)}}}function ta(n){let e,t;return{c(){e=Ie("svg"),t=Ie("path"),this.h()},l(l){e=Me(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=Me(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){V(l,e,s),p(e,t)},d(l){l&&m(e)}}}function la(n){let e,t,l,s,r,i;return{c(){e=Ie("svg"),t=Ie("style"),l=W(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=Ie("circle"),r=Ie("circle"),i=Ie("circle"),this.h()},l(a){e=Me(a,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var o=k(e);t=Me(o,"style",{});var f=k(t);l=F(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(m),s=Me(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(m),r=Me(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(m),i=Me(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(m),o.forEach(m),this.h()},h(){h(s,"class","spinner_S1WN"),h(s,"cx","4"),h(s,"cy","12"),h(s,"r","3"),h(r,"class","spinner_S1WN spinner_Km9P"),h(r,"cx","12"),h(r,"cy","12"),h(r,"r","3"),h(i,"class","spinner_S1WN spinner_JApP"),h(i,"cx","20"),h(i,"cy","12"),h(i,"r","3"),h(e,"class","w-4 h-4"),h(e,"fill","currentColor"),h(e,"viewBox","0 0 24 24"),h(e,"xmlns","http://www.w3.org/2000/svg")},m(a,o){V(a,e,o),p(e,t),p(t,l),p(e,s),p(e,r),p(e,i)},d(a){a&&m(e)}}}function sa(n){let e,t,l,s,r;function i(f,u){return f[22]?la:f[21]?ta:ea}let a=i(n),o=a(n);return{c(){e=I("button"),o.c(),this.h()},l(f){e=M(f,"BUTTON",{id:!0,class:!0});var u=k(e);o.l(u),u.forEach(m),this.h()},h(){h(e,"id",t="speak-button-"+n[13].id),h(e,"class",l=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(f,u){V(f,e,u),o.m(e,null),s||(r=ce(e,"click",n[69]),s=!0)},p(f,u){a!==(a=i(f))&&(o.d(1),o=a(f),o&&(o.c(),o.m(e,null))),u[0]&8192&&t!==(t="speak-button-"+f[13].id)&&h(e,"id",t),u[0]&2048&&l!==(l=(f[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",l)},d(f){f&&m(e),o.d(),s=!1,r()}}}function ys(n){let e,t;return e=new Se({props:{content:n[28].t("Generate Image"),placement:"bottom",$$slots:{default:[ia]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Generate Image")),s[0]&8398848|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function na(n){let e,t;return{c(){e=Ie("svg"),t=Ie("path"),this.h()},l(l){e=Me(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=Me(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){V(l,e,s),p(e,t)},d(l){l&&m(e)}}}function ra(n){let e,t,l,s,r,i;return{c(){e=Ie("svg"),t=Ie("style"),l=W(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=Ie("circle"),r=Ie("circle"),i=Ie("circle"),this.h()},l(a){e=Me(a,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var o=k(e);t=Me(o,"style",{});var f=k(t);l=F(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(m),s=Me(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(m),r=Me(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(m),i=Me(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(m),o.forEach(m),this.h()},h(){h(s,"class","spinner_S1WN"),h(s,"cx","4"),h(s,"cy","12"),h(s,"r","3"),h(r,"class","spinner_S1WN spinner_Km9P"),h(r,"cx","12"),h(r,"cy","12"),h(r,"r","3"),h(i,"class","spinner_S1WN spinner_JApP"),h(i,"cx","20"),h(i,"cy","12"),h(i,"r","3"),h(e,"class","w-4 h-4"),h(e,"fill","currentColor"),h(e,"viewBox","0 0 24 24"),h(e,"xmlns","http://www.w3.org/2000/svg")},m(a,o){V(a,e,o),p(e,t),p(t,l),p(e,s),p(e,r),p(e,i)},d(a){a&&m(e)}}}function ia(n){let e,t,l,s;function r(o,f){return o[23]?ra:na}let i=r(n),a=i(n);return{c(){e=I("button"),a.c(),this.h()},l(o){e=M(o,"BUTTON",{class:!0});var f=k(e);a.l(f),f.forEach(m),this.h()},h(){h(e,"class",t=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(o,f){V(o,e,f),a.m(e,null),l||(s=ce(e,"click",n[70]),l=!0)},p(o,f){i!==(i=r(o))&&(a.d(1),a=i(o),a&&(a.c(),a.m(e,null))),f[0]&2048&&t!==(t=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",t)},d(o){o&&m(e),a.d(),l=!1,s()}}}function Is(n){let e,t;return e=new Se({props:{content:n[13].usage?`<pre>${bt(JSON.stringify(n[13].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Os).map(Rs).join(`
`))}</pre>`:"",placement:"bottom",$$slots:{default:[oa]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.content=l[13].usage?`<pre>${bt(JSON.stringify(l[13].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Os).map(Rs).join(`
`))}</pre>`:""),s[0]&10240|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function oa(n){let e,t,l,s,r,i,a;return{c(){e=I("button"),t=Ie("svg"),l=Ie("path"),this.h()},l(o){e=M(o,"BUTTON",{class:!0,id:!0});var f=k(e);t=Me(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=Me(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap"),h(e,"id",r="info-"+n[13].id)},m(o,f){V(o,e,f),p(e,t),p(t,l),i||(a=ce(e,"click",n[71]),i=!0)},p(o,f){f[0]&2048&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap")&&h(e,"class",s),f[0]&8192&&r!==(r="info-"+o[13].id)&&h(e,"id",r)},d(o){o&&m(e),i=!1,a()}}}function Ms(n){var g;let e,t,l,s,r,i,a,o=!n[30]&&(((g=n[27])==null?void 0:g.features.enable_message_rating)??!0)&&Es(n),f=n[11]&&Ns(n);l=new Se({props:{content:n[28].t("Regenerate"),placement:"bottom",$$slots:{default:[ca]},$$scope:{ctx:n}}});let u=n[1].length>1&&Ds(n),c=n[11]&&Vs(n);return{c(){o&&o.c(),e=j(),f&&f.c(),t=j(),x(l.$$.fragment),s=j(),u&&u.c(),r=j(),c&&c.c(),i=de()},l(d){o&&o.l(d),e=z(d),f&&f.l(d),t=z(d),ee(l.$$.fragment,d),s=z(d),u&&u.l(d),r=z(d),c&&c.l(d),i=de()},m(d,_){o&&o.m(d,_),V(d,e,_),f&&f.m(d,_),V(d,t,_),te(l,d,_),V(d,s,_),u&&u.m(d,_),V(d,r,_),c&&c.m(d,_),V(d,i,_),a=!0},p(d,_){var w;!d[30]&&(((w=d[27])==null?void 0:w.features.enable_message_rating)??!0)?o?(o.p(d,_),_[0]&1207959552&&v(o,1)):(o=Es(d),o.c(),v(o,1),o.m(e.parentNode,e)):o&&(se(),D(o,1,1,()=>{o=null}),ne()),d[11]?f?(f.p(d,_),_[0]&2048&&v(f,1)):(f=Ns(d),f.c(),v(f,1),f.m(t.parentNode,t)):f&&(se(),D(f,1,1,()=>{f=null}),ne());const y={};_[0]&268435456&&(y.content=d[28].t("Regenerate")),_[0]&16919040|_[3]&8&&(y.$$scope={dirty:_,ctx:d}),l.$set(y),d[1].length>1?u?(u.p(d,_),_[0]&2&&v(u,1)):(u=Ds(d),u.c(),v(u,1),u.m(r.parentNode,r)):u&&(se(),D(u,1,1,()=>{u=null}),ne()),d[11]?c?(c.p(d,_),_[0]&2048&&v(c,1)):(c=Vs(d),c.c(),v(c,1),c.m(i.parentNode,i)):c&&(se(),D(c,1,1,()=>{c=null}),ne())},i(d){a||(v(o),v(f),v(l.$$.fragment,d),v(u),v(c),a=!0)},o(d){D(o),D(f),D(l.$$.fragment,d),D(u),D(c),a=!1},d(d){d&&(m(e),m(t),m(s),m(r),m(i)),o&&o.d(d),f&&f.d(d),le(l,d),u&&u.d(d),c&&c.d(d)}}}function Es(n){let e,t,l,s;return e=new Se({props:{content:n[28].t("Good Response"),placement:"bottom",$$slots:{default:[aa]},$$scope:{ctx:n}}}),l=new Se({props:{content:n[28].t("Bad Response"),placement:"bottom",$$slots:{default:[fa]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment),t=j(),x(l.$$.fragment)},l(r){ee(e.$$.fragment,r),t=z(r),ee(l.$$.fragment,r)},m(r,i){te(e,r,i),V(r,t,i),te(l,r,i),s=!0},p(r,i){const a={};i[0]&268435456&&(a.content=r[28].t("Good Response")),i[0]&33564672|i[3]&8&&(a.$$scope={dirty:i,ctx:r}),e.$set(a);const o={};i[0]&268435456&&(o.content=r[28].t("Bad Response")),i[0]&33564672|i[3]&8&&(o.$$scope={dirty:i,ctx:r}),l.$set(o)},i(r){s||(v(e.$$.fragment,r),v(l.$$.fragment,r),s=!0)},o(r){D(e.$$.fragment,r),D(l.$$.fragment,r),s=!1},d(r){r&&m(t),le(e,r),le(l,r)}}}function aa(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=Ie("svg"),l=Ie("path"),this.h()},l(a){e=M(a,"BUTTON",{class:!0});var o=k(e);t=Me(o,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=k(t);l=Me(f,"path",{d:!0}),k(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){var a,o;h(l,"d","M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"),h(t,"stroke","currentColor"),h(t,"fill","none"),h(t,"stroke-width","2.3"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"class","w-4 h-4"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((o=(a=n[13])==null?void 0:a.annotation)==null?void 0:o.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[25]},m(a,o){V(a,e,o),p(e,t),p(t,l),r||(i=ce(e,"click",n[72]),r=!0)},p(a,o){var f,u;o[0]&10240&&s!==(s=(a[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=a[13])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&h(e,"class",s),o[0]&33554432&&(e.disabled=a[25])},d(a){a&&m(e),r=!1,i()}}}function fa(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=Ie("svg"),l=Ie("path"),this.h()},l(a){e=M(a,"BUTTON",{class:!0});var o=k(e);t=Me(o,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=k(t);l=Me(f,"path",{d:!0}),k(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){var a,o;h(l,"d","M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"),h(t,"stroke","currentColor"),h(t,"fill","none"),h(t,"stroke-width","2.3"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"class","w-4 h-4"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((o=(a=n[13])==null?void 0:a.annotation)==null?void 0:o.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[25]},m(a,o){V(a,e,o),p(e,t),p(t,l),r||(i=ce(e,"click",n[73]),r=!0)},p(a,o){var f,u;o[0]&10240&&s!==(s=(a[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=a[13])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&h(e,"class",s),o[0]&33554432&&(e.disabled=a[25])},d(a){a&&m(e),r=!1,i()}}}function Ns(n){let e,t;return e=new Se({props:{content:n[28].t("Continue Response"),placement:"bottom",$$slots:{default:[ua]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Continue Response")),s[0]&2304|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ua(n){let e,t,l,s,r,i,a;return{c(){e=I("button"),t=Ie("svg"),l=Ie("path"),s=Ie("path"),this.h()},l(o){e=M(o,"BUTTON",{type:!0,id:!0,class:!0});var f=k(e);t=Me(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=Me(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),s=Me(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(s).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),h(s,"stroke-linecap","round"),h(s,"stroke-linejoin","round"),h(s,"d","M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"id","continue-response-button"),h(e,"class",r=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,f){V(o,e,f),p(e,t),p(t,l),p(t,s),i||(a=ce(e,"click",n[74]),i=!0)},p(o,f){f[0]&2048&&r!==(r=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",r)},d(o){o&&m(e),i=!1,a()}}}function ca(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=Ie("svg"),l=Ie("path"),this.h()},l(a){e=M(a,"BUTTON",{type:!0,class:!0});var o=k(e);t=Me(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=Me(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,o){V(a,e,o),p(e,t),p(t,l),r||(i=ce(e,"click",n[75]),r=!0)},p(a,o){o[0]&2048&&s!==(s=(a[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",s)},d(a){a&&m(e),r=!1,i()}}}function Ds(n){let e,t;return e=new Se({props:{content:n[28].t("Delete"),placement:"bottom",$$slots:{default:[da]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Delete")),s[0]&67584|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function da(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=Ie("svg"),l=Ie("path"),this.h()},l(a){e=M(a,"BUTTON",{type:!0,id:!0,class:!0});var o=k(e);t=Me(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=Me(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"id","delete-response-button"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,o){V(a,e,o),p(e,t),p(t,l),r||(i=ce(e,"click",n[76]),r=!0)},p(a,o){o[0]&2048&&s!==(s=(a[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",s)},d(a){a&&m(e),r=!1,i()}}}function Vs(n){var i;let e,t,l=De(((i=n[17])==null?void 0:i.actions)??[]),s=[];for(let a=0;a<l.length;a+=1)s[a]=Cs(rs(n,l,a));const r=a=>D(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=de()},l(a){for(let o=0;o<s.length;o+=1)s[o].l(a);e=de()},m(a,o){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(a,o);V(a,e,o),t=!0},p(a,o){var f;if(o[0]&141376){l=De(((f=a[17])==null?void 0:f.actions)??[]);let u;for(u=0;u<l.length;u+=1){const c=rs(a,l,u);s[u]?(s[u].p(c,o),v(s[u],1)):(s[u]=Cs(c),s[u].c(),v(s[u],1),s[u].m(e.parentNode,e))}for(se(),u=l.length;u<s.length;u+=1)r(u);ne()}},i(a){if(!t){for(let o=0;o<l.length;o+=1)v(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)D(s[o]);t=!1},d(a){a&&m(e),Fe(s,a)}}}function ha(n){let e,t;return e=new Ar({props:{strokeWidth:"2.1",className:"size-4"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p:ye,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ma(n){let e,t,l,s,r;return{c(){e=I("div"),t=I("img"),this.h()},l(i){e=M(i,"DIV",{class:!0});var a=k(e);t=M(a,"IMG",{src:!0,class:!0,style:!0,alt:!0}),a.forEach(m),this.h()},h(){Pt(t.src,l=n[89].icon_url)||h(t,"src",l),h(t,"class",s="w-4 h-4 "+(n[89].icon_url.includes("svg")?"dark:invert-[80%]":"")),Rt(t,"fill","currentColor"),h(t,"alt",r=n[89].name),h(e,"class","size-4")},m(i,a){V(i,e,a),p(e,t)},p(i,a){a[0]&131072&&!Pt(t.src,l=i[89].icon_url)&&h(t,"src",l),a[0]&131072&&s!==(s="w-4 h-4 "+(i[89].icon_url.includes("svg")?"dark:invert-[80%]":""))&&h(t,"class",s),a[0]&131072&&r!==(r=i[89].name)&&h(t,"alt",r)},i:ye,o:ye,d(i){i&&m(e)}}}function ga(n){let e,t,l,s,r,i,a,o;const f=[ma,ha],u=[];function c(d,_){return d[89].icon_url?0:1}t=c(n),l=u[t]=f[t](n);function g(){return n[77](n[89])}return{c(){e=I("button"),l.c(),r=j(),this.h()},l(d){e=M(d,"BUTTON",{type:!0,class:!0});var _=k(e);l.l(_),_.forEach(m),r=z(d),this.h()},h(){h(e,"type","button"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(d,_){V(d,e,_),u[t].m(e,null),V(d,r,_),i=!0,a||(o=ce(e,"click",g),a=!0)},p(d,_){n=d;let y=t;t=c(n),t===y?u[t].p(n,_):(se(),D(u[y],1,1,()=>{u[y]=null}),ne(),l=u[t],l?l.p(n,_):(l=u[t]=f[t](n),l.c()),v(l,1),l.m(e,null)),(!i||_[0]&2048&&s!==(s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition"))&&h(e,"class",s)},i(d){i||(v(l),i=!0)},o(d){D(l),i=!1},d(d){d&&(m(e),m(r)),u[t].d(),a=!1,o()}}}function Cs(n){let e,t;return e=new Se({props:{content:n[89].name,placement:"bottom",$$slots:{default:[ga]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&131072&&(r.content=l[89].name),s[0]&141376|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Ts(n){let e,t,l,s;function r(o){n[79](o)}function i(o){n[80](o)}let a={};return n[13]!==void 0&&(a.message=n[13]),n[24]!==void 0&&(a.show=n[24]),e=new ci({props:a}),je.push(()=>Qe(e,"message",r)),je.push(()=>Qe(e,"show",i)),e.$on("save",n[81]),{c(){x(e.$$.fragment)},l(o){ee(e.$$.fragment,o)},m(o,f){te(e,o,f),s=!0},p(o,f){const u={};!t&&f[0]&8192&&(t=!0,u.message=o[13],Ze(()=>t=!1)),!l&&f[0]&16777216&&(l=!0,u.show=o[24],Ze(()=>l=!1)),e.$set(u)},i(o){s||(v(e.$$.fragment,o),s=!0)},o(o){D(e.$$.fragment,o),s=!1},d(o){le(e,o)}}}function Bs(n){var H,Y,oe,ie,re,ue,me,ke;let e,t,l,s,r,i,a,o,f,u,c,g=((H=n[13])==null?void 0:H.files)&&((Y=n[13].files)==null?void 0:Y.filter(Ss).length)>0,d,_,y,w,E,C,R,P,O;l=new Vn({props:{src:((re=(ie=(oe=n[17])==null?void 0:oe.info)==null?void 0:ie.meta)==null?void 0:re.profile_image_url)??(n[28].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`),className:"size-8"}}),i=new Kt({props:{$$slots:{default:[To]},$$scope:{ctx:n}}});let b=(((ue=n[13])==null?void 0:ue.statusHistory)??[...(me=n[13])!=null&&me.status?[(ke=n[13])==null?void 0:ke.status]:[]]).length>0&&as(Ut(n)),N=g&&us(n);const B=[Ko,Go],S=[];function T(q,Z){return q[14]===!0?0:1}_=T(n),y=S[_]=B[_](n);let L=!n[14]&&gs(n);return{c(){e=I("div"),t=I("div"),x(l.$$.fragment),s=j(),r=I("div"),x(i.$$.fragment),a=j(),o=I("div"),f=I("div"),u=I("div"),b&&b.c(),c=j(),N&&N.c(),d=j(),y.c(),E=j(),L&&L.c(),this.h()},l(q){e=M(q,"DIV",{class:!0,id:!0,dir:!0});var Z=k(e);t=M(Z,"DIV",{class:!0});var ge=k(t);ee(l.$$.fragment,ge),ge.forEach(m),s=z(Z),r=M(Z,"DIV",{class:!0});var pe=k(r);ee(i.$$.fragment,pe),a=z(pe),o=M(pe,"DIV",{});var _e=k(o);f=M(_e,"DIV",{class:!0});var J=k(f);u=M(J,"DIV",{});var he=k(u);b&&b.l(he),c=z(he),N&&N.l(he),d=z(he),y.l(he),he.forEach(m),J.forEach(m),E=z(_e),L&&L.l(_e),_e.forEach(m),pe.forEach(m),Z.forEach(m),this.h()},h(){h(t,"class",hr("shrink-0 ltr:mr-3 rtl:ml-3")+" svelte-1u5gq5j"),h(f,"class",w="chat-"+n[13].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"),h(r,"class","flex-auto w-0 pl-1"),h(e,"class",C="flex w-full message-"+n[13].id+" svelte-1u5gq5j"),h(e,"id",R="message-"+n[13].id),h(e,"dir",P=n[26].chatDirection)},m(q,Z){V(q,e,Z),p(e,t),te(l,t,null),p(e,s),p(e,r),te(i,r,null),p(r,a),p(r,o),p(o,f),p(f,u),b&&b.m(u,null),p(u,c),N&&N.m(u,null),p(u,d),S[_].m(u,null),p(o,E),L&&L.m(o,null),O=!0},p(q,Z){var J,he,ae,be,A,G,$,Q;const ge={};Z[0]&268566528&&(ge.src=((ae=(he=(J=q[17])==null?void 0:J.info)==null?void 0:he.meta)==null?void 0:ae.profile_image_url)??(q[28].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`)),l.$set(ge);const pe={};Z[0]&139264|Z[3]&8&&(pe.$$scope={dirty:Z,ctx:q}),i.$set(pe),(((be=q[13])==null?void 0:be.statusHistory)??[...(A=q[13])!=null&&A.status?[(G=q[13])==null?void 0:G.status]:[]]).length>0?b?(b.p(Ut(q),Z),Z[0]&8192&&v(b,1)):(b=as(Ut(q)),b.c(),v(b,1),b.m(u,c)):b&&(se(),D(b,1,1,()=>{b=null}),ne()),Z[0]&8192&&(g=(($=q[13])==null?void 0:$.files)&&((Q=q[13].files)==null?void 0:Q.filter(Ss).length)>0),g?N?(N.p(q,Z),Z[0]&8192&&v(N,1)):(N=us(q),N.c(),v(N,1),N.m(u,d)):N&&(se(),D(N,1,1,()=>{N=null}),ne());let _e=_;_=T(q),_===_e?S[_].p(q,Z):(se(),D(S[_e],1,1,()=>{S[_e]=null}),ne(),y=S[_],y?y.p(q,Z):(y=S[_]=B[_](q),y.c()),v(y,1),y.m(u,null)),(!O||Z[0]&8192&&w!==(w="chat-"+q[13].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"))&&h(f,"class",w),q[14]?L&&(se(),D(L,1,1,()=>{L=null}),ne()):L?(L.p(q,Z),Z[0]&16384&&v(L,1)):(L=gs(q),L.c(),v(L,1),L.m(o,null)),(!O||Z[0]&8192&&C!==(C="flex w-full message-"+q[13].id+" svelte-1u5gq5j"))&&h(e,"class",C),(!O||Z[0]&8192&&R!==(R="message-"+q[13].id))&&h(e,"id",R),(!O||Z[0]&67108864&&P!==(P=q[26].chatDirection))&&h(e,"dir",P)},i(q){O||(v(l.$$.fragment,q),v(i.$$.fragment,q),v(b),v(N),v(y),v(L),O=!0)},o(q){D(l.$$.fragment,q),D(i.$$.fragment,q),D(b),D(N),D(y),D(L),O=!1},d(q){q&&m(e),le(l),le(i),b&&b.d(),N&&N.d(),S[_].d(),L&&L.d()}}}function _a(n){let e,t,l,s=n[13].id,r,i;function a(u){n[49](u)}let o={title:n[28].t("Delete message?")};n[16]!==void 0&&(o.show=n[16]),e=new On({props:o}),je.push(()=>Qe(e,"show",a)),e.$on("confirm",n[50]);let f=Bs(n);return{c(){x(e.$$.fragment),l=j(),f.c(),r=de()},l(u){ee(e.$$.fragment,u),l=z(u),f.l(u),r=de()},m(u,c){te(e,u,c),V(u,l,c),f.m(u,c),V(u,r,c),i=!0},p(u,c){const g={};c[0]&268435456&&(g.title=u[28].t("Delete message?")),!t&&c[0]&65536&&(t=!0,g.show=u[16],Ze(()=>t=!1)),e.$set(g),c[0]&8192&&Be(s,s=u[13].id)?(se(),D(f,1,1,ye),ne(),f=Bs(u),f.c(),v(f,1),f.m(r.parentNode,r)):f.p(u,c)},i(u){i||(v(e.$$.fragment,u),v(f),i=!0)},o(u){D(e.$$.fragment,u),D(f),i=!1},d(u){u&&(m(l),m(r)),le(e,u),f.d(u)}}}const Ss=n=>n.type==="image",pa=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},ba=n=>{n.target.select()},Os=n=>n.slice(2),Rs=n=>n.endsWith(",")?n.slice(0,-1):n;function va(n,e,t){let l,s,r,i,a,o,f;Ee(n,jt,U=>t(48,l=U)),Ee(n,kt,U=>t(26,s=U)),Ee(n,En,U=>t(27,r=U)),Ee(n,cl,U=>t(85,i=U)),Ee(n,zt,U=>t(29,o=U)),Ee(n,Gt,U=>t(30,f=U));const u=Je("i18n");Ee(n,u,U=>t(28,a=U));const c=gt();let{chatId:g=""}=e,{history:d}=e,{messageId:_}=e,y=JSON.parse(JSON.stringify(d.messages[_])),{siblings:w}=e,{gotoMessage:E=()=>{}}=e,{showPreviousMessage:C}=e,{showNextMessage:R}=e,{updateChat:P}=e,{editMessage:O}=e,{saveMessage:b}=e,{rateMessage:N}=e,{actionMessage:B}=e,{deleteMessage:S}=e,{submitMessage:T}=e,{continueResponse:L}=e,{regenerateResponse:H}=e,{addMessages:Y}=e,{isLastMessage:oe=!0}=e,{readOnly:ie=!1}=e,re,ue=!1,me=null,ke=!1,q="",Z,ge=!1,pe={},_e=!1,J,he=!1,ae=!1,be=!1;const A=async U=>{U=Er(U),await Nn(U,(s==null?void 0:s.copyFormatted)??!1)&&Ae.success(a.t("Copying to clipboard was successful!"))},G=U=>new Promise(Ne=>{J=U;const we=pe[U];if(!we)return Ne();we.play(),we.onended=async()=>{await new Promise(Te=>setTimeout(Te,300)),Object.keys(pe).length-1===U&&t(21,_e=!1),Ne()}}),$=async()=>{var U,Ne,we,Te,Ge,et,Ct,ct,wt,Oe,Ke,rt,yt,Tt,Xt,$t,xt,el,tl,ll,sl,nl,rl;if(_e){try{speechSynthesis.cancel(),J!==void 0&&pe[J]&&(pe[J].pause(),pe[J].currentTime=0)}catch{}t(21,_e=!1),J=void 0;return}if(!((y==null?void 0:y.content)??"").trim().length){Ae.info(a.t("No content to speak"));return}if(t(21,_e=!0),r.audio.tts.engine===""){let $e=[];const _t=setInterval(()=>{var xe,dt,tt;if($e=speechSynthesis.getVoices(),$e.length>0){clearInterval(_t);const qe=((xe=$e==null?void 0:$e.filter(mt=>{var il,ol,al,fl;return mt.voiceURI===(((ol=(il=s==null?void 0:s.audio)==null?void 0:il.tts)==null?void 0:ol.voice)??((fl=(al=r==null?void 0:r.audio)==null?void 0:al.tts)==null?void 0:fl.voice))}))==null?void 0:xe.at(0))??void 0;console.log(qe);const ht=new SpeechSynthesisUtterance(y.content);ht.rate=((tt=(dt=s.audio)==null?void 0:dt.tts)==null?void 0:tt.playbackRate)??1,console.log(ht),ht.onend=()=>{var mt;t(21,_e=!1),s.conversationMode&&((mt=document.getElementById("voice-input-button"))==null||mt.click())},qe&&(ht.voice=qe),speechSynthesis.speak(ht)}},100)}else{t(22,he=!0);const $e=Nr(y.content,((Ne=(U=r==null?void 0:r.audio)==null?void 0:U.tts)==null?void 0:Ne.split_on)??"punctuation");if(!$e.length){console.log("No content to speak"),Ae.info(a.t("No content to speak")),t(21,_e=!1),t(22,he=!1);return}console.debug("Prepared message content for TTS",$e),pe=$e.reduce((xe,dt,tt)=>(xe[tt]=null,xe),{});let _t=Promise.resolve();if(((Te=(we=s.audio)==null?void 0:we.tts)==null?void 0:Te.engine)==="browser-kokoro"){i||(await cl.set(new Jr({dtype:((Ct=(et=(Ge=s.audio)==null?void 0:Ge.tts)==null?void 0:et.engineConfig)==null?void 0:Ct.dtype)??"fp32"})),await i.init());for(const[xe,dt]of $e.entries()){const tt=await i.generate({text:dt,voice:((wt=(ct=s==null?void 0:s.audio)==null?void 0:ct.tts)==null?void 0:wt.voice)??((Ke=(Oe=r==null?void 0:r.audio)==null?void 0:Oe.tts)==null?void 0:Ke.voice)}).catch(qe=>{console.error(qe),Ae.error(`${qe}`),t(21,_e=!1),t(22,he=!1)});if(tt){const qe=new Audio(tt);qe.playbackRate=((yt=(rt=s.audio)==null?void 0:rt.tts)==null?void 0:yt.playbackRate)??1,pe[xe]=qe,t(22,he=!1),_t=_t.then(()=>G(xe))}}}else for(const[xe,dt]of $e.entries()){const tt=await Cr(localStorage.token,((Xt=(Tt=s==null?void 0:s.audio)==null?void 0:Tt.tts)==null?void 0:Xt.defaultVoice)===r.audio.tts.voice?((xt=($t=s==null?void 0:s.audio)==null?void 0:$t.tts)==null?void 0:xt.voice)??((tl=(el=r==null?void 0:r.audio)==null?void 0:el.tts)==null?void 0:tl.voice):(sl=(ll=r==null?void 0:r.audio)==null?void 0:ll.tts)==null?void 0:sl.voice,dt).catch(qe=>{console.error(qe),Ae.error(`${qe}`),t(21,_e=!1),t(22,he=!1)});if(tt){const qe=await tt.blob(),ht=URL.createObjectURL(qe),mt=new Audio(ht);mt.playbackRate=((rl=(nl=s.audio)==null?void 0:nl.tts)==null?void 0:rl.playbackRate)??1,pe[xe]=mt,t(22,he=!1),_t=_t.then(()=>G(xe))}}}};let Q=[];function fe(U){const Ne=[];let we=0;return U=U.replace(/<details[\s\S]*?<\/details>/gi,Te=>(Ne.push(Te),`<details id="__DETAIL_${we++}__"/>`)),Q=Ne,U}function ve(U){return U.replace(/<details id="__DETAIL_(\d+)__"\/>/g,(we,Te)=>Q[parseInt(Te)]||"")}const Ce=async()=>{t(14,ke=!0),t(18,q=fe(y.content)),await Ve(),t(19,Z.style.height="",Z),t(19,Z.style.height=`${Z.scrollHeight}px`,Z)},X=async()=>{const U=ve(q||"");O(y.id,U,!1),t(14,ke=!1),t(18,q=""),await Ve()},Re=async()=>{const U=ve(q||"");O(y.id,U),t(14,ke=!1),t(18,q=""),await Ve()},He=async()=>{t(14,ke=!1),t(18,q=""),await Ve()},ze=async U=>{t(23,ae=!0);const Ne=await Tr(localStorage.token,U.content).catch(we=>{Ae.error(`${we}`)});if(console.log(Ne),Ne){const we=Ne.map(Te=>({type:"image",url:`${Te.url}`}));b(U.id,{...U,files:we})}t(23,ae=!1)};let We=!1;const Xe=async(U=null,Ne=null)=>{var wt;t(25,We=!0),console.log("Feedback",U,Ne);const we={...y,annotation:{...(y==null?void 0:y.annotation)??{},...U!==null?{rating:U}:{},...Ne||{}}},Te=await yr(localStorage.token,g).catch(Oe=>{Ae.error(`${Oe}`)});if(!Te)return;const Ge=Ft(d,y.id);let et={type:"rating",data:{...we!=null&&we.annotation?we.annotation:{},model_id:(y==null?void 0:y.selectedModelId)??y.model,...d.messages[y.parentId].childrenIds.length>1?{sibling_model_ids:d.messages[y.parentId].childrenIds.filter(Oe=>Oe!==y.id).map(Oe=>{var Ke;return((Ke=d.messages[Oe])==null?void 0:Ke.selectedModelId)??d.messages[Oe].model})}:{}},meta:{arena:y?y.arena:!1,model_id:y.model,message_id:y.id,message_index:Ge.length,chat_id:g},snapshot:{chat:Te}};const Ct=[et.data.model_id,...et.data.sibling_model_ids??[]].reduce((Oe,Ke)=>{var yt;const rt=l.find(Tt=>Tt.id===Ke);return rt?Oe[rt.id]=((yt=rt==null?void 0:rt.info)==null?void 0:yt.base_model_id)??null:console.warn(`Model with ID ${Ke} not found`),Oe},{});et.meta.base_models=Ct;let ct=null;if(y!=null&&y.feedbackId?ct=await gl(localStorage.token,y.feedbackId,et).catch(Oe=>{Ae.error(`${Oe}`)}):(ct=await Dr(localStorage.token,et).catch(Oe=>{Ae.error(`${Oe}`)}),ct&&(we.feedbackId=ct.id)),console.log(we),b(y.id,we),await Ve(),!Ne&&(t(24,be=!0),!((wt=we.annotation)!=null&&wt.tags))){const Oe=await Vr(localStorage.token,y.model,Ge,g).catch(Ke=>(console.error(Ke),[]));console.log(Oe),Oe&&(we.annotation.tags=Oe,et.data.tags=Oe,b(y.id,we),await gl(localStorage.token,we.feedbackId,et).catch(Ke=>{Ae.error(`${Ke}`)}))}t(25,We=!1)},st=async()=>{S(y.id)};vt(async()=>{await Ve(),re&&(console.log(re),re.addEventListener("wheel",function(U){U.preventDefault(),U.deltaY!==0&&t(15,re.scrollLeft+=U.deltaY,re)}))});function at(U){ue=U,t(16,ue)}const lt=()=>{st()};function ft(U){je[U?"unshift":"push"](()=>{Z=U,t(19,Z)})}function ut(){q=this.value,t(18,q)}const nt=U=>{var Te,Ge;U.key==="Escape"&&((Te=document.getElementById("close-edit-message-button"))==null||Te.click());const Ne=U.metaKey||U.ctrlKey,we=U.key==="Enter";Ne&&we&&((Ge=document.getElementById("confirm-edit-message-button"))==null||Ge.click())},Mt=()=>{Re()},Et=()=>{He()},Nt=()=>{X()},Dt=async U=>{console.log(U)},Vt=async(U,Ne)=>{console.log(U,Ne);let we=document.getElementById(`source-${y.id}-${Ne}`);const Te=document.getElementById(`collapsible-${y.id}`);we?we.click():Te&&(Te.querySelector("div:first-child").dispatchEvent(new PointerEvent("pointerup",{})),await new Promise(Ge=>{requestAnimationFrame(()=>{requestAnimationFrame(Ge)})}),we=document.getElementById(`source-${y.id}-${Ne}`),we&&we.click())},An=({modelId:U,parentId:Ne,messages:we})=>{Y({modelId:U,parentId:Ne,messages:we})},Hn=U=>{const{raw:Ne,oldContent:we,newContent:Te}=U.detail;t(0,d.messages[y.id].content=d.messages[y.id].content.replace(Ne,Ne.replace(we,Te)),d),P()},jn=U=>{var Te;const{type:Ne,content:we}=U.detail;if(Ne==="explain")T(y.id,`Explain this section to me in more detail

\`\`\`
${we}
\`\`\``);else if(Ne==="ask"){const Ge=((Te=U.detail)==null?void 0:Te.input)??"";T(y.id,`\`\`\`
${we}
\`\`\`
${Ge}`)}},zn=()=>{C(y)},Un=U=>{E(y,U.target.value-1),t(20,ge=!1)},qn=U=>{U.key==="Enter"&&(E(y,U.target.value-1),t(20,ge=!1))},Wn=async()=>{t(20,ge=!0),await Ve();const U=document.getElementById(`message-index-input-${y.id}`);U&&(U.focus(),U.select())},Fn=()=>{R(y)},Jn=()=>{Ce()},Gn=()=>{A(y.content)},Kn=()=>{he||$()},Zn=()=>{ae||ze(y)},Qn=()=>{console.log(y)},Yn=async()=>{await Xe(1),window.setTimeout(()=>{var U;(U=document.getElementById(`message-feedback-${y.id}`))==null||U.scrollIntoView()},0)},Xn=async()=>{await Xe(-1),window.setTimeout(()=>{var U;(U=document.getElementById(`message-feedback-${y.id}`))==null||U.scrollIntoView()},0)},$n=()=>{L()},xn=()=>{t(24,be=!1),H(y),((me==null?void 0:me.actions)??[]).forEach(U=>{c("action",{id:U.id,event:{id:"regenerate-response",data:{messageId:y.id}}})})},er=()=>{t(16,ue=!0)},tr=U=>{B(U.id,y)};function lr(U){je[U?"unshift":"push"](()=>{re=U,t(15,re)})}function sr(U){y=U,t(13,y),t(0,d),t(43,_)}function nr(U){be=U,t(24,be)}const rr=async U=>{await Xe(null,{...U.detail})};return n.$$set=U=>{"chatId"in U&&t(42,g=U.chatId),"history"in U&&t(0,d=U.history),"messageId"in U&&t(43,_=U.messageId),"siblings"in U&&t(1,w=U.siblings),"gotoMessage"in U&&t(2,E=U.gotoMessage),"showPreviousMessage"in U&&t(3,C=U.showPreviousMessage),"showNextMessage"in U&&t(4,R=U.showNextMessage),"updateChat"in U&&t(5,P=U.updateChat),"editMessage"in U&&t(44,O=U.editMessage),"saveMessage"in U&&t(45,b=U.saveMessage),"rateMessage"in U&&t(46,N=U.rateMessage),"actionMessage"in U&&t(6,B=U.actionMessage),"deleteMessage"in U&&t(47,S=U.deleteMessage),"submitMessage"in U&&t(7,T=U.submitMessage),"continueResponse"in U&&t(8,L=U.continueResponse),"regenerateResponse"in U&&t(9,H=U.regenerateResponse),"addMessages"in U&&t(10,Y=U.addMessages),"isLastMessage"in U&&t(11,oe=U.isLastMessage),"readOnly"in U&&t(12,ie=U.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&8193|n.$$.dirty[1]&4096&&d.messages&&JSON.stringify(y)!==JSON.stringify(d.messages[_])&&t(13,y=JSON.parse(JSON.stringify(d.messages[_]))),n.$$.dirty[0]&8192|n.$$.dirty[1]&131072&&t(17,me=l.find(U=>U.id===y.model)),n.$$.dirty[0]&16384&&(ke||(async()=>await Ve())())},[d,w,E,C,R,P,B,T,L,H,Y,oe,ie,y,ke,re,ue,me,q,Z,ge,_e,he,ae,be,We,s,r,a,o,f,u,c,A,$,Ce,X,Re,He,ze,Xe,st,g,_,O,b,N,S,l,at,lt,ft,ut,nt,Mt,Et,Nt,Dt,Vt,An,Hn,jn,zn,Un,qn,Wn,Fn,Jn,Gn,Kn,Zn,Qn,Yn,Xn,$n,xn,er,tr,lr,sr,nr,rr]}class Ln extends Pe{constructor(e){super(),Le(this,e,va,_a,Be,{chatId:42,history:0,messageId:43,siblings:1,gotoMessage:2,showPreviousMessage:3,showNextMessage:4,updateChat:5,editMessage:44,saveMessage:45,rateMessage:46,actionMessage:6,deleteMessage:47,submitMessage:7,continueResponse:8,regenerateResponse:9,addMessages:10,isLastMessage:11,readOnly:12},null,[-1,-1,-1,-1])}}function ka(n){let e,t;return{c(){e=Ie("svg"),t=Ie("path"),this.h()},l(l){e=Me(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=Me(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",n[1]),h(e,"stroke","currentColor"),h(e,"class",n[0])},m(l,s){V(l,e,s),p(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ye,o:ye,d(l){l&&m(e)}}}function wa(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class ya extends Pe{constructor(e){super(),Le(this,e,wa,ka,Be,{className:0,strokeWidth:1})}}function qt(n){var l;const e=n.slice(),t=(l=e[0].messages[e[2]])==null?void 0:l.merged;return e[15]=t,e}function Ps(n,e,t){const l=n.slice();return l[39]=e[t],l}function Wt(n){const e=n.slice(),t=e[18][e[39]].messageIds[e[19][e[39]]];return e[42]=t,e}function Ls(n){let e,t,l,s,r,i=De(Object.keys(n[18])),a=[];for(let u=0;u<i.length;u+=1)a[u]=zs(Ps(n,i,u));const o=u=>D(a[u],1,1,()=>{a[u]=null});let f=!n[4]&&Us(n);return{c(){e=I("div"),t=I("div");for(let u=0;u<a.length;u+=1)a[u].c();s=j(),f&&f.c(),this.h()},l(u){e=M(u,"DIV",{});var c=k(e);t=M(c,"DIV",{class:!0,id:!0});var g=k(t);for(let d=0;d<a.length;d+=1)a[d].l(g);g.forEach(m),s=z(c),f&&f.l(c),c.forEach(m),this.h()},h(){h(t,"class","flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"),h(t,"id",l="responses-container-"+n[1]+"-"+n[17].id)},m(u,c){V(u,e,c),p(e,t);for(let g=0;g<a.length;g+=1)a[g]&&a[g].m(t,null);p(e,s),f&&f.m(e,null),r=!0},p(u,c){if(c[0]&60620791){i=De(Object.keys(u[18]));let g;for(g=0;g<i.length;g+=1){const d=Ps(u,i,g);a[g]?(a[g].p(d,c),v(a[g],1)):(a[g]=zs(d),a[g].c(),v(a[g],1),a[g].m(t,null))}for(se(),g=i.length;g<a.length;g+=1)o(g);ne()}(!r||c[0]&131074&&l!==(l="responses-container-"+u[1]+"-"+u[17].id))&&h(t,"id",l),u[4]?f&&(se(),D(f,1,1,()=>{f=null}),ne()):f?(f.p(u,c),c[0]&16&&v(f,1)):(f=Us(u),f.c(),v(f,1),f.m(e,null))},i(u){if(!r){for(let c=0;c<i.length;c+=1)v(a[c]);v(f),r=!0}},o(u){a=a.filter(Boolean);for(let c=0;c<a.length;c+=1)D(a[c]);D(f),r=!1},d(u){u&&m(e),Fe(a,u),f&&f.d()}}}function As(n){let e,t=n[0].currentId,l,s,r,i,a,o=js(n);function f(){return n[34](n[42])}return{c(){e=I("div"),o.c(),l=j(),this.h()},l(u){e=M(u,"DIV",{class:!0});var c=k(e);o.l(c),l=z(c),c.forEach(m),this.h()},h(){var u;h(e,"class",s="snap-center w-full max-w-full m-1 border "+(((u=n[0].messages[n[2]])==null?void 0:u.modelIdx)==n[39]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${n[20]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[20]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl")},m(u,c){V(u,e,c),o.m(e,null),p(e,l),r=!0,i||(a=ce(e,"click",f),i=!0)},p(u,c){var g;n=u,c[0]&1&&Be(t,t=n[0].currentId)?(se(),D(o,1,1,ye),ne(),o=js(n),o.c(),v(o,1),o.m(e,l)):o.p(n,c),(!r||c[0]&1310725&&s!==(s="snap-center w-full max-w-full m-1 border "+(((g=n[0].messages[n[2]])==null?void 0:g.modelIdx)==n[39]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${n[20]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[20]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl"))&&h(e,"class",s)},i(u){r||(v(o),r=!0)},o(u){D(o),r=!1},d(u){u&&m(e),o.d(u),i=!1,a()}}}function Hs(n){let e,t;function l(...a){return n[30](n[39],...a)}function s(){return n[31](n[39])}function r(){return n[32](n[39])}function i(...a){return n[33](n[39],...a)}return e=new Ln({props:{chatId:n[1],history:n[0],messageId:n[42],isLastMessage:!0,siblings:n[18][n[39]].messageIds,gotoMessage:l,showPreviousMessage:s,showNextMessage:r,updateChat:n[5],editMessage:n[6],saveMessage:n[7],rateMessage:n[8],deleteMessage:n[11],actionMessage:n[9],submitMessage:n[10],continueResponse:n[12],regenerateResponse:i,addMessages:n[14],readOnly:n[4]}}),{c(){x(e.$$.fragment)},l(a){ee(e.$$.fragment,a)},m(a,o){te(e,a,o),t=!0},p(a,o){n=a;const f={};o[0]&2&&(f.chatId=n[1]),o[0]&1&&(f.history=n[0]),o[0]&786432&&(f.messageId=n[42]),o[0]&262144&&(f.siblings=n[18][n[39]].messageIds),o[0]&262144&&(f.gotoMessage=l),o[0]&262144&&(f.showPreviousMessage=s),o[0]&262144&&(f.showNextMessage=r),o[0]&32&&(f.updateChat=n[5]),o[0]&64&&(f.editMessage=n[6]),o[0]&128&&(f.saveMessage=n[7]),o[0]&256&&(f.rateMessage=n[8]),o[0]&2048&&(f.deleteMessage=n[11]),o[0]&512&&(f.actionMessage=n[9]),o[0]&1024&&(f.submitMessage=n[10]),o[0]&4096&&(f.continueResponse=n[12]),o[0]&794624&&(f.regenerateResponse=i),o[0]&16384&&(f.addMessages=n[14]),o[0]&16&&(f.readOnly=n[4]),e.$set(f)},i(a){t||(v(e.$$.fragment,a),t=!0)},o(a){D(e.$$.fragment,a),t=!1},d(a){le(e,a)}}}function js(n){let e,t,l=n[15]&&Hs(n);return{c(){l&&l.c(),e=de()},l(s){l&&l.l(s),e=de()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[15]?l?(l.p(s,r),r[0]&32768&&v(l,1)):(l=Hs(s),l.c(),v(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),ne())},i(s){t||(v(l),t=!0)},o(s){D(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function zs(n){let e,t,l=n[19][n[39]]!==void 0&&n[18][n[39]].messageIds.length>0&&As(Wt(n));return{c(){l&&l.c(),e=de()},l(s){l&&l.l(s),e=de()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[19][s[39]]!==void 0&&s[18][s[39]].messageIds.length>0?l?(l.p(Wt(s),r),r[0]&786432&&v(l,1)):(l=As(Wt(s)),l.c(),v(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),ne())},i(s){t||(v(l),t=!0)},o(s){D(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function Us(n){let e=!Object.keys(n[18]).find(n[29]),t,l,s=e&&qs(n);return{c(){s&&s.c(),t=de()},l(r){s&&s.l(r),t=de()},m(r,i){s&&s.m(r,i),V(r,t,i),l=!0},p(r,i){i[0]&786433&&(e=!Object.keys(r[18]).find(r[29])),e?s?(s.p(r,i),i[0]&786433&&v(s,1)):(s=qs(r),s.c(),v(s,1),s.m(t.parentNode,t)):s&&(se(),D(s,1,1,()=>{s=null}),ne())},i(r){l||(v(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(t),s&&s.d(r)}}}function qs(n){var a,o;let e,t,l,s,r=((o=(a=n[0].messages[n[2]])==null?void 0:a.merged)==null?void 0:o.status)&&Ws(qt(n)),i=n[3]&&Js(n);return{c(){e=I("div"),t=I("div"),r&&r.c(),l=j(),i&&i.c(),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=k(e);t=M(u,"DIV",{class:!0});var c=k(t);r&&r.l(c),c.forEach(m),l=z(u),i&&i.l(u),u.forEach(m),this.h()},h(){h(t,"class","w-full"),h(e,"class","flex justify-end")},m(f,u){V(f,e,u),p(e,t),r&&r.m(t,null),p(e,l),i&&i.m(e,null),s=!0},p(f,u){var c,g;(g=(c=f[0].messages[f[2]])==null?void 0:c.merged)!=null&&g.status?r?(r.p(qt(f),u),u[0]&5&&v(r,1)):(r=Ws(qt(f)),r.c(),v(r,1),r.m(t,null)):r&&(se(),D(r,1,1,()=>{r=null}),ne()),f[3]?i?(i.p(f,u),u[0]&8&&v(i,1)):(i=Js(f),i.c(),v(i,1),i.m(e,null)):i&&(se(),D(i,1,1,()=>{i=null}),ne())},i(f){s||(v(r),v(i),s=!0)},o(f){D(r),D(i),s=!1},d(f){f&&m(e),r&&r.d(),i&&i.d()}}}function Ws(n){let e,t,l,s,r,i,a;t=new Kt({props:{$$slots:{default:[Ia]},$$scope:{ctx:n}}});const o=[Ea,Ma],f=[];function u(c,g){var d;return(((d=c[15])==null?void 0:d.content)??"")===""?0:1}return r=u(n),i=f[r]=o[r](n),{c(){e=I("div"),x(t.$$.fragment),l=j(),s=I("div"),i.c(),this.h()},l(c){e=M(c,"DIV",{class:!0});var g=k(e);ee(t.$$.fragment,g),l=z(g),s=M(g,"DIV",{class:!0});var d=k(s);i.l(d),d.forEach(m),g.forEach(m),this.h()},h(){h(s,"class","mt-1 markdown-prose w-full min-w-full"),h(e,"class","w-full rounded-xl pl-5 pr-2 py-2")},m(c,g){V(c,e,g),te(t,e,null),p(e,l),p(e,s),f[r].m(s,null),a=!0},p(c,g){const d={};g[0]&2097157|g[1]&4096&&(d.$$scope={dirty:g,ctx:c}),t.$set(d);let _=r;r=u(c),r===_?f[r].p(c,g):(se(),D(f[_],1,1,()=>{f[_]=null}),ne(),i=f[r],i?i.p(c,g):(i=f[r]=o[r](c),i.c()),v(i,1),i.m(s,null))},i(c){a||(v(t.$$.fragment,c),v(i),a=!0)},o(c){D(t.$$.fragment,c),D(i),a=!1},d(c){c&&m(e),le(t),f[r].d()}}}function Fs(n){let e,t=ot(n[15].timestamp*1e3).format("LT")+"",l;return{c(){e=I("span"),l=W(t),this.h()},l(s){e=M(s,"SPAN",{class:!0});var r=k(e);l=F(r,t),r.forEach(m),this.h()},h(){h(e,"class","self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r[0]&5&&t!==(t=ot(s[15].timestamp*1e3).format("LT")+"")&&K(l,t)},d(s){s&&m(e)}}}function Ia(n){let e=n[21].t("Merged Response")+"",t,l,s,r=n[15].timestamp&&Fs(n);return{c(){t=W(e),l=j(),r&&r.c(),s=de()},l(i){t=F(i,e),l=z(i),r&&r.l(i),s=de()},m(i,a){V(i,t,a),V(i,l,a),r&&r.m(i,a),V(i,s,a)},p(i,a){a[0]&2097152&&e!==(e=i[21].t("Merged Response")+"")&&K(t,e),i[15].timestamp?r?r.p(i,a):(r=Fs(i),r.c(),r.m(s.parentNode,s)):r&&(r.d(1),r=null)},d(i){i&&(m(t),m(l),m(s)),r&&r.d(i)}}}function Ma(n){let e,t;return e=new It({props:{id:"merged",content:n[15].content??""}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&5&&(r.content=l[15].content??""),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Ea(n){let e,t;return e=new Yt({}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p:ye,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Js(n){let e,t,l;return t=new Se({props:{content:n[21].t("Merge Responses"),placement:"bottom",$$slots:{default:[Na]},$$scope:{ctx:n}}}),{c(){e=I("div"),x(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);ee(t.$$.fragment,r),r.forEach(m),this.h()},h(){h(e,"class","shrink-0 text-gray-600 dark:text-gray-500 mt-1")},m(s,r){V(s,e,r),te(t,e,null),l=!0},p(s,r){const i={};r[0]&2097152&&(i.content=s[21].t("Merge Responses")),r[1]&4096&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(v(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),le(t)}}}function Na(n){let e,t,l,s,r;return t=new ya({props:{className:" size-5 "}}),{c(){e=I("button"),x(t.$$.fragment),this.h()},l(i){e=M(i,"BUTTON",{type:!0,id:!0,class:!0});var a=k(e);ee(t.$$.fragment,a),a.forEach(m),this.h()},h(){h(e,"type","button"),h(e,"id","merge-response-button"),h(e,"class","visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(i,a){V(i,e,a),te(t,e,null),l=!0,s||(r=ce(e,"click",n[35]),s=!0)},p:ye,i(i){l||(v(t.$$.fragment,i),l=!0)},o(i){D(t.$$.fragment,i),l=!1},d(i){i&&m(e),le(t),s=!1,r()}}}function Da(n){let e,t,l=n[17]&&Ls(n);return{c(){l&&l.c(),e=de()},l(s){l&&l.l(s),e=de()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[17]?l?(l.p(s,r),r[0]&131072&&v(l,1)):(l=Ls(s),l.c(),v(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),ne())},i(s){t||(v(l),t=!0)},o(s){D(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function Va(n,e,t){let l,s,r;Ee(n,kt,J=>t(36,l=J)),Ee(n,Mn,J=>t(20,s=J));const i=Je("i18n");Ee(n,i,J=>t(21,r=J)),ot.extend(Dn);let{chatId:a}=e,{history:o}=e,{messageId:f}=e,{isLastMessage:u}=e,{readOnly:c=!1}=e,{updateChat:g}=e,{editMessage:d}=e,{saveMessage:_}=e,{rateMessage:y}=e,{actionMessage:w}=e,{submitMessage:E}=e,{deleteMessage:C}=e,{continueResponse:R}=e,{regenerateResponse:P}=e,{mergeResponses:O}=e,{addMessages:b}=e,{triggerScroll:N}=e;gt();let B,S,T={},L={},H=JSON.parse(JSON.stringify(o.messages[f]));const Y=async(J,he)=>{t(19,L[J]=Math.max(0,Math.min(he,T[J].messageIds.length-1)),L);let ae=T[J].messageIds[L[J]];console.log(ae);let be=o.messages[ae].childrenIds;for(;be.length!==0;)ae=be.at(-1),be=o.messages[ae].childrenIds;t(0,o.currentId=ae,o),await Ve(),await g(),N()},oe=async J=>{t(19,L[J]=Math.max(0,L[J]-1),L);let he=T[J].messageIds[L[J]];console.log(he);let ae=o.messages[he].childrenIds;for(;ae.length!==0;)he=ae.at(-1),ae=o.messages[he].childrenIds;t(0,o.currentId=he,o),await Ve(),await g(),N()},ie=async J=>{t(19,L[J]=Math.min(T[J].messageIds.length-1,L[J]+1),L);let he=T[J].messageIds[L[J]];console.log(he);let ae=o.messages[he].childrenIds;for(;ae.length!==0;)he=ae.at(-1),ae=o.messages[he].childrenIds;t(0,o.currentId=he,o),await Ve(),await g(),N()},re=async()=>{console.log("multiresponse:initHandler"),await Ve(),t(16,B=f),t(17,S=o.messages[f].parentId?o.messages[o.messages[f].parentId]:null),t(18,T=S==null?void 0:S.models.reduce((J,he,ae)=>{let be=S==null?void 0:S.childrenIds.map(A=>o.messages[A]).filter(A=>(A==null?void 0:A.modelIdx)===ae).map(A=>A.id);if(be.length===0){let A=S==null?void 0:S.childrenIds.map(G=>o.messages[G]).filter(G=>(G==null?void 0:G.model)===he);A.forEach(G=>{G.modelIdx=ae}),be=A.map(G=>G.id)}return{...J,[ae]:{messageIds:be}}},{})),t(19,L=S==null?void 0:S.models.reduce((J,he,ae)=>{const be=T[ae].messageIds.findIndex(A=>A===f);return be!==-1?{...J,[ae]:be}:{...J,[ae]:T[ae].messageIds.length-1}},{})),console.log(T,L),await Ve()},ue=async()=>{const J=Object.keys(T).map(he=>{const{messageIds:ae}=T[he],be=ae[L[he]];return o.messages[be].content});O(f,J,a)};vt(async()=>{if(await re(),await Ve(),(l==null?void 0:l.scrollOnBranchChange)??!0){const J=document.getElementById(`message-${f}`);J&&J.scrollIntoView({block:"start"})}});const me=J=>{var be;const{messageIds:he}=T[J],ae=he[L[J]];return!((be=o.messages[ae])!=null&&be.done)},ke=(J,he,ae)=>Y(J,ae),q=J=>oe(J),Z=J=>ie(J),ge=async(J,he)=>{P(he),await Ve(),t(19,L[J]=T[J].messageIds.length-1,L)},pe=async J=>{if(f!=J){let he=J,ae=o.messages[he].childrenIds;for(;ae.length!==0;)he=ae.at(-1),ae=o.messages[he].childrenIds;t(0,o.currentId=he,o)}},_e=()=>{ue()};return n.$$set=J=>{"chatId"in J&&t(1,a=J.chatId),"history"in J&&t(0,o=J.history),"messageId"in J&&t(2,f=J.messageId),"isLastMessage"in J&&t(3,u=J.isLastMessage),"readOnly"in J&&t(4,c=J.readOnly),"updateChat"in J&&t(5,g=J.updateChat),"editMessage"in J&&t(6,d=J.editMessage),"saveMessage"in J&&t(7,_=J.saveMessage),"rateMessage"in J&&t(8,y=J.rateMessage),"actionMessage"in J&&t(9,w=J.actionMessage),"submitMessage"in J&&t(10,E=J.submitMessage),"deleteMessage"in J&&t(11,C=J.deleteMessage),"continueResponse"in J&&t(12,R=J.continueResponse),"regenerateResponse"in J&&t(13,P=J.regenerateResponse),"mergeResponses"in J&&t(27,O=J.mergeResponses),"addMessages"in J&&t(14,b=J.addMessages),"triggerScroll"in J&&t(28,N=J.triggerScroll)},n.$$.update=()=>{n.$$.dirty[0]&32773&&o.messages&&JSON.stringify(H)!==JSON.stringify(o.messages[f])&&t(15,H=JSON.parse(JSON.stringify(o.messages[f])))},[o,a,f,u,c,g,d,_,y,w,E,C,R,P,b,H,B,S,T,L,s,r,i,Y,oe,ie,ue,O,N,me,ke,q,Z,ge,pe,_e]}class Ca extends Pe{constructor(e){super(),Le(this,e,Va,Da,Be,{chatId:1,history:0,messageId:2,isLastMessage:3,readOnly:4,updateChat:5,editMessage:6,saveMessage:7,rateMessage:8,actionMessage:9,submitMessage:10,deleteMessage:11,continueResponse:12,regenerateResponse:13,mergeResponses:27,addMessages:14,triggerScroll:28},null,[-1,-1])}}function Gs(n,e,t){const l=n.slice();return l[49]=e[t],l}function Ks(n){var s,r,i,a;let e,t,l;return t=new Vn({props:{src:n[7].user?((i=(r=(s=n[15].find(n[29]))==null?void 0:s.info)==null?void 0:r.meta)==null?void 0:i.profile_image_url)??"/user.png":((a=n[0])==null?void 0:a.profile_image_url)??"/user.png",className:"size-8"}}),{c(){e=I("div"),x(t.$$.fragment),this.h()},l(o){e=M(o,"DIV",{class:!0});var f=k(e);ee(t.$$.fragment,f),f.forEach(m),this.h()},h(){h(e,"class","shrink-0 ltr:mr-3 rtl:ml-3")},m(o,f){V(o,e,f),te(t,e,null),l=!0},p(o,f){var c,g,d,_;const u={};f[0]&32897&&(u.src=o[7].user?((d=(g=(c=o[15].find(o[29]))==null?void 0:c.info)==null?void 0:g.meta)==null?void 0:d.profile_image_url)??"/user.png":((_=o[0])==null?void 0:_.profile_image_url)??"/user.png"),t.$set(u)},i(o){l||(v(t.$$.fragment,o),l=!0)},o(o){D(t.$$.fragment,o),l=!1},d(o){o&&m(e),le(t)}}}function Zs(n){let e,t,l;return t=new Kt({props:{$$slots:{default:[Ra]},$$scope:{ctx:n}}}),{c(){e=I("div"),x(t.$$.fragment)},l(s){e=M(s,"DIV",{});var r=k(e);ee(t.$$.fragment,r),r.forEach(m)},m(s,r){V(s,e,r),te(t,e,null),l=!0},p(s,r){const i={};r[0]&90241|r[1]&2097152&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(v(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),le(t)}}}function Ta(n){let e=n[13].t("You")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&8192&&e!==(e=l[13].t("You")+"")&&K(t,e)},d(l){l&&m(t)}}}function Ba(n){let e=n[0].name+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&1&&e!==(e=l[0].name+"")&&K(t,e)},d(l){l&&m(t)}}}function Sa(n){var a;let e=n[13].t("You")+"",t,l,s,r=(((a=n[7])==null?void 0:a.user)??"")+"",i;return{c(){t=W(e),l=j(),s=I("span"),i=W(r),this.h()},l(o){t=F(o,e),l=z(o),s=M(o,"SPAN",{class:!0});var f=k(s);i=F(f,r),f.forEach(m),this.h()},h(){h(s,"class","text-gray-500 text-sm font-medium")},m(o,f){V(o,t,f),V(o,l,f),V(o,s,f),p(s,i)},p(o,f){var u;f[0]&8192&&e!==(e=o[13].t("You")+"")&&K(t,e),f[0]&128&&r!==(r=(((u=o[7])==null?void 0:u.user)??"")+"")&&K(i,r)},d(o){o&&(m(t),m(l),m(s))}}}function Qs(n){let e,t,l;return t=new Se({props:{content:ot(n[7].timestamp*1e3).format("LLLL"),$$slots:{default:[Oa]},$$scope:{ctx:n}}}),{c(){e=I("div"),x(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);ee(t.$$.fragment,r),r.forEach(m),this.h()},h(){h(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){V(s,e,r),te(t,e,null),l=!0},p(s,r){const i={};r[0]&128&&(i.content=ot(s[7].timestamp*1e3).format("LLLL")),r[0]&128|r[1]&2097152&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(v(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),le(t)}}}function Oa(n){let e,t=At(n[7].timestamp*1e3)+"",l;return{c(){e=I("span"),l=W(t),this.h()},l(s){e=M(s,"SPAN",{class:!0});var r=k(e);l=F(r,t),r.forEach(m),this.h()},h(){h(e,"class","line-clamp-1")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r[0]&128&&t!==(t=At(s[7].timestamp*1e3)+"")&&K(l,t)},d(s){s&&m(e)}}}function Ra(n){let e,t,l;function s(o,f){return o[7].user?Sa:o[14].showUsername||o[16].name!==o[0].name?Ba:Ta}let r=s(n),i=r(n),a=n[7].timestamp&&Qs(n);return{c(){i.c(),e=j(),a&&a.c(),t=de()},l(o){i.l(o),e=z(o),a&&a.l(o),t=de()},m(o,f){i.m(o,f),V(o,e,f),a&&a.m(o,f),V(o,t,f),l=!0},p(o,f){r===(r=s(o))&&i?i.p(o,f):(i.d(1),i=r(o),i&&(i.c(),i.m(e.parentNode,e))),o[7].timestamp?a?(a.p(o,f),f[0]&128&&v(a,1)):(a=Qs(o),a.c(),v(a,1),a.m(t.parentNode,t)):a&&(se(),D(a,1,1,()=>{a=null}),ne())},i(o){l||(v(a),l=!0)},o(o){D(a),l=!1},d(o){o&&(m(e),m(t)),i.d(o),a&&a.d(o)}}}function Ys(n){let e,t,l=De(n[7].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=Xs(Gs(n,l,i));const r=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=I("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=M(i,"DIV",{class:!0});var a=k(e);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(m),this.h()},h(){h(e,"class","mt-2.5 mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap")},m(i,a){V(i,e,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);t=!0},p(i,a){if(a[0]&16512){l=De(i[7].files);let o;for(o=0;o<l.length;o+=1){const f=Gs(i,l,o);s[o]?(s[o].p(f,a),v(s[o],1)):(s[o]=Xs(f),s[o].c(),v(s[o],1),s[o].m(e,null))}for(se(),o=l.length;o<s.length;o+=1)r(o);ne()}},i(i){if(!t){for(let a=0;a<l.length;a+=1)v(s[a]);t=!0}},o(i){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);t=!1},d(i){i&&m(e),Fe(s,i)}}}function Pa(n){var l;let e,t;return e=new Pn({props:{item:n[49],url:n[49].url,name:n[49].name,type:n[49].type,size:(l=n[49])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){x(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,r){te(e,s,r),t=!0},p(s,r){var a;const i={};r[0]&128&&(i.item=s[49]),r[0]&128&&(i.url=s[49].url),r[0]&128&&(i.name=s[49].name),r[0]&128&&(i.type=s[49].type),r[0]&128&&(i.size=(a=s[49])==null?void 0:a.size),e.$set(i)},i(s){t||(v(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function La(n){let e,t;return e=new Cn({props:{src:n[49].url,imageClassName:" max-h-96 rounded-lg"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&128&&(r.src=l[49].url),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Xs(n){let e,t,l,s,r,i;const a=[La,Pa],o=[];function f(u,c){return u[49].type==="image"?0:1}return t=f(n),l=o[t]=a[t](n),{c(){e=I("div"),l.c(),s=j(),this.h()},l(u){e=M(u,"DIV",{class:!0});var c=k(e);l.l(c),s=z(c),c.forEach(m),this.h()},h(){var u;h(e,"class",r=((u=n[14])==null?void 0:u.chatBubble)??!0?"self-end":"")},m(u,c){V(u,e,c),o[t].m(e,null),p(e,s),i=!0},p(u,c){var d;let g=t;t=f(u),t===g?o[t].p(u,c):(se(),D(o[g],1,1,()=>{o[g]=null}),ne(),l=o[t],l?l.p(u,c):(l=o[t]=a[t](u),l.c()),v(l,1),l.m(e,s)),(!i||c[0]&16384&&r!==(r=((d=u[14])==null?void 0:d.chatBubble)??!0?"self-end":""))&&h(e,"class",r)},i(u){i||(v(l),i=!0)},o(u){D(l),i=!1},d(u){u&&m(e),o[t].d()}}}function $s(n){let e,t,l,s;const r=[Ha,Aa],i=[];function a(o,f){return o[10]===!0?0:1}return e=a(n),t=i[e]=r[e](n),{c(){t.c(),l=de()},l(o){t.l(o),l=de()},m(o,f){i[e].m(o,f),V(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e===u?i[e].p(o,f):(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t?t.p(o,f):(t=i[e]=r[e](o),t.c()),v(t,1),t.m(l.parentNode,l))},i(o){s||(v(t),s=!0)},o(o){D(t),s=!1},d(o){o&&m(l),i[e].d(o)}}}function Aa(n){var P,O;let e,t,l,s,r,i,a,o,f,u,c,g,d,_,y=n[7].content&&xs(n),w=!(((P=n[14])==null?void 0:P.chatBubble)??!0)&&en(n),E=!n[6]&&ln(n);u=new Se({props:{content:n[13].t("Copy"),placement:"bottom",$$slots:{default:[qa]},$$scope:{ctx:n}}});let C=!n[6]&&(!n[5]||n[1].length>1)&&sn(n),R=(((O=n[14])==null?void 0:O.chatBubble)??!0)&&nn(n);return{c(){e=I("div"),t=I("div"),l=I("div"),y&&y.c(),i=j(),a=I("div"),w&&w.c(),o=j(),E&&E.c(),f=j(),x(u.$$.fragment),c=j(),C&&C.c(),g=j(),R&&R.c(),this.h()},l(b){e=M(b,"DIV",{class:!0});var N=k(e);t=M(N,"DIV",{class:!0});var B=k(t);l=M(B,"DIV",{class:!0});var S=k(l);y&&y.l(S),S.forEach(m),B.forEach(m),i=z(N),a=M(N,"DIV",{class:!0});var T=k(a);w&&w.l(T),o=z(T),E&&E.l(T),f=z(T),ee(u.$$.fragment,T),c=z(T),C&&C.l(T),g=z(T),R&&R.l(T),T.forEach(m),N.forEach(m),this.h()},h(){var b,N,B;h(l,"class",s="rounded-3xl "+(((b=n[14])==null?void 0:b.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${n[7].files?"rounded-tr-lg":""}`:" w-full")),h(t,"class",r="flex "+(((N=n[14])==null?void 0:N.chatBubble)??!0?"justify-end pb-1":"w-full")),h(a,"class",d="flex "+(((B=n[14])==null?void 0:B.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"),h(e,"class","w-full")},m(b,N){V(b,e,N),p(e,t),p(t,l),y&&y.m(l,null),p(e,i),p(e,a),w&&w.m(a,null),p(a,o),E&&E.m(a,null),p(a,f),te(u,a,null),p(a,c),C&&C.m(a,null),p(a,g),R&&R.m(a,null),_=!0},p(b,N){var S,T,L,H,Y;b[7].content?y?(y.p(b,N),N[0]&128&&v(y,1)):(y=xs(b),y.c(),v(y,1),y.m(l,null)):y&&(se(),D(y,1,1,()=>{y=null}),ne()),(!_||N[0]&16512&&s!==(s="rounded-3xl "+(((S=b[14])==null?void 0:S.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${b[7].files?"rounded-tr-lg":""}`:" w-full")))&&h(l,"class",s),(!_||N[0]&16384&&r!==(r="flex "+(((T=b[14])==null?void 0:T.chatBubble)??!0?"justify-end pb-1":"w-full")))&&h(t,"class",r),((L=b[14])==null?void 0:L.chatBubble)??!0?w&&(w.d(1),w=null):w?w.p(b,N):(w=en(b),w.c(),w.m(a,o)),b[6]?E&&(se(),D(E,1,1,()=>{E=null}),ne()):E?(E.p(b,N),N[0]&64&&v(E,1)):(E=ln(b),E.c(),v(E,1),E.m(a,f));const B={};N[0]&8192&&(B.content=b[13].t("Copy")),N[0]&128|N[1]&2097152&&(B.$$scope={dirty:N,ctx:b}),u.$set(B),!b[6]&&(!b[5]||b[1].length>1)?C?(C.p(b,N),N[0]&98&&v(C,1)):(C=sn(b),C.c(),v(C,1),C.m(a,g)):C&&(se(),D(C,1,1,()=>{C=null}),ne()),((H=b[14])==null?void 0:H.chatBubble)??!0?R?R.p(b,N):(R=nn(b),R.c(),R.m(a,null)):R&&(R.d(1),R=null),(!_||N[0]&16384&&d!==(d="flex "+(((Y=b[14])==null?void 0:Y.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"))&&h(a,"class",d)},i(b){_||(v(y),v(E),v(u.$$.fragment,b),v(C),_=!0)},o(b){D(y),D(E),D(u.$$.fragment,b),D(C),_=!1},d(b){b&&m(e),y&&y.d(),w&&w.d(),E&&E.d(),le(u),C&&C.d(),R&&R.d()}}}function Ha(n){let e,t,l,s,r,i,a,o,f=n[13].t("Save")+"",u,c,g,d,_=n[13].t("Cancel")+"",y,w,E,C=n[13].t("Send")+"",R,P,O;return{c(){e=I("div"),t=I("div"),l=I("textarea"),r=j(),i=I("div"),a=I("div"),o=I("button"),u=W(f),c=j(),g=I("div"),d=I("button"),y=W(_),w=j(),E=I("button"),R=W(C),this.h()},l(b){e=M(b,"DIV",{class:!0});var N=k(e);t=M(N,"DIV",{class:!0});var B=k(t);l=M(B,"TEXTAREA",{id:!0,class:!0}),k(l).forEach(m),B.forEach(m),r=z(N),i=M(N,"DIV",{class:!0});var S=k(i);a=M(S,"DIV",{});var T=k(a);o=M(T,"BUTTON",{id:!0,class:!0});var L=k(o);u=F(L,f),L.forEach(m),T.forEach(m),c=z(S),g=M(S,"DIV",{class:!0});var H=k(g);d=M(H,"BUTTON",{id:!0,class:!0});var Y=k(d);y=F(Y,_),Y.forEach(m),w=z(H),E=M(H,"BUTTON",{id:!0,class:!0});var oe=k(E);R=F(oe,C),oe.forEach(m),H.forEach(m),S.forEach(m),N.forEach(m),this.h()},h(){h(l,"id",s="message-edit-"+n[7].id),h(l,"class","bg-transparent outline-hidden w-full resize-none"),h(t,"class","max-h-96 overflow-auto"),h(o,"id","save-edit-message-button"),h(o,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),h(d,"id","close-edit-message-button"),h(d,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),h(E,"id","confirm-edit-message-button"),h(E,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),h(g,"class","flex space-x-1.5"),h(i,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),h(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2")},m(b,N){V(b,e,N),p(e,t),p(t,l),n[30](l),it(l,n[11]),p(e,r),p(e,i),p(i,a),p(a,o),p(o,u),p(i,c),p(i,g),p(g,d),p(d,y),p(g,w),p(g,E),p(E,R),P||(O=[ce(l,"input",n[31]),ce(l,"input",Ka),ce(l,"keydown",n[32]),ce(o,"click",n[33]),ce(d,"click",n[34]),ce(E,"click",n[35])],P=!0)},p(b,N){N[0]&128&&s!==(s="message-edit-"+b[7].id)&&h(l,"id",s),N[0]&2048&&it(l,b[11]),N[0]&8192&&f!==(f=b[13].t("Save")+"")&&K(u,f),N[0]&8192&&_!==(_=b[13].t("Cancel")+"")&&K(y,_),N[0]&8192&&C!==(C=b[13].t("Send")+"")&&K(R,C)},i:ye,o:ye,d(b){b&&m(e),n[30](null),P=!1,Ye(O)}}}function xs(n){let e,t;return e=new It({props:{id:n[7].id,content:n[7].content}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&128&&(r.id=l[7].id),s[0]&128&&(r.content=l[7].content),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function en(n){let e,t=n[1].length>1&&tn(n);return{c(){t&&t.c(),e=de()},l(l){t&&t.l(l),e=de()},m(l,s){t&&t.m(l,s),V(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=tn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function tn(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,a='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',o,f;function u(d,_){return d[9]?za:ja}let c=u(n),g=c(n);return{c(){e=I("div"),t=I("button"),t.innerHTML=l,s=j(),g.c(),r=j(),i=I("button"),i.innerHTML=a,this.h()},l(d){e=M(d,"DIV",{class:!0,dir:!0});var _=k(e);t=M(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(t)!=="svelte-buado9"&&(t.innerHTML=l),s=z(_),g.l(_),r=z(_),i=M(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-4phel2"&&(i.innerHTML=a),_.forEach(m),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center"),h(e,"dir","ltr")},m(d,_){V(d,e,_),p(e,t),p(e,s),g.m(e,null),p(e,r),p(e,i),o||(f=[ce(t,"click",n[36]),ce(i,"click",n[40])],o=!0)},p(d,_){c===(c=u(d))&&g?g.p(d,_):(g.d(1),g=c(d),g&&(g.c(),g.m(e,r)))},d(d){d&&m(e),g.d(),o=!1,Ye(f)}}}function ja(n){let e,t=n[1].indexOf(n[7].id)+1+"",l,s,r=n[1].length+"",i,a,o;return{c(){e=I("div"),l=W(t),s=W("/"),i=W(r),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=k(e);l=F(u,t),s=F(u,"/"),i=F(u,r),u.forEach(m),this.h()},h(){h(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){V(f,e,u),p(e,l),p(e,s),p(e,i),a||(o=ce(e,"dblclick",n[39]),a=!0)},p(f,u){u[0]&130&&t!==(t=f[1].indexOf(f[7].id)+1+"")&&K(l,t),u[0]&2&&r!==(r=f[1].length+"")&&K(i,r)},d(f){f&&m(e),a=!1,o()}}}function za(n){let e,t,l,s,r,i,a=n[1].length+"",o,f,u;return{c(){e=I("div"),t=I("input"),i=W("/"),o=W(a),this.h()},l(c){e=M(c,"DIV",{class:!0});var g=k(e);t=M(g,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=F(g,"/"),o=F(g,a),g.forEach(m),this.h()},h(){h(t,"id",l="message-index-input-"+n[7].id),h(t,"type","number"),t.value=s=n[1].indexOf(n[7].id)+1,h(t,"min","1"),h(t,"max",r=n[1].length),h(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),h(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,g){V(c,e,g),p(e,t),p(e,i),p(e,o),f||(u=[ce(t,"focus",Za),ce(t,"blur",n[37]),ce(t,"keydown",n[38])],f=!0)},p(c,g){g[0]&128&&l!==(l="message-index-input-"+c[7].id)&&h(t,"id",l),g[0]&130&&s!==(s=c[1].indexOf(c[7].id)+1)&&t.value!==s&&(t.value=s),g[0]&2&&r!==(r=c[1].length)&&h(t,"max",r),g[0]&2&&a!==(a=c[1].length+"")&&K(o,a)},d(c){c&&m(e),f=!1,Ye(u)}}}function ln(n){let e,t;return e=new Se({props:{content:n[13].t("Edit"),placement:"bottom",$$slots:{default:[Ua]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.content=l[13].t("Edit")),s[1]&2097152&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Ua(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg>',l,s;return{c(){e=I("button"),e.innerHTML=t,this.h()},l(r){e=M(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(e)!=="svelte-tlrz1q"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button")},m(r,i){V(r,e,i),l||(s=ce(e,"click",n[41]),l=!0)},p:ye,d(r){r&&m(e),l=!1,s()}}}function qa(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg>',l,s;return{c(){e=I("button"),e.innerHTML=t,this.h()},l(r){e=M(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(e)!=="svelte-1ivgdx2"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(r,i){V(r,e,i),l||(s=ce(e,"click",n[42]),l=!0)},p:ye,d(r){r&&m(e),l=!1,s()}}}function sn(n){let e,t;return e=new Se({props:{content:n[13].t("Delete"),placement:"bottom",$$slots:{default:[Wa]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.content=l[13].t("Delete")),s[0]&256|s[1]&2097152&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Wa(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',l,s;return{c(){e=I("button"),e.innerHTML=t,this.h()},l(r){e=M(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(e)!=="svelte-146x2zz"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1 rounded-sm dark:hover:text-white hover:text-black transition")},m(r,i){V(r,e,i),l||(s=ce(e,"click",n[43]),l=!0)},p:ye,d(r){r&&m(e),l=!1,s()}}}function nn(n){let e,t=n[1].length>1&&rn(n);return{c(){t&&t.c(),e=de()},l(l){t&&t.l(l),e=de()},m(l,s){t&&t.m(l,s),V(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=rn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function rn(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,a='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',o,f;function u(d,_){return d[9]?Ja:Fa}let c=u(n),g=c(n);return{c(){e=I("div"),t=I("button"),t.innerHTML=l,s=j(),g.c(),r=j(),i=I("button"),i.innerHTML=a,this.h()},l(d){e=M(d,"DIV",{class:!0,dir:!0});var _=k(e);t=M(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(t)!=="svelte-buado9"&&(t.innerHTML=l),s=z(_),g.l(_),r=z(_),i=M(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-4phel2"&&(i.innerHTML=a),_.forEach(m),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center"),h(e,"dir","ltr")},m(d,_){V(d,e,_),p(e,t),p(e,s),g.m(e,null),p(e,r),p(e,i),o||(f=[ce(t,"click",n[44]),ce(i,"click",n[48])],o=!0)},p(d,_){c===(c=u(d))&&g?g.p(d,_):(g.d(1),g=c(d),g&&(g.c(),g.m(e,r)))},d(d){d&&m(e),g.d(),o=!1,Ye(f)}}}function Fa(n){let e,t=n[1].indexOf(n[7].id)+1+"",l,s,r=n[1].length+"",i,a,o;return{c(){e=I("div"),l=W(t),s=W("/"),i=W(r),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=k(e);l=F(u,t),s=F(u,"/"),i=F(u,r),u.forEach(m),this.h()},h(){h(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){V(f,e,u),p(e,l),p(e,s),p(e,i),a||(o=ce(e,"dblclick",n[47]),a=!0)},p(f,u){u[0]&130&&t!==(t=f[1].indexOf(f[7].id)+1+"")&&K(l,t),u[0]&2&&r!==(r=f[1].length+"")&&K(i,r)},d(f){f&&m(e),a=!1,o()}}}function Ja(n){let e,t,l,s,r,i,a=n[1].length+"",o,f,u;return{c(){e=I("div"),t=I("input"),i=W("/"),o=W(a),this.h()},l(c){e=M(c,"DIV",{class:!0});var g=k(e);t=M(g,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=F(g,"/"),o=F(g,a),g.forEach(m),this.h()},h(){h(t,"id",l="message-index-input-"+n[7].id),h(t,"type","number"),t.value=s=n[1].indexOf(n[7].id)+1,h(t,"min","1"),h(t,"max",r=n[1].length),h(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),h(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,g){V(c,e,g),p(e,t),p(e,i),p(e,o),f||(u=[ce(t,"focus",Qa),ce(t,"blur",n[45]),ce(t,"keydown",n[46])],f=!0)},p(c,g){g[0]&128&&l!==(l="message-index-input-"+c[7].id)&&h(t,"id",l),g[0]&130&&s!==(s=c[1].indexOf(c[7].id)+1)&&t.value!==s&&(t.value=s),g[0]&2&&r!==(r=c[1].length)&&h(t,"max",r),g[0]&2&&a!==(a=c[1].length+"")&&K(o,a)},d(c){c&&m(e),f=!1,Ye(u)}}}function Ga(n){var P,O;let e,t,l,s,r,i,a,o,f,u,c,g,d;function _(b){n[27](b)}let y={title:n[13].t("Delete message?")};n[8]!==void 0&&(y.show=n[8]),e=new On({props:y}),je.push(()=>Qe(e,"show",_)),e.$on("confirm",n[28]);let w=!(((P=n[14])==null?void 0:P.chatBubble)??!0)&&Ks(n),E=!(((O=n[14])==null?void 0:O.chatBubble)??!0)&&Zs(n),C=n[7].files&&Ys(n),R=n[7].content!==""&&$s(n);return{c(){x(e.$$.fragment),l=j(),s=I("div"),w&&w.c(),r=j(),i=I("div"),E&&E.c(),a=j(),o=I("div"),C&&C.c(),f=j(),R&&R.c(),this.h()},l(b){ee(e.$$.fragment,b),l=z(b),s=M(b,"DIV",{class:!0,dir:!0,id:!0});var N=k(s);w&&w.l(N),r=z(N),i=M(N,"DIV",{class:!0});var B=k(i);E&&E.l(B),a=z(B),o=M(B,"DIV",{class:!0});var S=k(o);C&&C.l(S),f=z(S),R&&R.l(S),S.forEach(m),B.forEach(m),N.forEach(m),this.h()},h(){h(o,"class",u="chat-"+n[7].role+" w-full min-w-full markdown-prose"),h(i,"class","flex-auto w-0 max-w-full pl-1"),h(s,"class","flex w-full user-message"),h(s,"dir",c=n[14].chatDirection),h(s,"id",g="message-"+n[7].id)},m(b,N){te(e,b,N),V(b,l,N),V(b,s,N),w&&w.m(s,null),p(s,r),p(s,i),E&&E.m(i,null),p(i,a),p(i,o),C&&C.m(o,null),p(o,f),R&&R.m(o,null),d=!0},p(b,N){var S,T;const B={};N[0]&8192&&(B.title=b[13].t("Delete message?")),!t&&N[0]&256&&(t=!0,B.show=b[8],Ze(()=>t=!1)),e.$set(B),((S=b[14])==null?void 0:S.chatBubble)??!0?w&&(se(),D(w,1,1,()=>{w=null}),ne()):w?(w.p(b,N),N[0]&16384&&v(w,1)):(w=Ks(b),w.c(),v(w,1),w.m(s,r)),((T=b[14])==null?void 0:T.chatBubble)??!0?E&&(se(),D(E,1,1,()=>{E=null}),ne()):E?(E.p(b,N),N[0]&16384&&v(E,1)):(E=Zs(b),E.c(),v(E,1),E.m(i,a)),b[7].files?C?(C.p(b,N),N[0]&128&&v(C,1)):(C=Ys(b),C.c(),v(C,1),C.m(o,f)):C&&(se(),D(C,1,1,()=>{C=null}),ne()),b[7].content!==""?R?(R.p(b,N),N[0]&128&&v(R,1)):(R=$s(b),R.c(),v(R,1),R.m(o,null)):R&&(se(),D(R,1,1,()=>{R=null}),ne()),(!d||N[0]&128&&u!==(u="chat-"+b[7].role+" w-full min-w-full markdown-prose"))&&h(o,"class",u),(!d||N[0]&16384&&c!==(c=b[14].chatDirection))&&h(s,"dir",c),(!d||N[0]&128&&g!==(g="message-"+b[7].id))&&h(s,"id",g)},i(b){d||(v(e.$$.fragment,b),v(w),v(E),v(C),v(R),d=!0)},o(b){D(e.$$.fragment,b),D(w),D(E),D(C),D(R),d=!1},d(b){b&&(m(l),m(s)),le(e,b),w&&w.d(),E&&E.d(),C&&C.d(),R&&R.d()}}}const Ka=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},Za=n=>{n.target.select()},Qa=n=>{n.target.select()};function Ya(n,e,t){let l,s,r,i;Ee(n,kt,X=>t(14,s=X)),Ee(n,jt,X=>t(15,r=X)),Ee(n,zt,X=>t(16,i=X));const a=Je("i18n");Ee(n,a,X=>t(13,l=X)),ot.extend(Dn);let{user:o}=e,{history:f}=e,{messageId:u}=e,{siblings:c}=e,{gotoMessage:g}=e,{showPreviousMessage:d}=e,{showNextMessage:_}=e,{editMessage:y}=e,{deleteMessage:w}=e,{isFirstMessage:E}=e,{readOnly:C}=e,R=!1,P=!1,O=!1,b="",N,B=JSON.parse(JSON.stringify(f.messages[u]));const S=async X=>{await Nn(X)&&Ae.success(l.t("Copying to clipboard was successful!"))},T=async()=>{t(10,O=!0),t(11,b=B.content),await Ve(),N&&(t(12,N.style.height="",N),t(12,N.style.height=`${N.scrollHeight}px`,N),N==null||N.focus())},L=async(X=!0)=>{y(B.id,b,X),t(10,O=!1),t(11,b="")},H=()=>{t(10,O=!1),t(11,b="")},Y=async()=>{w(B.id)};vt(()=>{});function oe(X){R=X,t(8,R)}const ie=()=>{Y()},re=X=>X.id===B.user;function ue(X){je[X?"unshift":"push"](()=>{N=X,t(12,N)})}function me(){b=this.value,t(11,b)}const ke=X=>{var ze,We;X.key==="Escape"&&((ze=document.getElementById("close-edit-message-button"))==null||ze.click());const Re=X.metaKey||X.ctrlKey,He=X.key==="Enter";Re&&He&&((We=document.getElementById("confirm-edit-message-button"))==null||We.click())},q=()=>{L(!1)},Z=()=>{H()},ge=()=>{L()},pe=()=>{d(B)},_e=X=>{g(B,X.target.value-1),t(9,P=!1)},J=X=>{X.key==="Enter"&&(g(B,X.target.value-1),t(9,P=!1))},he=async()=>{t(9,P=!0),await Ve();const X=document.getElementById(`message-index-input-${B.id}`);X&&(X.focus(),X.select())},ae=()=>{_(B)},be=()=>{T()},A=()=>{S(B.content)},G=()=>{t(8,R=!0)},$=()=>{d(B)},Q=X=>{g(B,X.target.value-1),t(9,P=!1)},fe=X=>{X.key==="Enter"&&(g(B,X.target.value-1),t(9,P=!1))},ve=async()=>{t(9,P=!0),await Ve();const X=document.getElementById(`message-index-input-${B.id}`);X&&(X.focus(),X.select())},Ce=()=>{_(B)};return n.$$set=X=>{"user"in X&&t(0,o=X.user),"history"in X&&t(23,f=X.history),"messageId"in X&&t(24,u=X.messageId),"siblings"in X&&t(1,c=X.siblings),"gotoMessage"in X&&t(2,g=X.gotoMessage),"showPreviousMessage"in X&&t(3,d=X.showPreviousMessage),"showNextMessage"in X&&t(4,_=X.showNextMessage),"editMessage"in X&&t(25,y=X.editMessage),"deleteMessage"in X&&t(26,w=X.deleteMessage),"isFirstMessage"in X&&t(5,E=X.isFirstMessage),"readOnly"in X&&t(6,C=X.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&25165952&&f.messages&&JSON.stringify(B)!==JSON.stringify(f.messages[u])&&t(7,B=JSON.parse(JSON.stringify(f.messages[u])))},[o,c,g,d,_,E,C,B,R,P,O,b,N,l,s,r,i,a,S,T,L,H,Y,f,u,y,w,oe,ie,re,ue,me,ke,q,Z,ge,pe,_e,J,he,ae,be,A,G,$,Q,fe,ve,Ce]}class Xa extends Pe{constructor(e){super(),Le(this,e,Ya,Ga,Be,{user:0,history:23,messageId:24,siblings:1,gotoMessage:2,showPreviousMessage:3,showNextMessage:4,editMessage:25,deleteMessage:26,isFirstMessage:5,readOnly:6},null,[-1,-1])}}function on(n){let e,t,l,s;const r=[ef,xa,$a],i=[];function a(o,f){var u,c;return o[0].messages[o[3]].role==="user"?0:(((c=(u=o[0].messages[o[0].messages[o[3]].parentId])==null?void 0:u.models)==null?void 0:c.length)??1)===1?1:2}return e=a(n),t=i[e]=r[e](n),{c(){t.c(),l=de()},l(o){t.l(o),l=de()},m(o,f){i[e].m(o,f),V(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e===u?i[e].p(o,f):(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t?t.p(o,f):(t=i[e]=r[e](o),t.c()),v(t,1),t.m(l.parentNode,l))},i(o){s||(v(t),s=!0)},o(o){D(t),s=!1},d(o){o&&m(l),i[e].d(o)}}}function $a(n){var i;let e,t,l;function s(a){n[22](a)}let r={chatId:n[1],messageId:n[3],isLastMessage:n[3]===((i=n[0])==null?void 0:i.currentId),updateChat:n[8],editMessage:n[9],saveMessage:n[10],rateMessage:n[12],actionMessage:n[13],submitMessage:n[14],deleteMessage:n[11],continueResponse:n[16],regenerateResponse:n[15],mergeResponses:n[17],triggerScroll:n[19],addMessages:n[18],readOnly:n[20]};return n[0]!==void 0&&(r.history=n[0]),e=new Ca({props:r}),je.push(()=>Qe(e,"history",s)),{c(){x(e.$$.fragment)},l(a){ee(e.$$.fragment,a)},m(a,o){te(e,a,o),l=!0},p(a,o){var u;const f={};o&2&&(f.chatId=a[1]),o&8&&(f.messageId=a[3]),o&9&&(f.isLastMessage=a[3]===((u=a[0])==null?void 0:u.currentId)),o&256&&(f.updateChat=a[8]),o&512&&(f.editMessage=a[9]),o&1024&&(f.saveMessage=a[10]),o&4096&&(f.rateMessage=a[12]),o&8192&&(f.actionMessage=a[13]),o&16384&&(f.submitMessage=a[14]),o&2048&&(f.deleteMessage=a[11]),o&65536&&(f.continueResponse=a[16]),o&32768&&(f.regenerateResponse=a[15]),o&131072&&(f.mergeResponses=a[17]),o&524288&&(f.triggerScroll=a[19]),o&262144&&(f.addMessages=a[18]),o&1048576&&(f.readOnly=a[20]),!t&&o&1&&(t=!0,f.history=a[0],Ze(()=>t=!1)),e.$set(f)},i(a){l||(v(e.$$.fragment,a),l=!0)},o(a){D(e.$$.fragment,a),l=!1},d(a){le(e,a)}}}function xa(n){var l;let e,t;return e=new Ln({props:{chatId:n[1],history:n[0],messageId:n[3],isLastMessage:n[3]===n[0].currentId,siblings:((l=n[0].messages[n[0].messages[n[3]].parentId])==null?void 0:l.childrenIds)??[],gotoMessage:n[5],showPreviousMessage:n[6],showNextMessage:n[7],updateChat:n[8],editMessage:n[9],saveMessage:n[10],rateMessage:n[12],actionMessage:n[13],submitMessage:n[14],deleteMessage:n[11],continueResponse:n[16],regenerateResponse:n[15],addMessages:n[18],readOnly:n[20]}}),{c(){x(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,r){te(e,s,r),t=!0},p(s,r){var a;const i={};r&2&&(i.chatId=s[1]),r&1&&(i.history=s[0]),r&8&&(i.messageId=s[3]),r&9&&(i.isLastMessage=s[3]===s[0].currentId),r&9&&(i.siblings=((a=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:a.childrenIds)??[]),r&32&&(i.gotoMessage=s[5]),r&64&&(i.showPreviousMessage=s[6]),r&128&&(i.showNextMessage=s[7]),r&256&&(i.updateChat=s[8]),r&512&&(i.editMessage=s[9]),r&1024&&(i.saveMessage=s[10]),r&4096&&(i.rateMessage=s[12]),r&8192&&(i.actionMessage=s[13]),r&16384&&(i.submitMessage=s[14]),r&2048&&(i.deleteMessage=s[11]),r&65536&&(i.continueResponse=s[16]),r&32768&&(i.regenerateResponse=s[15]),r&262144&&(i.addMessages=s[18]),r&1048576&&(i.readOnly=s[20]),e.$set(i)},i(s){t||(v(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function ef(n){var l;let e,t;return e=new Xa({props:{user:n[4],history:n[0],messageId:n[3],isFirstMessage:n[2]===0,siblings:n[0].messages[n[3]].parentId!==null?((l=n[0].messages[n[0].messages[n[3]].parentId])==null?void 0:l.childrenIds)??[]:Object.values(n[0].messages).filter(an).map(fn)??[],gotoMessage:n[5],showPreviousMessage:n[6],showNextMessage:n[7],editMessage:n[9],deleteMessage:n[11],readOnly:n[20]}}),{c(){x(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,r){te(e,s,r),t=!0},p(s,r){var a;const i={};r&16&&(i.user=s[4]),r&1&&(i.history=s[0]),r&8&&(i.messageId=s[3]),r&4&&(i.isFirstMessage=s[2]===0),r&9&&(i.siblings=s[0].messages[s[3]].parentId!==null?((a=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:a.childrenIds)??[]:Object.values(s[0].messages).filter(an).map(fn)??[]),r&32&&(i.gotoMessage=s[5]),r&64&&(i.showPreviousMessage=s[6]),r&128&&(i.showNextMessage=s[7]),r&512&&(i.editMessage=s[9]),r&2048&&(i.deleteMessage=s[11]),r&1048576&&(i.readOnly=s[20]),e.$set(i)},i(s){t||(v(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function tf(n){let e,t,l,s=n[0].messages[n[3]]&&on(n);return{c(){e=I("div"),s&&s.c(),this.h()},l(r){e=M(r,"DIV",{class:!0});var i=k(e);s&&s.l(i),i.forEach(m),this.h()},h(){var r;h(e,"class",t="flex flex-col justify-between px-5 mb-3 w-full "+(((r=n[21])==null?void 0:r.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group")},m(r,i){V(r,e,i),s&&s.m(e,null),l=!0},p(r,[i]){var a;r[0].messages[r[3]]?s?(s.p(r,i),i&9&&v(s,1)):(s=on(r),s.c(),v(s,1),s.m(e,null)):s&&(se(),D(s,1,1,()=>{s=null}),ne()),(!l||i&2097152&&t!==(t="flex flex-col justify-between px-5 mb-3 w-full "+(((a=r[21])==null?void 0:a.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group"))&&h(e,"class",t)},i(r){l||(v(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(e),s&&s.d()}}}const an=n=>n.parentId===null,fn=n=>n.id;function lf(n,e,t){let l;Ee(n,kt,T=>t(21,l=T)),gt(),Je("i18n");let{chatId:s}=e,{idx:r=0}=e,{history:i}=e,{messageId:a}=e,{user:o}=e,{gotoMessage:f}=e,{showPreviousMessage:u}=e,{showNextMessage:c}=e,{updateChat:g}=e,{editMessage:d}=e,{saveMessage:_}=e,{deleteMessage:y}=e,{rateMessage:w}=e,{actionMessage:E}=e,{submitMessage:C}=e,{regenerateResponse:R}=e,{continueResponse:P}=e,{mergeResponses:O}=e,{addMessages:b}=e,{triggerScroll:N}=e,{readOnly:B=!1}=e;function S(T){i=T,t(0,i)}return n.$$set=T=>{"chatId"in T&&t(1,s=T.chatId),"idx"in T&&t(2,r=T.idx),"history"in T&&t(0,i=T.history),"messageId"in T&&t(3,a=T.messageId),"user"in T&&t(4,o=T.user),"gotoMessage"in T&&t(5,f=T.gotoMessage),"showPreviousMessage"in T&&t(6,u=T.showPreviousMessage),"showNextMessage"in T&&t(7,c=T.showNextMessage),"updateChat"in T&&t(8,g=T.updateChat),"editMessage"in T&&t(9,d=T.editMessage),"saveMessage"in T&&t(10,_=T.saveMessage),"deleteMessage"in T&&t(11,y=T.deleteMessage),"rateMessage"in T&&t(12,w=T.rateMessage),"actionMessage"in T&&t(13,E=T.actionMessage),"submitMessage"in T&&t(14,C=T.submitMessage),"regenerateResponse"in T&&t(15,R=T.regenerateResponse),"continueResponse"in T&&t(16,P=T.continueResponse),"mergeResponses"in T&&t(17,O=T.mergeResponses),"addMessages"in T&&t(18,b=T.addMessages),"triggerScroll"in T&&t(19,N=T.triggerScroll),"readOnly"in T&&t(20,B=T.readOnly)},[i,s,r,a,o,f,u,c,g,d,_,y,w,E,C,R,P,O,b,N,B,l,S]}class sf extends Pe{constructor(e){super(),Le(this,e,lf,tf,Be,{chatId:1,idx:2,history:0,messageId:3,user:4,gotoMessage:5,showPreviousMessage:6,showNextMessage:7,updateChat:8,editMessage:9,saveMessage:10,deleteMessage:11,rateMessage:12,actionMessage:13,submitMessage:14,regenerateResponse:15,continueResponse:16,mergeResponses:17,addMessages:18,triggerScroll:19,readOnly:20})}}function un(n,e,t){const l=n.slice();return l[13]=e[t],l[15]=t,l}function nf(n){let e,t,l,s;return{c(){e=I("div"),t=W(n[3]),l=W("  v"),s=W(dl),this.h()},l(r){e=M(r,"DIV",{class:!0});var i=k(e);t=F(i,n[3]),l=F(i,"  v"),s=F(i,dl),i.forEach(m),this.h()},h(){h(e,"class","flex w-full text-center items-center justify-center self-start text-gray-400 dark:text-gray-600")},m(r,i){V(r,e,i),p(e,t),p(e,l),p(e,s)},p(r,i){i&8&&K(t,r[3])},i:ye,o:ye,d(r){r&&m(e)}}}function rf(n){let e,t,l=n[2].t("Suggested")+"",s,r;return e=new Lr({}),{c(){x(e.$$.fragment),t=j(),s=W(l)},l(i){ee(e.$$.fragment,i),t=z(i),s=F(i,l)},m(i,a){te(e,i,a),V(i,t,a),V(i,s,a),r=!0},p(i,a){(!r||a&4)&&l!==(l=i[2].t("Suggested")+"")&&K(s,l)},i(i){r||(v(e.$$.fragment,i),r=!0)},o(i){D(e.$$.fragment,i),r=!1},d(i){i&&(m(t),m(s)),le(e,i)}}}function cn(n){let e=[],t=new Map,l,s=De(n[1]);const r=i=>i[13].id||i[13].content;for(let i=0;i<s.length;i+=1){let a=un(n,s,i),o=r(a);t.set(o,e[i]=dn(o,a))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=de()},l(i){for(let a=0;a<e.length;a+=1)e[a].l(i);l=de()},m(i,a){for(let o=0;o<e.length;o+=1)e[o]&&e[o].m(i,a);V(i,l,a)},p(i,a){a&38&&(s=De(i[1]),e=Jt(e,a,r,1,i,s,t,l.parentNode,_r,dn,l,un))},d(i){i&&m(l);for(let a=0;a<e.length;a+=1)e[a].d(i)}}}function of(n){let e,t=n[13].content+"",l,s,r,i=n[2].t("Prompt")+"",a;return{c(){e=I("div"),l=W(t),s=j(),r=I("div"),a=W(i),this.h()},l(o){e=M(o,"DIV",{class:!0});var f=k(e);l=F(f,t),f.forEach(m),s=z(o),r=M(o,"DIV",{class:!0});var u=k(r);a=F(u,i),u.forEach(m),this.h()},h(){h(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),h(r,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(o,f){V(o,e,f),p(e,l),V(o,s,f),V(o,r,f),p(r,a)},p(o,f){f&2&&t!==(t=o[13].content+"")&&K(l,t),f&4&&i!==(i=o[2].t("Prompt")+"")&&K(a,i)},d(o){o&&(m(e),m(s),m(r))}}}function af(n){let e,t=n[13].title[0]+"",l,s,r,i=n[13].title[1]+"",a;return{c(){e=I("div"),l=W(t),s=j(),r=I("div"),a=W(i),this.h()},l(o){e=M(o,"DIV",{class:!0});var f=k(e);l=F(f,t),f.forEach(m),s=z(o),r=M(o,"DIV",{class:!0});var u=k(r);a=F(u,i),u.forEach(m),this.h()},h(){h(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),h(r,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(o,f){V(o,e,f),p(e,l),V(o,s,f),V(o,r,f),p(r,a)},p(o,f){f&2&&t!==(t=o[13].title[0]+"")&&K(l,t),f&2&&i!==(i=o[13].title[1]+"")&&K(a,i)},d(o){o&&(m(e),m(s),m(r))}}}function dn(n,e){let t,l,s,r,i;function a(c,g){return c[13].title&&c[13].title[0]!==""?af:of}let o=a(e),f=o(e);function u(){return e[9](e[13])}return{key:n,first:null,c(){t=I("button"),l=I("div"),f.c(),s=j(),this.h()},l(c){t=M(c,"BUTTON",{class:!0,style:!0});var g=k(t);l=M(g,"DIV",{class:!0});var d=k(l);f.l(d),d.forEach(m),s=z(g),g.forEach(m),this.h()},h(){h(l,"class","flex flex-col text-left"),h(t,"class","waterfall flex flex-col flex-1 shrink-0 w-full justify-between px-3 py-2 rounded-xl bg-transparent hover:bg-black/5 dark:hover:bg-white/5 transition group svelte-1co34if"),Rt(t,"animation-delay",e[15]*60+"ms"),this.first=t},m(c,g){V(c,t,g),p(t,l),f.m(l,null),p(t,s),r||(i=ce(t,"click",u),r=!0)},p(c,g){e=c,o===(o=a(e))&&f?f.p(e,g):(f.d(1),f=o(e),f&&(f.c(),f.m(l,null))),g&2&&Rt(t,"animation-delay",e[15]*60+"ms")},d(c){c&&m(t),f.d(),r=!1,i()}}}function ff(n){let e,t,l,s,r,i,a;const o=[rf,nf],f=[];function u(g,d){return g[1].length>0?0:1}t=u(n),l=f[t]=o[t](n);let c=n[1].length>0&&cn(n);return{c(){e=I("div"),l.c(),s=j(),r=I("div"),c&&c.c(),this.h()},l(g){e=M(g,"DIV",{class:!0});var d=k(e);l.l(d),d.forEach(m),s=z(g),r=M(g,"DIV",{class:!0});var _=k(r);c&&c.l(_),_.forEach(m),this.h()},h(){h(e,"class","mb-1 flex gap-1 text-xs font-medium items-center text-gray-400 dark:text-gray-600"),h(r,"class",i="h-40 overflow-auto scrollbar-none "+n[0]+" items-start svelte-1co34if")},m(g,d){V(g,e,d),f[t].m(e,null),V(g,s,d),V(g,r,d),c&&c.m(r,null),a=!0},p(g,[d]){let _=t;t=u(g),t===_?f[t].p(g,d):(se(),D(f[_],1,1,()=>{f[_]=null}),ne(),l=f[t],l?l.p(g,d):(l=f[t]=o[t](g),l.c()),v(l,1),l.m(e,null)),g[1].length>0?c?c.p(g,d):(c=cn(g),c.c(),c.m(r,null)):c&&(c.d(1),c=null),(!a||d&1&&i!==(i="h-40 overflow-auto scrollbar-none "+g[0]+" items-start svelte-1co34if"))&&h(r,"class",i)},i(g){a||(v(l),a=!0)},o(g){D(l),a=!1},d(g){g&&(m(e),m(s),m(r)),f[t].d(),c&&c.d()}}}function uf(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if((n[t].id??n[t].content)!==(e[t].id??e[t].content))return!1;return!0}function cf(n,e,t){let l,s;Ee(n,kr,w=>t(3,s=w));const r=Je("i18n");Ee(n,r,w=>t(2,l=w));const i=gt();let{suggestionPrompts:a=[]}=e,{className:o=""}=e,{inputValue:f=""}=e,u=[];const c={keys:["content","title"],threshold:.5};let g,d=[];const _=w=>{if(w.length>500)t(1,d=[]);else{const E=w.trim()&&g?g.search(w.trim()).map(C=>C.item):u;uf(d,E)||t(1,d=E)}},y=w=>i("select",w.content);return n.$$set=w=>{"suggestionPrompts"in w&&t(6,a=w.suggestionPrompts),"className"in w&&t(0,o=w.className),"inputValue"in w&&t(7,f=w.inputValue)},n.$$.update=()=>{n.$$.dirty&192&&a&&(t(8,u=[...a??[]].sort(()=>Math.random()-.5)),_(f)),n.$$.dirty&256&&(g=new Wr(u,c)),n.$$.dirty&128&&_(f)},[o,d,l,s,r,i,a,f,u,y]}class df extends Pe{constructor(e){super(),Le(this,e,cf,ff,Be,{suggestionPrompts:6,className:0,inputValue:7})}}function hn(n,e,t){const l=n.slice();return l[14]=e[t],l[16]=t,l}function hf(n){let e,t;return{c(){e=I("img"),this.h()},l(l){e=M(l,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),this.h()},h(){var l,s,r;h(e,"crossorigin","anonymous"),Pt(e.src,t=((r=(s=(l=n[14])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.profile_image_url)??(n[5].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`))||h(e,"src",t),h(e,"class","size-[2.7rem] rounded-full border-[1px] border-gray-100 dark:border-none"),h(e,"alt","logo"),h(e,"draggable","false")},m(l,s){V(l,e,s)},p(l,s){var r,i,a;s&33&&!Pt(e.src,t=((a=(i=(r=l[14])==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:a.profile_image_url)??(l[5].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`))&&h(e,"src",t)},d(l){l&&m(e)}}}function mn(n){var o,f,u;let e,t,l,s,r,i;t=new Se({props:{content:Ht.parse(bt(((u=(f=(o=n[0][n[4]])==null?void 0:o.info)==null?void 0:f.meta)==null?void 0:u.description)??"")),placement:"right",$$slots:{default:[hf]},$$scope:{ctx:n}}});function a(){return n[12](n[16])}return{c(){e=I("button"),x(t.$$.fragment),l=j()},l(c){e=M(c,"BUTTON",{});var g=k(e);ee(t.$$.fragment,g),l=z(g),g.forEach(m)},m(c,g){V(c,e,g),te(t,e,null),p(e,l),s=!0,r||(i=ce(e,"click",a),r=!0)},p(c,g){var _,y,w;n=c;const d={};g&17&&(d.content=Ht.parse(bt(((w=(y=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:y.meta)==null?void 0:w.description)??""))),g&131105&&(d.$$scope={dirty:g,ctx:n}),t.$set(d)},i(c){s||(v(t.$$.fragment,c),s=!0)},o(c){D(t.$$.fragment,c),s=!1},d(c){c&&m(e),le(t),r=!1,i()}}}function gn(n){let e,t;return e=new Se({props:{content:n[5].t("This chat wont appear in history and your messages will not be saved."),className:"w-full flex justify-center mb-0.5",placement:"top",$$slots:{default:[mf]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s&32&&(r.content=l[5].t("This chat wont appear in history and your messages will not be saved.")),s&131104&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function mf(n){let e,t,l=n[5].t("Temporary Chat")+"",s,r;return t=new Br({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=I("div"),x(t.$$.fragment),s=W(l),this.h()},l(i){e=M(i,"DIV",{class:!0});var a=k(e);ee(t.$$.fragment,a),s=F(a,l),a.forEach(m),this.h()},h(){h(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(i,a){V(i,e,a),te(t,e,null),p(e,s),r=!0},p(i,a){(!r||a&32)&&l!==(l=i[5].t("Temporary Chat")+"")&&K(s,l)},i(i){r||(v(t.$$.fragment,i),r=!0)},o(i){D(t.$$.fragment,i),r=!1},d(i){i&&m(e),le(t)}}}function gf(n){var l;let e=n[5].t("Hello, {{name}}",{name:(l=n[7])==null?void 0:l.name})+"",t;return{c(){t=W(e)},l(s){t=F(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r&160&&e!==(e=s[5].t("Hello, {{name}}",{name:(i=s[7])==null?void 0:i.name})+"")&&K(t,e)},d(s){s&&m(t)}}}function _f(n){var l;let e=((l=n[0][n[4]])==null?void 0:l.name)+"",t;return{c(){t=W(e)},l(s){t=F(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r&17&&e!==(e=((i=s[0][s[4]])==null?void 0:i.name)+"")&&K(t,e)},d(s){s&&m(t)}}}function pf(n){let e,t=n[5].t("How can I help you today?")+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);l=F(r,t),r.forEach(m),this.h()},h(){h(e,"class","font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r&32&&t!==(t=s[5].t("How can I help you today?")+"")&&K(l,t)},d(s){s&&m(e)}}}function bf(n){var a,o,f,u,c,g;let e,t,l=Ht.parse(bt((f=(o=(a=n[0][n[4]])==null?void 0:a.info)==null?void 0:o.meta)==null?void 0:f.description))+"",s,r,i=((g=(c=(u=n[0][n[4]])==null?void 0:u.info)==null?void 0:c.meta)==null?void 0:g.user)&&_n(n);return{c(){e=I("div"),t=new mr(!1),s=j(),i&&i.c(),r=de(),this.h()},l(d){e=M(d,"DIV",{class:!0});var _=k(e);t=gr(_,!1),_.forEach(m),s=z(d),i&&i.l(d),r=de(),this.h()},h(){t.a=null,h(e,"class","mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown")},m(d,_){V(d,e,_),t.m(l,e),V(d,s,_),i&&i.m(d,_),V(d,r,_)},p(d,_){var y,w,E,C,R,P;_&17&&l!==(l=Ht.parse(bt((E=(w=(y=d[0][d[4]])==null?void 0:y.info)==null?void 0:w.meta)==null?void 0:E.description))+"")&&t.p(l),(P=(R=(C=d[0][d[4]])==null?void 0:C.info)==null?void 0:R.meta)!=null&&P.user?i?i.p(d,_):(i=_n(d),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},d(d){d&&(m(e),m(s),m(r)),i&&i.d(d)}}}function _n(n){let e,t;function l(i,a){var o,f,u;return(u=(f=(o=i[0][i[4]])==null?void 0:o.info)==null?void 0:f.meta)!=null&&u.user.community?kf:vf}let s=l(n),r=s(n);return{c(){e=I("div"),t=W(`By
								`),r.c(),this.h()},l(i){e=M(i,"DIV",{class:!0});var a=k(e);t=F(a,`By
								`),r.l(a),a.forEach(m),this.h()},h(){h(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,a){V(i,e,a),p(e,t),r.m(e,null)},p(i,a){s===(s=l(i))&&r?r.p(i,a):(r.d(1),r=s(i),r&&(r.c(),r.m(e,null)))},d(i){i&&m(e),r.d()}}}function vf(n){var l,s,r;let e=((r=(s=(l=n[0][n[4]])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.user.name)+"",t;return{c(){t=W(e)},l(i){t=F(i,e)},m(i,a){V(i,t,a)},p(i,a){var o,f,u;a&17&&e!==(e=((u=(f=(o=i[0][i[4]])==null?void 0:o.info)==null?void 0:f.meta)==null?void 0:u.user.name)+"")&&K(t,e)},d(i){i&&m(t)}}}function kf(n){var r,i,a,o,f,u,c,g,d;let e,t=((a=(i=(r=n[0][n[4]])==null?void 0:r.info)==null?void 0:i.meta)!=null&&a.user.name?(u=(f=(o=n[0][n[4]])==null?void 0:o.info)==null?void 0:f.meta)==null?void 0:u.user.name:`@${(d=(g=(c=n[0][n[4]])==null?void 0:c.info)==null?void 0:g.meta)==null?void 0:d.user.username}`)+"",l,s;return{c(){e=I("a"),l=W(t),this.h()},l(_){e=M(_,"A",{href:!0});var y=k(e);l=F(y,t),y.forEach(m),this.h()},h(){var _,y,w;h(e,"href",s="https://openwebui.com/m/"+((w=(y=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:y.meta)==null?void 0:w.user.username))},m(_,y){V(_,e,y),p(e,l)},p(_,y){var w,E,C,R,P,O,b,N,B,S,T,L;y&17&&t!==(t=((C=(E=(w=_[0][_[4]])==null?void 0:w.info)==null?void 0:E.meta)!=null&&C.user.name?(O=(P=(R=_[0][_[4]])==null?void 0:R.info)==null?void 0:P.meta)==null?void 0:O.user.name:`@${(B=(N=(b=_[0][_[4]])==null?void 0:b.info)==null?void 0:N.meta)==null?void 0:B.user.username}`)+"")&&K(l,t),y&17&&s!==(s="https://openwebui.com/m/"+((L=(T=(S=_[0][_[4]])==null?void 0:S.info)==null?void 0:T.meta)==null?void 0:L.user.username))&&h(e,"href",s)},d(_){_&&m(e)}}}function pn(n){var Y,oe,ie,re,ue,me,ke;let e,t,l,s,r,i,a,o,f,u,c,g,d,_,y,w,E,C,R=De(n[0]),P=[];for(let q=0;q<R.length;q+=1)P[q]=mn(hn(n,R,q));const O=q=>D(P[q],1,1,()=>{P[q]=null});let b=n[6]&&gn(n);function N(q,Z){var ge;return(ge=q[0][q[4]])!=null&&ge.name?_f:gf}let B=N(n),S=B(n);function T(q,Z){var ge,pe,_e;return((_e=(pe=(ge=q[0][q[4]])==null?void 0:ge.info)==null?void 0:pe.meta)==null?void 0:_e.description)??null?bf:pf}let L=T(n),H=L(n);return w=new df({props:{className:"grid grid-cols-2",suggestionPrompts:((ie=(oe=(Y=n[1])==null?void 0:Y.info)==null?void 0:oe.meta)==null?void 0:ie.suggestion_prompts)??((me=(ue=(re=n[0][n[4]])==null?void 0:re.info)==null?void 0:ue.meta)==null?void 0:me.suggestion_prompts)??((ke=n[8])==null?void 0:ke.default_prompt_suggestions)??[]}}),w.$on("select",n[13]),{c(){e=I("div"),t=I("div"),l=I("div");for(let q=0;q<P.length;q+=1)P[q].c();r=j(),b&&b.c(),i=j(),a=I("div"),o=I("div"),f=I("div"),S.c(),c=j(),g=I("div"),H.c(),_=j(),y=I("div"),x(w.$$.fragment),this.h()},l(q){e=M(q,"DIV",{class:!0});var Z=k(e);t=M(Z,"DIV",{class:!0});var ge=k(t);l=M(ge,"DIV",{class:!0});var pe=k(l);for(let A=0;A<P.length;A+=1)P[A].l(pe);pe.forEach(m),ge.forEach(m),r=z(Z),b&&b.l(Z),i=z(Z),a=M(Z,"DIV",{class:!0});var _e=k(a);o=M(_e,"DIV",{});var J=k(o);f=M(J,"DIV",{class:!0});var he=k(f);S.l(he),he.forEach(m),c=z(J),g=M(J,"DIV",{});var ae=k(g);H.l(ae),ae.forEach(m),J.forEach(m),_e.forEach(m),_=z(Z),y=M(Z,"DIV",{class:!0});var be=k(y);ee(w.$$.fragment,be),be.forEach(m),Z.forEach(m),this.h()},h(){h(l,"class","flex -space-x-4 mb-0.5"),h(t,"class","flex justify-start"),h(f,"class","capitalize line-clamp-1"),h(a,"class","mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary"),h(y,"class","w-full font-primary"),h(e,"class","m-auto w-full max-w-6xl px-8 lg:px-20")},m(q,Z){V(q,e,Z),p(e,t),p(t,l);for(let ge=0;ge<P.length;ge+=1)P[ge]&&P[ge].m(l,null);p(e,r),b&&b.m(e,null),p(e,i),p(e,a),p(a,o),p(o,f),S.m(f,null),p(o,c),p(o,g),H.m(g,null),p(e,_),p(e,y),te(w,y,null),C=!0},p(q,Z){var pe,_e,J,he,ae,be,A;if(Z&49){R=De(q[0]);let G;for(G=0;G<R.length;G+=1){const $=hn(q,R,G);P[G]?(P[G].p($,Z),v(P[G],1)):(P[G]=mn($),P[G].c(),v(P[G],1),P[G].m(l,null))}for(se(),G=R.length;G<P.length;G+=1)O(G);ne()}q[6]?b?(b.p(q,Z),Z&64&&v(b,1)):(b=gn(q),b.c(),v(b,1),b.m(e,i)):b&&(se(),D(b,1,1,()=>{b=null}),ne()),B===(B=N(q))&&S?S.p(q,Z):(S.d(1),S=B(q),S&&(S.c(),S.m(f,null))),L===(L=T(q))&&H?H.p(q,Z):(H.d(1),H=L(q),H&&(H.c(),H.m(g,null)));const ge={};Z&275&&(ge.suggestionPrompts=((J=(_e=(pe=q[1])==null?void 0:pe.info)==null?void 0:_e.meta)==null?void 0:J.suggestion_prompts)??((be=(ae=(he=q[0][q[4]])==null?void 0:he.info)==null?void 0:ae.meta)==null?void 0:be.suggestion_prompts)??((A=q[8])==null?void 0:A.default_prompt_suggestions)??[]),w.$set(ge)},i(q){if(!C){for(let Z=0;Z<R.length;Z+=1)v(P[Z]);q&&(s||Bt(()=>{s=St(l,Ot,{duration:200}),s.start()})),v(b),q&&(u||Bt(()=>{u=St(f,Ot,{duration:200}),u.start()})),q&&(d||Bt(()=>{d=St(g,Ot,{duration:200,delay:200}),d.start()})),v(w.$$.fragment,q),q&&(E||Bt(()=>{E=St(y,Ot,{duration:200,delay:300}),E.start()})),C=!0}},o(q){P=P.filter(Boolean);for(let Z=0;Z<P.length;Z+=1)D(P[Z]);D(b),D(w.$$.fragment,q),C=!1},d(q){q&&m(e),Fe(P,q),b&&b.d(),S.d(),H.d(),le(w)}}}function wf(n){let e=n[3],t,l,s=pn(n);return{c(){s.c(),t=de()},l(r){s.l(r),t=de()},m(r,i){s.m(r,i),V(r,t,i),l=!0},p(r,[i]){i&8&&Be(e,e=r[3])?(se(),D(s,1,1,ye),ne(),s=pn(r),s.c(),v(s,1),s.m(t.parentNode,t)):s.p(r,i)},i(r){l||(v(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(t),s.d(r)}}}function yf(n,e,t){let l,s,r,i,a;Ee(n,jt,E=>t(11,l=E)),Ee(n,Gt,E=>t(6,r=E)),Ee(n,zt,E=>t(7,i=E)),Ee(n,En,E=>t(8,a=E));const o=Je("i18n");Ee(n,o,E=>t(5,s=E));let{modelIds:f=[]}=e,{models:u=[]}=e,{atSelectedModel:c}=e,{submitPrompt:g}=e,d=!1,_=0;vt(()=>{t(3,d=!0)});const y=E=>{t(4,_=E)},w=E=>{g(E.detail)};return n.$$set=E=>{"modelIds"in E&&t(10,f=E.modelIds),"models"in E&&t(0,u=E.models),"atSelectedModel"in E&&t(1,c=E.atSelectedModel),"submitPrompt"in E&&t(2,g=E.submitPrompt)},n.$$.update=()=>{n.$$.dirty&3072&&t(0,u=f.map(E=>l.find(C=>C.id===E))),n.$$.dirty&1025&&f.length>0&&t(4,_=u.length-1)},[u,c,g,d,_,s,r,i,a,o,f,l,y,w]}class If extends Pe{constructor(e){super(),Le(this,e,yf,wf,Be,{modelIds:10,models:0,atSelectedModel:1,submitPrompt:2})}}function bn(n,e,t){const l=n.slice();return l[43]=e[t],l[45]=t,l}function Mf(n){let e,t=n[3],l,s=yn(n);return{c(){e=I("div"),s.c(),this.h()},l(r){e=M(r,"DIV",{class:!0});var i=k(e);s.l(i),i.forEach(m),this.h()},h(){h(e,"class","w-full pt-2")},m(r,i){V(r,e,i),s.m(e,null),l=!0},p(r,i){i[0]&8&&Be(t,t=r[3])?(se(),D(s,1,1,ye),ne(),s=yn(r),s.c(),v(s,1),s.m(e,null)):s.p(r,i)},i(r){l||(v(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(e),s.d(r)}}}function Ef(n){let e,t;return e=new If({props:{modelIds:n[5],atSelectedModel:n[6],submitPrompt:n[34]}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&32&&(r.modelIds=l[5]),s[0]&64&&(r.atSelectedModel=l[6]),s[0]&65538&&(r.submitPrompt=l[34]),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function vn(n){let e,t;return e=new qr({props:{$$slots:{default:[Nf]},$$scope:{ctx:n}}}),e.$on("visible",n[35]),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[1]&32768&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Nf(n){let e,t,l,s,r="Loading...",i;return t=new Zt({props:{className:" size-4"}}),{c(){e=I("div"),x(t.$$.fragment),l=j(),s=I("div"),s.textContent=r,this.h()},l(a){e=M(a,"DIV",{class:!0});var o=k(e);ee(t.$$.fragment,o),l=z(o),s=M(o,"DIV",{class:!0,"data-svelte-h":!0}),Ue(s)!=="svelte-17uns3n"&&(s.textContent=r),o.forEach(m),this.h()},h(){h(s,"class",""),h(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(a,o){V(a,e,o),te(t,e,null),p(e,l),p(e,s),i=!0},p:ye,i(a){i||(v(t.$$.fragment,a),i=!0)},o(a){D(t.$$.fragment,a),i=!1},d(a){a&&m(e),le(t)}}}function kn(n,e){let t,l,s,r;function i(o){e[36](o)}let a={chatId:e[3],messageId:e[43].id,idx:e[45],user:e[4],gotoMessage:e[20],showPreviousMessage:e[21],showNextMessage:e[22],updateChat:e[19],editMessage:e[24],deleteMessage:e[27],rateMessage:e[23],actionMessage:e[25],saveMessage:e[26],submitMessage:e[10],regenerateResponse:e[8],continueResponse:e[7],mergeResponses:e[9],addMessages:e[11],triggerScroll:e[28],readOnly:e[12]};return e[0]!==void 0&&(a.history=e[0]),l=new sf({props:a}),je.push(()=>Qe(l,"history",i)),{key:n,first:null,c(){t=de(),x(l.$$.fragment),this.h()},l(o){t=de(),ee(l.$$.fragment,o),this.h()},h(){this.first=t},m(o,f){V(o,t,f),te(l,o,f),r=!0},p(o,f){e=o;const u={};f[0]&8&&(u.chatId=e[3]),f[0]&16384&&(u.messageId=e[43].id),f[0]&16384&&(u.idx=e[45]),f[0]&16&&(u.user=e[4]),f[0]&1024&&(u.submitMessage=e[10]),f[0]&256&&(u.regenerateResponse=e[8]),f[0]&128&&(u.continueResponse=e[7]),f[0]&512&&(u.mergeResponses=e[9]),f[0]&2048&&(u.addMessages=e[11]),f[0]&4096&&(u.readOnly=e[12]),!s&&f[0]&1&&(s=!0,u.history=e[0],Ze(()=>s=!1)),l.$set(u)},i(o){r||(v(l.$$.fragment,o),r=!0)},o(o){D(l.$$.fragment,o),r=!1},d(o){o&&m(t),le(l,o)}}}function wn(n){let e;return{c(){e=I("div"),this.h()},l(t){e=M(t,"DIV",{class:!0}),k(e).forEach(m),this.h()},h(){h(e,"class","pb-6")},m(t,l){V(t,e,l)},d(t){t&&m(e)}}}function yn(n){var y;let e,t=((y=n[14].at(0))==null?void 0:y.parentId)!==null,l,s=[],r=new Map,i,a,o,f,u,c=t&&vn(n),g=De(n[14]);const d=w=>w[43].id;for(let w=0;w<g.length;w+=1){let E=bn(n,g,w),C=d(E);r.set(C,s[w]=kn(C,E))}let _=n[13]&&wn();return{c(){e=I("div"),c&&c.c(),l=j();for(let w=0;w<s.length;w+=1)s[w].c();i=j(),a=I("div"),o=j(),_&&_.c(),f=de(),this.h()},l(w){e=M(w,"DIV",{class:!0});var E=k(e);c&&c.l(E),l=z(E);for(let C=0;C<s.length;C+=1)s[C].l(E);E.forEach(m),i=z(w),a=M(w,"DIV",{class:!0}),k(a).forEach(m),o=z(w),_&&_.l(w),f=de(),this.h()},h(){h(e,"class","w-full"),h(a,"class","pb-12")},m(w,E){V(w,e,E),c&&c.m(e,null),p(e,l);for(let C=0;C<s.length;C+=1)s[C]&&s[C].m(e,null);V(w,i,E),V(w,a,E),V(w,o,E),_&&_.m(w,E),V(w,f,E),u=!0},p(w,E){var C;E[0]&16384&&(t=((C=w[14].at(0))==null?void 0:C.parentId)!==null),t?c?(c.p(w,E),E[0]&16384&&v(c,1)):(c=vn(w),c.c(),v(c,1),c.m(e,l)):c&&(se(),D(c,1,1,()=>{c=null}),ne()),E[0]&536371097&&(g=De(w[14]),se(),s=Jt(s,E,d,1,w,g,r,e,In,kn,null,bn),ne()),w[13]?_||(_=wn(),_.c(),_.m(f.parentNode,f)):_&&(_.d(1),_=null)},i(w){if(!u){v(c);for(let E=0;E<g.length;E+=1)v(s[E]);u=!0}},o(w){D(c);for(let E=0;E<s.length;E+=1)D(s[E]);u=!1},d(w){w&&(m(e),m(i),m(a),m(o),m(f)),c&&c.d();for(let E=0;E<s.length;E+=1)s[E].d();_&&_.d(w)}}}function Df(n){let e,t,l,s,r;const i=[Ef,Mf],a=[];function o(f,u){var c;return u[0]&1&&(t=null),t==null&&(t=Object.keys(((c=f[0])==null?void 0:c.messages)??{}).length==0),t?0:1}return l=o(n,[-1,-1]),s=a[l]=i[l](n),{c(){e=I("div"),s.c(),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=k(e);s.l(u),u.forEach(m),this.h()},h(){h(e,"class",n[2])},m(f,u){V(f,e,u),a[l].m(e,null),r=!0},p(f,u){let c=l;l=o(f,u),l===c?a[l].p(f,u):(se(),D(a[c],1,1,()=>{a[c]=null}),ne(),s=a[l],s?s.p(f,u):(s=a[l]=i[l](f),s.c()),v(s,1),s.m(e,null)),(!r||u[0]&4)&&h(e,"class",f[2])},i(f){r||(v(s),r=!0)},o(f){D(s),r=!1},d(f){f&&m(e),a[l].d()}}}function Vf(n,e,t){let l,s,r,i,a;Ee(n,kt,A=>t(37,l=A)),Ee(n,hl,A=>t(38,s=A)),Ee(n,Gt,A=>t(39,r=A)),Ee(n,zt,A=>t(40,i=A)),gt();const o=Je("i18n");Ee(n,o,A=>t(16,a=A));let{className:f="h-full flex pt-8"}=e,{chatId:u=""}=e,{user:c=i}=e,{prompt:g}=e,{history:d={}}=e,{selectedModels:_}=e,{atSelectedModel:y}=e,w=[],{sendPrompt:E}=e,{continueResponse:C}=e,{regenerateResponse:R}=e,{mergeResponses:P}=e,{chatActionHandler:O}=e,{showMessage:b=()=>{}}=e,{submitMessage:N=()=>{}}=e,{addMessages:B=()=>{}}=e,{readOnly:S=!1}=e,{bottomPadding:T=!1}=e,{autoScroll:L}=e,H=20,Y=!1;const oe=async()=>{const A=document.getElementById("messages-container");A.scrollTop=A.scrollTop+100,t(15,Y=!0),t(33,H+=20),await Ve(),t(15,Y=!1)},ie=()=>{const A=document.getElementById("messages-container");A.scrollTop=A.scrollHeight},re=async()=>{r||(t(0,d),await Ve(),await Ir(localStorage.token,u,{history:d,messages:w}),hl.set(1),await wr.set(await Mr(localStorage.token,s)))},ue=async(A,G)=>{let $;A.parentId!==null?$=d.messages[A.parentId].childrenIds:$=Object.values(d.messages).filter(fe=>fe.parentId===null).map(fe=>fe.id),G=Math.max(0,Math.min(G,$.length-1));let Q=$[G];if(A.id!==Q){let fe=d.messages[Q].childrenIds;for(;fe.length!==0;)Q=fe.at(-1),fe=d.messages[Q].childrenIds;t(0,d.currentId=Q,d)}if(await Ve(),(l==null?void 0:l.scrollOnBranchChange)??!0){const fe=document.getElementById("messages-container");t(29,L=fe.scrollHeight-fe.scrollTop<=fe.clientHeight+50),setTimeout(()=>{ie()},100)}},me=async A=>{if(A.parentId!==null){let G=d.messages[A.parentId].childrenIds[Math.max(d.messages[A.parentId].childrenIds.indexOf(A.id)-1,0)];if(A.id!==G){let $=d.messages[G].childrenIds;for(;$.length!==0;)G=$.at(-1),$=d.messages[G].childrenIds;t(0,d.currentId=G,d)}}else{let G=Object.values(d.messages).filter(Q=>Q.parentId===null).map(Q=>Q.id),$=G[Math.max(G.indexOf(A.id)-1,0)];if(A.id!==$){let Q=d.messages[$].childrenIds;for(;Q.length!==0;)$=Q.at(-1),Q=d.messages[$].childrenIds;t(0,d.currentId=$,d)}}if(await Ve(),(l==null?void 0:l.scrollOnBranchChange)??!0){const G=document.getElementById("messages-container");t(29,L=G.scrollHeight-G.scrollTop<=G.clientHeight+50),setTimeout(()=>{ie()},100)}},ke=async A=>{if(A.parentId!==null){let G=d.messages[A.parentId].childrenIds[Math.min(d.messages[A.parentId].childrenIds.indexOf(A.id)+1,d.messages[A.parentId].childrenIds.length-1)];if(A.id!==G){let $=d.messages[G].childrenIds;for(;$.length!==0;)G=$.at(-1),$=d.messages[G].childrenIds;t(0,d.currentId=G,d)}}else{let G=Object.values(d.messages).filter(Q=>Q.parentId===null).map(Q=>Q.id),$=G[Math.min(G.indexOf(A.id)+1,G.length-1)];if(A.id!==$){let Q=d.messages[$].childrenIds;for(;Q.length!==0;)$=Q.at(-1),Q=d.messages[$].childrenIds;t(0,d.currentId=$,d)}}if(await Ve(),(l==null?void 0:l.scrollOnBranchChange)??!0){const G=document.getElementById("messages-container");t(29,L=G.scrollHeight-G.scrollTop<=G.clientHeight+50),setTimeout(()=>{ie()},100)}},q=async(A,G)=>{t(0,d.messages[A].annotation={...d.messages[A].annotation,rating:G},d),await re()},Z=async(A,G,$=!0)=>{if(d.messages[A].role==="user")if($){let Q=G,fe=ml(),ve={id:fe,parentId:d.messages[A].parentId,childrenIds:[],role:"user",content:Q,...d.messages[A].files&&{files:d.messages[A].files},models:_,timestamp:Math.floor(Date.now()/1e3)},Ce=d.messages[A].parentId;Ce!==null&&t(0,d.messages[Ce].childrenIds=[...d.messages[Ce].childrenIds,fe],d),t(0,d.messages[fe]=ve,d),t(0,d.currentId=fe,d),await Ve(),await E(d,Q,fe)}else t(0,d.messages[A].content=G,d),await re();else if($){const Q=ml(),fe=d.messages[A],ve=fe.parentId,Ce={...fe,id:Q,parentId:ve,childrenIds:[],files:void 0,content:G,timestamp:Math.floor(Date.now()/1e3)};t(0,d.messages[Q]=Ce,d),t(0,d.currentId=Q,d),ve!==null&&t(0,d.messages[ve].childrenIds=[...d.messages[ve].childrenIds,Q],d),await re()}else t(0,d.messages[A].originalContent=d.messages[A].content,d),t(0,d.messages[A].content=G,d),await re()},ge=async(A,G,$=null)=>{await O(u,A,G.model,G.id,$)},pe=async(A,G)=>{t(0,d.messages[A]=G,d),await re()},_e=async A=>{const G=d.messages[A],$=G.parentId,Q=G.childrenIds??[],fe=Q.flatMap(ve=>{var Ce;return((Ce=d.messages[ve])==null?void 0:Ce.childrenIds)??[]});$&&d.messages[$]&&t(0,d.messages[$].childrenIds=[...d.messages[$].childrenIds.filter(ve=>ve!==A),...fe],d),fe.forEach(ve=>{d.messages[ve]&&t(0,d.messages[ve].parentId=$,d)}),[A,...Q].forEach(ve=>{delete d.messages[ve]}),await Ve(),b({id:$}),await re()},J=()=>{if(L){const A=document.getElementById("messages-container");t(29,L=A.scrollHeight-A.scrollTop<=A.clientHeight+50),setTimeout(()=>{ie()},100)}},he=async A=>{let G=A;if(A.includes("{{CLIPBOARD}}")){const $=await navigator.clipboard.readText().catch(Q=>(Ae.error(a.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));G=A.replaceAll("{{CLIPBOARD}}",$)}t(1,g=G),await Ve()},ae=A=>{console.log("visible"),Y||oe()};function be(A){d=A,t(0,d)}return n.$$set=A=>{"className"in A&&t(2,f=A.className),"chatId"in A&&t(3,u=A.chatId),"user"in A&&t(4,c=A.user),"prompt"in A&&t(1,g=A.prompt),"history"in A&&t(0,d=A.history),"selectedModels"in A&&t(5,_=A.selectedModels),"atSelectedModel"in A&&t(6,y=A.atSelectedModel),"sendPrompt"in A&&t(30,E=A.sendPrompt),"continueResponse"in A&&t(7,C=A.continueResponse),"regenerateResponse"in A&&t(8,R=A.regenerateResponse),"mergeResponses"in A&&t(9,P=A.mergeResponses),"chatActionHandler"in A&&t(31,O=A.chatActionHandler),"showMessage"in A&&t(32,b=A.showMessage),"submitMessage"in A&&t(10,N=A.submitMessage),"addMessages"in A&&t(11,B=A.addMessages),"readOnly"in A&&t(12,S=A.readOnly),"bottomPadding"in A&&t(13,T=A.bottomPadding),"autoScroll"in A&&t(29,L=A.autoScroll)},n.$$.update=()=>{if(n.$$.dirty[0]&1|n.$$.dirty[1]&4)if(d.currentId){let A=[],G=d.messages[d.currentId];for(;G&&A.length<=H;)A.unshift({...G}),G=G.parentId!==null?d.messages[G.parentId]:null;t(14,w=A)}else t(14,w=[]);n.$$.dirty[0]&536879104&&L&&T&&(async()=>(await Ve(),ie()))()},[d,g,f,u,c,_,y,C,R,P,N,B,S,T,w,Y,a,o,oe,re,ue,me,ke,q,Z,ge,pe,_e,J,L,E,O,b,H,he,ae,be]}class mu extends Pe{constructor(e){super(),Le(this,e,Vf,Df,Be,{className:2,chatId:3,user:4,prompt:1,history:0,selectedModels:5,atSelectedModel:6,sendPrompt:30,continueResponse:7,regenerateResponse:8,mergeResponses:9,chatActionHandler:31,showMessage:32,submitMessage:10,addMessages:11,readOnly:12,bottomPadding:13,autoScroll:29},null,[-1,-1])}}export{Jr as K,mu as M,df as S};
//# sourceMappingURL=U9jHDl4W.js.map
